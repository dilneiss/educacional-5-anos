<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0"
    />
    <title>Jogo Educativo Infantil</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <style>
        /* Ajustes gerais */
        html, body {
            margin: 0;
            padding: 0;
            background-color: #fff3e0;
            font-family: "Arial", sans-serif;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        body, html {
            height: 100%;
        }
        body::-webkit-scrollbar {
            width: 8px;
        }
        body::-webkit-scrollbar-thumb {
            background: #888;
        }
        body::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        /* Container geral do jogo */
        .game-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        /* Top bar (contÃ©m info do jogador + botÃ£o de voltar + etc.) */
        .top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 10;
        }

        /* BotÃ£o de voltar discreto, parte da top bar */
        #backToMenuBtn {
            font-size: 18px;
            background: transparent;
            border: none;
            color: #666;
            cursor: pointer;
        }

        /* InformaÃ§Ãµes do jogador (nome, estrelas, trofÃ©u, etc.) */
        .player-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
            /* Para evitar quebra quando o nome ou as estrelas forem grandes, permitir wrap */
            max-width: 80%;
        }
        .player-name {
            font-size: 18px;
            color: #2e7d32;
            font-weight: bold;
            margin: 0;
            white-space: nowrap;
        }
        .stars-info {
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 18px;
            white-space: nowrap;
        }
        .stars-info span:last-child {
            font-size: 18px;
        }
        .trophy-info {
            font-size: 20px;
            color: #ffbf00;
            display: none;
        }

        /* BotÃ£o de figurinhas na top bar */
        #stickers-btn {
            font-size: 14px;
            padding: 6px 12px;
            background: #ff9800;
            border-radius: 6px;
            border: none;
            color: #fff;
            position: relative;
            cursor: pointer;
            white-space: nowrap;
        }
        #stickers-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: red;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            color: white;
            font-weight: bold;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Ãrea de conteudo (abaixo do top bar) - ocupando o restante da tela */
        #mainContent {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* TÃ­tulo grande sÃ³ na tela inicial */
        .main-title {
            font-size: 2rem;
            font-weight: bold;
            color: #ff5722;
            margin: 20px 0 10px;
        }

        /* Centralizando o conteÃºdo da tela inicial */
        .container {
            text-align: center;
        }
        #start-menu {
            margin-top: 10px;
        }
        .start-menu-btn {
            width: 200px;
            font-size: 18px;
            display: inline-block;
            margin: 10px auto;
            padding: 10px 0;
        }
        .start-menu-input {
            font-size: 18px;
            border-radius: 8px;
            border: 2px solid #ccc;
            padding: 6px 8px;
            width: 250px;
            max-width: 80%;
            text-align: center;
            margin-bottom: 15px;
        }

        /* Feedback de acertos/erros */
        .feedback {
            font-size: 1rem;
            margin: 0.5rem 0;
            min-height: 30px;
            text-align: center;
        }

        button {
            cursor: pointer;
            border: none;
            border-radius: 10px;
        }
        .btn-primary { background-color: #2196f3; color: #fff; }
        .btn-warning { background-color: #ffc107; color: #000; }
        .btn-danger  { background-color: #f44336; color: #fff; }
        .btn-info    { background-color: #00bcd4; color: #fff; }
        .btn-success { background-color: #4caf50; color: #fff; }

        /* Esconder */
        .d-none {
            display: none !important;
        }

        /* Menu principal de jogos */
        #main-menu {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        .game-mode {
            background-color: #81d4fa;
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            border: 3px solid #000;
            width: 150px;
            text-align: center;
            font-size: 1rem;
            transition: transform 0.2s;
            margin: 10px;
            word-wrap: break-word;
        }
        .game-mode:hover {
            transform: scale(1.05);
        }

        /* Ãrea do jogo (conteÃºdo) - manter tudo o que jÃ¡ existia, mas reduzir tamanhos para caber na tela sem scroll */
        #game-area {
            flex: 1;
            overflow: hidden; /* Impede rolagem */
            display: none;
            padding: 5px;
        }
        /* Container interno do jogo -> definimos um layout de "display: flex; flex-direction: column; height: 100%;" se necessÃ¡rio */
        #content {
            font-size: 1rem;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
        }
        #content h2 {
            font-size: 1.2rem;
            margin-bottom: 5px;
            text-align: center;
        }

        /* BotÃ£o VOLTAR AO MENU agora fica na top bar, entÃ£o nÃ£o precisa de estilo grande no meio do jogo */
        .hidden-when-playing {
            /* para ocultar certos elementos quando estiver jogando */
        }

        /**********************************************
         * REDUZINDO DIMENSÃ•ES PARA CABER NA TELA
         **********************************************/

        /* 1) Para grids com opÃ§Ãµes (letras, emojis etc.) */
        .emoji-grid,
        .numbers-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 5px;
            /* ForÃ§ar altura limitada, para nÃ£o rolar */
            max-height: 40vh;
            overflow: hidden;
        }
        .emoji-option,
        .number-option {
            background-color: #c8e6c9;
            width: 60px;
            height: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            border-radius: 8px;
            border: 2px solid #000;
            cursor: pointer;
            text-align: center;
        }
        .emoji-name {
            font-size: 0.6rem;
            margin-top: 2px;
        }

        /* Alvo do jogo de nÃºmeros */
        .target-number {
            background-color: #ffd700;
            width: 60px;
            height: 60px;
            border-radius: 8px;
            font-size: 1rem;
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Contagem */
        .counting-target {
            display: flex;
            gap: 5px;
            justify-content: center;
            align-items: center;
            margin-bottom: 5px;
        }
        .count-box {
            width: 50px;
            height: 50px;
            font-size: 1rem;
            background: #fff9c4;
            border: 2px solid #000;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #counter {
            font-size: 1.2rem;
            margin: 5px;
        }

        /* Montando palavras */
        .word-target {
            font-size: 1rem;
            margin: 5px;
            color: #555;
            text-align: center;
        }
        .letter-box {
            width: 30px;
            height: 30px;
            display: inline-block;
            margin: 2px;
            font-size: 1.2rem;
            color: #666;
            border-bottom: 2px solid #999;
            text-align: center;
        }
        .scrambled-letters {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            max-height: 30vh;
            overflow: hidden;
        }
        .word-letter {
            background-color: #ffd700;
            width: 40px;
            height: 40px;
            border-radius: 5px;
            font-size: 1.2rem;
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .revealed {
            color: #2e7d32 !important;
            border-bottom: 2px solid #2e7d32;
        }

        /* Sombras - dividir em duas colunas lado a lado, cada 50% da tela, sem rolagem */
        .shadow-container-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            width: 100%;
            height: 60vh;
            overflow: hidden;
        }
        .shadow-column {
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            align-items: center;
            justify-content: flex-start;
            width: 48%;
            gap: 5px;
            max-height: 60vh;
        }
        .shadow-slot,
        .shadow-item {
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            border-radius: 8px;
            border: 2px solid #000;
            cursor: pointer;
            background: #fff9c4;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 5px;
            text-align: center;
        }
        .shadow-slot {
            opacity: 0.5;
            border-color: #ccc;
        }
        .shadow-match {
            background: #c8e6c9 !important;
            border-color: #4caf50 !important;
            opacity: 1 !important;
        }
        .shadow-mismatch {
            background: #ffcdd2 !important;
            border-color: #c62828 !important;
            animation: shake 0.5s;
        }

        /* Quebra-cabeÃ§a */
        .numbers-container {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 5px 0;
            flex-wrap: nowrap; /* todos em uma linha */
            overflow: hidden;
            max-width: 100%;
        }
        .quantities-container {
            display: flex;
            justify-content: center;
            gap: 5px;
            flex-wrap: wrap;
            max-height: 40vh;
            overflow: hidden;
            margin-bottom: 5px;
        }
        .puzzle-piece {
            width: 60px;
            height: 60px;
            font-size: 1rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid transparent;
            background: #ffb74d;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .number-piece {
            background: #81d4fa;
            border-color: #000;
        }
        .emoji-piece {
            border-color: #000;
            background: #fff;
        }
        .puzzle-emoji-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 2px;
        }
        .emoji-cell {
            font-size: 1rem;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .matched {
            background: #c8e6c9 !important;
            border-color: #4caf50 !important;
        }

        /* Cores */
        .color-item {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 5px;
            border: 2px solid #fff;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        .color-bin {
            width: 60px;
            height: 60px;
            border: 2px dashed #000;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white;
            margin: 5px;
            font-size: 0.7rem;
            text-align: center;
            padding: 2px;
            cursor: pointer;
        }

        /* Clima */
        .weather-card {
            width: 180px;
            margin: 5px;
            padding: 10px;
            border-radius: 8px;
            background: #fff;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }
        .weather-items {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            margin-top: 5px;
            max-width: 180px;
        }
        .weather-item {
            font-size: 1.5rem;
            background: #f5f5f5;
            border-radius: 5px;
            padding: 5px;
            cursor: pointer;
        }

        /* Categorias */
        .category-game-container {
            display: flex;
            flex-wrap: nowrap;
            gap: 5px;
            justify-content: center;
            margin: 0 auto;
            width: 100%;
            overflow: hidden;
        }
        .category-bin {
            width: 90px;
            min-height: 60px;
            border: 2px dashed #000;
            border-radius: 8px;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2px;
            gap: 2px;
            font-size: 0.7rem;
        }
        .bin-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 2px;
            justify-content: center;
            min-height: 30px;
        }
        .category-item {
            width: 50px;
            height: 50px;
            font-size: 1.4rem;
            border: 2px solid #000;
            border-radius: 6px;
            background-color: #c8e6c9;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin: 2px;
        }
        .category-wrong {
            background-color: #ffcdd2 !important;
            border-color: #c62828 !important;
            animation: shake 0.5s;
        }

        /* Ler */
        .reading-title {
            font-size: 1rem;
            margin-bottom: 5px;
        }
        .reading-word-box {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            margin-bottom: 5px;
        }
        .reading-syllable {
            background-color: #ffd54f;
            border: 2px solid #000;
            border-radius: 5px;
            font-size: 1rem;
            padding: 5px 10px;
            cursor: pointer;
        }
        .reading-result {
            display: flex;
            gap: 2px;
            justify-content: center;
            margin-bottom: 5px;
        }
        .reading-result-syllable {
            width: 30px;
            height: 30px;
            background-color: #fff9c4;
            border: 2px solid #000;
            border-radius: 5px;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Palworld / Pokemon */
        .pal-list, .pokemon-list {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 5px;
        }
        .pal-item, .pokemon-item {
            width: 120px;
            background-color: #fff9c4;
            border: 2px solid #000;
            border-radius: 8px;
            padding: 5px;
            text-align: center;
            margin: 0 5px;
        }
        .pal-item img, .pokemon-item img {
            max-width: 100%;
            max-height: 80px;
            object-fit: contain;
        }
        .pal-name, .pokemon-name {
            font-size: 0.9rem;
            margin: 5px 0 0;
        }
        .letters-options {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            max-height: 40vh;
            overflow: hidden;
        }
        .letter-choice {
            background-color: #c8e6c9;
            width: 40px;
            height: 40px;
            border: 2px solid #000;
            border-radius: 5px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .letter-choice:hover {
            background-color: #aed581;
        }

        /* AnimaÃ§Ã£o de sacudir */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        /* AnimaÃ§Ã£o de figurinha voando */
        .sticker-fly {
            position: fixed;
            width: 80px;
            height: 80px;
            pointer-events: none;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff9c4;
            border: 2px solid #ff9800;
            border-radius: 10px;
            box-shadow: 0 0 5px rgba(0,0,0,.3);
            overflow: hidden;
            transition: transform 1.5s ease, opacity 1.5s ease;
        }
        .sticker-fly img {
            max-width: 70px;
            max-height: 70px;
        }

        /* Modal e confetes */
        .confetti-canvas {
            pointer-events: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            display: none;
        }
        .modal-backdrop {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 9998;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
        }
        .modal-base {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            z-index: 9999;
            width: 90%;
            max-width: 400px;
            display: none;
        }
        #stickers-modal h3 {
            margin-bottom: 10px;
        }
        .stickers-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            margin-bottom: 10px;
            max-height: 40vh;
            overflow-y: auto;
        }
        .sticker-item {
            width: 70px;
            height: 70px;
            background: #ffeb3b;
            padding: 2px;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .sticker-item img {
            max-width: 60px;
            max-height: 60px;
        }
        #congratsModal .balloons {
            text-align: center;
            margin-bottom: 10px;
        }
        #congratsModal .balloons img {
            width: 60px;
            margin: 0 3px;
        }
    </style>
</head>
<body oncontextmenu="return false;">
<canvas class="confetti-canvas" id="confettiCanvas"></canvas>

<div class="modal-backdrop" id="modal-backdrop"></div>

<!-- MODAL FIGURINHAS -->
<div class="modal-base" id="stickers-modal">
    <h3>Minhas Figurinhas</h3>
    <div class="stickers-container" id="stickers-container"></div>
    <button class="btn btn-danger" onclick="closeStickersModal()">Fechar</button>
</div>

<!-- MODAL PARABÃ‰NS -->
<div class="modal-base" id="congratsModal">
    <h2>ParabÃ©ns!</h2>
    <div class="balloons">
        <img src="https://cdn-icons-png.flaticon.com/512/2553/2553619.png" alt="Balloon">
        <img src="https://cdn-icons-png.flaticon.com/512/2553/2553619.png" alt="Balloon">
        <img src="https://cdn-icons-png.flaticon.com/512/2553/2553619.png" alt="Balloon">
    </div>
    <p id="congratsText">VocÃª atingiu sua meta de estrelas!</p>
    <div style="margin-top: 10px;">
        <button class="btn btn-info" onclick="continueAfterGoal()">Continuar Jogando</button>
        <button class="btn btn-outline-secondary" onclick="restartGame()">RecomeÃ§ar</button>
    </div>
</div>

<!-- CONTAINER GERAL -->
<div class="game-container">
    <!-- Top bar -->
    <div class="top-bar">
        <div class="player-info d-none" id="playerInfoContainer">
            <div class="player-name" id="player-name"></div>
            <div class="stars-info">
                <span>â­</span>
                <span id="stars-count">0</span>
            </div>
            <div class="trophy-info" id="trophyInfo">ğŸ†</div>
            <button id="stickers-btn" onclick="openStickersModal()">Figurinhas
                <div id="stickers-count" style="display:none">0</div>
            </button>
        </div>
        <!-- BotÃ£o de voltar (discreto) -->
        <button id="backToMenuBtn" onclick="cancelNextGameAndMenu()" style="display:none;">â† Menu</button>
    </div>

    <!-- ConteÃºdo principal logo/telas -->
    <div id="mainContent">
        <!-- TELA INICIAL -->
        <div class="container" id="startScreen">
            <h1 class="main-title" id="mainTitle">Vamos Aprender!</h1>
            <div id="start-menu">
                <div id="continue-btn-container">
                    <button class="btn btn-primary start-menu-btn" id="continueGameBtn">Continuar Jogo</button>
                </div>
                <button class="btn btn-success start-menu-btn" id="newGameBtn">Novo Jogo</button>

                <div class="d-none" id="newGameForm">
                    <p>Digite seu nome para comeÃ§ar:</p>
                    <input type="text" id="playerNameInput" class="start-menu-input" />
                    <p>Quantas estrelas quer ganhar?</p>
                    <input type="number" id="playerGoalInput" class="start-menu-input" style="width:120px;" min="1" max="9999" />
                    <br />
                    <button id="startNewGameBtn" class="btn btn-warning">Iniciar</button>
                </div>
            </div>
        </div>

        <!-- MENU PRINCIPAL DE JOGOS -->
        <div id="main-menu" class="d-none"></div>

        <!-- ÃREA DO JOGO -->
        <div id="game-area" class="d-none">
            <div id="content"></div>
            <div id="feedback" class="feedback"></div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    /* Script de funcionalidade do jogo - praticamente o mesmo, apenas ajustamos estilos e escondemos/exibimos o tÃ­tulo quando necessÃ¡rio */

    document.addEventListener('selectstart', (e) => e.preventDefault());
    document.addEventListener('contextmenu', (e) => e.preventDefault());

    let savedName = localStorage.getItem("playerName") || "";
    let savedStars = parseInt(localStorage.getItem("stars") || "0", 10);
    let savedGoal = parseInt(localStorage.getItem("playerGoal") || "0", 10);
    let hasReachedGoal = (localStorage.getItem("hasReachedGoal") === "true");

    let playerName = savedName;
    let stars = savedStars;
    let previousStars = stars;
    let currentGame = null;
    let speechSynth = window.speechSynthesis;
    let nextGameTimeout = null;
    let locked = false;

    let lastNumber = null;
    let lastLetter = null;
    let lastCount = null;
    let lastWordEmoji = null;
    let lastShadowSet = null;
    let lastPuzzleSet = null;
    let lastColorsSet = null;
    let lastWeather = null;
    let lastCategoriesSet = null;
    let lastReadingWord = null;

    let gameStars = JSON.parse(localStorage.getItem("gameStars") || "{}");

    let stickerList = JSON.parse(localStorage.getItem("myStickers") || "[]");
    const stickerCountEl = document.getElementById("stickers-count");
    function updateStickerCount() {
        const count = stickerList.length;
        if(count > 0) {
            stickerCountEl.textContent = count;
            stickerCountEl.style.display = "flex";
        } else {
            stickerCountEl.style.display = "none";
        }
    }
    updateStickerCount();

    const possibleStickers = [
        { name: "Pikachu",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png" },
        { name: "Charmander", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png" },
        { name: "Bulbasaur",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png" },
        { name: "Squirtle",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png" },
        { name: "Stitch",     img: "https://cdn-icons-png.flaticon.com/512/6112/6112465.png" },
        { name: "Pal1",       img: "https://cdn-icons-png.flaticon.com/512/528/528099.png" },
        { name: "Pal2",       img: "https://cdn-icons-png.flaticon.com/512/528/528092.png" },
        { name: "Eevee",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/133.png" },
        { name: "Mew",        img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/151.png" }
    ];

    /* Palworld e Pokemon data */
    const palworldData = [
        { name:"Lamball",   img:"img/T_SheepBall_icon_normal.webp" },
        { name:"Cattiva",   img:"img/T_PinkCat_icon_normal.webp" },
        { name:"Chikipi",   img:"img/T_ChickenPal_icon_normal.webp" },
        { name:"Vixy",      img:"img/T_CuteFox_icon_normal.webp" },
        { name:"Cremis",    img:"img/T_WoolFox_icon_normal.webp" },
        { name:"Elizabee",  img:"img/T_QueenBee_icon_normal.webp" },
        { name:"Lunaris",   img:"img/T_Mutant_icon_normal.webp" },
        { name:"Tombat",    img:"img/T_CatBat_icon_normal.webp" },
        { name:"Katress",   img:"img/T_CatMage_icon_normal.webp" },
        { name:"Mammorest Cryst", img:"img/T_GrassMammoth_Ice_icon_normal.webp" },
        { name:"Mammorest", img:"img/T_GrassMammoth_icon_normal.webp" },
        { name:"Anubis",    img:"img/T_Anubis_icon_normal.webp" },
        { name:"Grizzbolt", img:"img/T_ElecPanda_icon_normal.webp" },
        { name:"Paladius",  img:"img/T_SaintCentaur_icon_normal.webp" },
        { name:"Frostallion",img:"img/T_IceHorse_icon_normal.webp" },
        { name:"Jetragon",  img:"img/T_JetDragon_icon_normal.webp" },
        { name:"Bellanoir", img:"img/T_NightLady_icon_normal.webp" },
    ];
    const pokemonData = [
        { name: "Bulbasaur",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png" },
        { name: "Ivysaur",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/2.png" },
        { name: "Venusaur",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/3.png" },
        { name: "Charmander", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png" },
        { name: "Charmeleon", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/5.png" },
        { name: "Charizard",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/6.png" },
        { name: "Squirtle",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png" },
        { name: "Wartortle",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/8.png" },
        { name: "Blastoise",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/9.png" },
        { name: "Caterpie",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10.png" },
        { name: "Metapod",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/11.png" },
        { name: "Butterfree", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/12.png" },
        { name: "Weedle",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/13.png" },
        { name: "Kakuna",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/14.png" },
        { name: "Beedrill",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/15.png" },
        { name: "Pidgey",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/16.png" },
        { name: "Pidgeotto",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/17.png" },
        { name: "Pidgeot",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/18.png" },
        { name: "Rattata",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/19.png" },
        { name: "Raticate",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/20.png" },
    ];

    /* Elementos DOM principais */
    const startMenuEl       = document.getElementById("start-menu");
    const continueBtnContainer = document.getElementById("continue-btn-container");
    const continueGameBtn   = document.getElementById("continueGameBtn");
    const newGameBtn        = document.getElementById("newGameBtn");
    const newGameForm       = document.getElementById("newGameForm");
    const playerNameInput   = document.getElementById("playerNameInput");
    const playerGoalInput   = document.getElementById("playerGoalInput");
    const startNewGameBtn   = document.getElementById("startNewGameBtn");

    const playerInfoContainer = document.getElementById("playerInfoContainer");
    const trophyInfoEl       = document.getElementById("trophyInfo");
    const playerNameEl       = document.getElementById("player-name");
    const starsCountEl       = document.getElementById("stars-count");

    const mainTitleEl        = document.getElementById("mainTitle");
    const mainMenuEl         = document.getElementById("main-menu");
    const gameAreaEl         = document.getElementById("game-area");

    const backToMenuBtn      = document.getElementById("backToMenuBtn");
    const confettiCanvas     = document.getElementById("confettiCanvas");
    const confettiCtx        = confettiCanvas.getContext("2d");
    let confettiActive       = false;

    window.onload = function () {
        showStartMenu();
        if(hasReachedGoal) {
            trophyInfoEl.style.display = "inline-block";
        }
    };

    function showStartMenu() {
        document.getElementById("startScreen").style.display = "block";
        if (!savedName) {
            continueBtnContainer.style.display = "none";
        } else {
            continueBtnContainer.style.display = "block";
        }
        mainMenuEl.classList.add("d-none");
        playerInfoContainer.classList.add("d-none");
        gameAreaEl.classList.add("d-none");
        mainTitleEl.style.display = "block";
        backToMenuBtn.style.display = "none";
        playerNameInput.value = savedName || "";
    }

    continueGameBtn.onclick = function () {
        playerName = savedName;
        stars = savedStars;
        previousStars = stars;
        savedGoal = parseInt(localStorage.getItem("playerGoal") || "0", 10);
        hasReachedGoal = (localStorage.getItem("hasReachedGoal") === "true");
        document.getElementById("startScreen").style.display = "none";
        showPlayerInfo();
        buildMainMenu();
        showMainMenu();
    };

    newGameBtn.onclick = function () {
        newGameForm.classList.remove("d-none");
    };

    startNewGameBtn.onclick = function () {
        const chosenName = playerNameInput.value.trim();
        const chosenGoal = parseInt(playerGoalInput.value.trim() || "0", 10);
        if (!chosenName) {
            alert("Por favor, informe um nome para iniciar!");
            return;
        }
        if (chosenGoal < 1) {
            alert("Por favor, informe uma meta de estrelas vÃ¡lida!");
            return;
        }
        playerName = chosenName;
        stars = 0;
        previousStars = 0;
        localStorage.setItem("playerName", playerName);
        localStorage.setItem("stars", String(stars));

        savedGoal = chosenGoal;
        localStorage.setItem("playerGoal", String(chosenGoal));
        hasReachedGoal = false;
        localStorage.setItem("hasReachedGoal", "false");

        gameStars = {};
        localStorage.setItem("gameStars", JSON.stringify(gameStars));

        stickerList = [];
        localStorage.removeItem("myStickers");
        updateStickerCount();

        document.getElementById("startScreen").style.display = "none";
        showPlayerInfo();
        buildMainMenu();
        showMainMenu();
    };

    function showPlayerInfo() {
        playerInfoContainer.classList.remove("d-none");
        playerNameEl.textContent = playerName;
        starsCountEl.textContent = stars;
        trophyInfoEl.style.display = hasReachedGoal ? "inline-block" : "none";
    }

    function buildMainMenu(showMenu = true) {
        if (showMenu) {
            mainMenuEl.classList.remove("d-none");
        }
        mainMenuEl.innerHTML = "";

        const gameConfigs = [
            { id: "numbers",   label: "ğŸ”¢ NÃºmeros" },
            { id: "letters",   label: "ğŸ”¤ Letras" },
            { id: "counting",  label: "ğŸ Contar" },
            { id: "word",      label: "ğŸ§© Palavras" },
            { id: "shadows",   label: "ğŸ­ Sombras" },
            { id: "puzzle",    label: "ğŸ§© Quebra cabeÃ§a" },
            { id: "colors",    label: "ğŸ¨ Cores" },
            { id: "weather",   label: "â˜” Clima" },
            { id: "categories",label: "ğŸš€ Categorias" },
            { id: "reading",   label: "ğŸ“– Ler" },
            { id: "palworld",  label: "ğŸ¾ Palworld" },
            { id: "pokemon",   label: "ğŸ¦Š Pokemon" }
        ];

        gameConfigs.forEach((cfg) => {
            const starsInThisGame = gameStars[cfg.id] || 0;
            const gmDiv = document.createElement("div");
            gmDiv.className = "game-mode";
            gmDiv.innerText = `${cfg.label} (${starsInThisGame}â­)`;
            gmDiv.onclick = () => startGame(cfg.id);
            mainMenuEl.appendChild(gmDiv);
        });
    }

    function showMainMenu() {
        clearTimeoutIfAny();
        locked = false;
        document.getElementById("startScreen").style.display = "none";
        mainMenuEl.classList.remove("d-none");
        gameAreaEl.classList.add("d-none");

        /* Exibir top info e esconder tÃ­tulo grande */
        mainTitleEl.style.display = "none";
        playerInfoContainer.classList.remove("d-none");
        backToMenuBtn.style.display = "none";
    }

    function cancelNextGameAndMenu() {
        clearTimeoutIfAny();
        locked = false;
        showMainMenu();
    }

    function clearTimeoutIfAny() {
        if (nextGameTimeout) {
            clearTimeout(nextGameTimeout);
            nextGameTimeout = null;
        }
    }

    function startGame(mode) {
        clearTimeoutIfAny();
        locked = false;
        currentGame = mode;

        mainMenuEl.classList.add("d-none");
        gameAreaEl.classList.remove("d-none");
        gameAreaEl.style.display = "block";
        backToMenuBtn.style.display = "inline"; /* Exibe o botÃ£o de voltar no topo */

        document.getElementById("feedback").textContent = "";
        document.getElementById("content").innerHTML = "";

        switch (mode) {
            case "numbers":   initNumbersGame(); break;
            case "letters":   initLettersGame(); break;
            case "counting":  initCountingGame(); break;
            case "word":      initWordGame(); break;
            case "shadows":   initShadowGame(); break;
            case "puzzle":    initPuzzleGame(); break;
            case "colors":    initColorGame(); break;
            case "weather":   initWeatherGame(); break;
            case "categories":initCategoryGame(); break;
            case "reading":   initReadingGame(); break;
            case "palworld":  initPalworldGame(); break;
            case "pokemon":   initPokemonGame(); break;
        }
    }

    function scheduleReplayGame(mode, delay=1500) {
        clearTimeoutIfAny();
        nextGameTimeout = setTimeout(() => {
            startGame(mode);
        }, delay);
    }

    /* ============================
       AQUI VÃƒO OS JOGOS
    ============================ */
    /* 1) NÃšMEROS */
    function initNumbersGame() {
        const content = document.getElementById("content");
        let targetNumber = Math.floor(Math.random() * 40) + 1;
        while (targetNumber === lastNumber) {
            targetNumber = Math.floor(Math.random() * 40) + 1;
        }
        lastNumber = targetNumber;
        content.innerHTML = `
      <h2>Encontre o nÃºmero:</h2>
      <div style="display:flex; justify-content:center; margin-bottom:5px;">
        <div class="target-number">${targetNumber}</div>
      </div>
      <div class="numbers-grid" id="numbers-grid"></div>
    `;
        let possibleNumbers = Array.from({length:80},(_,i)=> i+1);
        const options = shuffle([
            targetNumber,
            ...shuffle(possibleNumbers.filter((n) => n !== targetNumber)).slice(0,5)
        ]);
        const grid = document.getElementById("numbers-grid");
        options.forEach((num) => {
            const div = document.createElement("div");
            div.className = "number-option";
            div.textContent = num;
            div.onclick = () => {
                if(locked) return;
                checkNumber(num === targetNumber);
            };
            grid.appendChild(div);
        });
        speak(`Encontre o nÃºmero ${targetNumber}`);
    }
    function checkNumber(isCorrect) {
        locked = true;
        if (isCorrect) {
            updateStars(1);
            showFeedback("Correto!", true);
            scheduleReplayGame("numbers");
        } else {
            updateStars(-1);
            showFeedback("Tente novamente!", false);
            speak("Ops! Esse nÃ£o Ã© o nÃºmero");
            locked = false;
        }
    }

    /* 2) LETRAS */
    const emojiDatabase = {
        A: [{ emoji: "âœˆï¸", nome: "AviÃ£o" }, { emoji: "ğŸŒ³", nome: "Ãrvore" }, { emoji: "ğŸ¨", nome: "Arte" },
            { emoji: "ğŸ¹", nome: "Arco e Flecha" }, { emoji: "ğŸœ", nome: "Aranha" }, { emoji: "âš“", nome: "Ã‚ncora" },
            { emoji: "ğŸ­", nome: "Ator" }, { emoji: "ğŸš‘", nome: "AmbulÃ¢ncia" }, { emoji: "ğŸŒˆ", nome: "Arco-Ã­ris" },
            { emoji: "ğŸš", nome: "Arroz" }],
        B: [{ emoji: "ğŸˆ", nome: "BalÃ£o" }, { emoji: "ğŸš²", nome: "Bicicleta" }, { emoji: "ğŸŒ", nome: "Banana" },
            { emoji: "ğŸ”‹", nome: "Bateria" }, { emoji: "ğŸ€", nome: "Basquete" }, { emoji: "ğŸ", nome: "Abelha" },
            { emoji: "ğŸŸ", nome: "Batata Frita" }, { emoji: "âš–", nome: "BalanÃ§a" }, { emoji: "ğŸ†", nome: "Berinjela" },
            { emoji: "âš½", nome: "Bola" }],
        C: [{ emoji: "ğŸ¡", nome: "Casa" }, { emoji: "ğŸ°", nome: "Castelo" }, { emoji: "ğŸ™ï¸", nome: "Cidade" },
            { emoji: "ğŸ", nome: "Cobra" }, { emoji: "ğŸ¶", nome: "Cachorro" }, { emoji: "â˜•", nome: "CafÃ©" },
            { emoji: "ğŸµ", nome: "ChÃ¡" }, { emoji: "ğŸš—", nome: "Carro" }, { emoji: "ğŸ ", nome: "Carrossel" },
            { emoji: "ğŸ¦Œ", nome: "Cervo" }, { emoji: "ğŸ¥•", nome: "Cenoura" }, { emoji: "ğŸ”‘", nome: "Chave" },
            { emoji: "ğŸ¦‰", nome: "Coruja" }, { emoji: "ğŸƒ", nome: "Corrida" }],
        D: [{ emoji: "ğŸ²", nome: "Dado" }, { emoji: "ğŸ‰", nome: "DragÃ£o" }, { emoji: "ğŸ’", nome: "Diamante" },
            { emoji: "ğŸ¯", nome: "Dardo" }, { emoji: "ğŸ“…", nome: "Data" }],
        E: [{ emoji: "â­", nome: "Estrela" }, { emoji: "ğŸ“§", nome: "E-mail" }, { emoji: "ğŸ˜", nome: "Elefante" },
            { emoji: "ğŸ”Œ", nome: "Energia" }, { emoji: "ğŸ›¤", nome: "Estrada" }],
        F: [{ emoji: "ğŸ—", nome: "Fita" }, { emoji: "ğŸŒ¸", nome: "Flor" }, { emoji: "ğŸœ", nome: "Formiga" },
            { emoji: "ğŸ”¥", nome: "Fogo" }, { emoji: "ğŸº", nome: "Flauta" }, { emoji: "ğŸ", nome: "Final" },
            { emoji: "ğŸ‚", nome: "Folha" }, { emoji: "ğŸš€", nome: "Foguete" }, { emoji: "ğŸŒ¹", nome: "Flor" }],
        G: [{ emoji: "ğŸ¬", nome: "Golfinho" }, { emoji: "ğŸ±", nome: "Gato" }, { emoji: "ğŸ¦’", nome: "Girafa" },
            { emoji: "â˜‚ï¸", nome: "Guarda-chuva" }, { emoji: "ğŸ¸", nome: "Guitarra" }, { emoji: "ğŸ¥…", nome: "Gol" },
            { emoji: "ğŸŒï¸", nome: "Golfe" }],
        H: [{ emoji: "ğŸ¥", nome: "Hospital" }, { emoji: "ğŸš", nome: "HelicÃ³ptero" }, { emoji: "ğŸ¹", nome: "Hamster" }],
        I: [{ emoji: "ğŸ", nome: "Ilha" }, { emoji: "ğŸ’¡", nome: "Ideia" }, { emoji: "ğŸ“±", nome: "Internet" },
            { emoji: "ğŸ–¼", nome: "Imagem" }],
        J: [{ emoji: "ğŸ·", nome: "Jazz" }, { emoji: "ğŸš™", nome: "Jipe" }],
        K: [{ emoji: "ğŸ¥", nome: "Kiwi" }, { emoji: "ğŸ¤¹", nome: "KaratÃª" }, { emoji: "ğŸ¥‹", nome: "Kimono" }],
        L: [{ emoji: "ğŸ‹", nome: "LimÃ£o" }, { emoji: "ğŸ“š", nome: "Livro" }, { emoji: "ğŸ’¡", nome: "LÃ¢mpada" },
            { emoji: "ğŸ¦", nome: "LeÃ£o" }, { emoji: "ğŸŒ™", nome: "Lua" }, { emoji: "ğŸŠ", nome: "Laranja" },
            { emoji: "ğŸï¸", nome: "Lago" }, { emoji: "ğŸ›³", nome: "Lancha" }],
        M: [{ emoji: "ğŸ¶", nome: "MÃºsica" }, { emoji: "ğŸ¤", nome: "Microfone" }, { emoji: "ğŸ", nome: "MaÃ§Ã£" },
            { emoji: "ğŸµ", nome: "Macaco" }, { emoji: "ğŸˆ", nome: "MelÃ£o" }, { emoji: "ğŸŒŠ", nome: "Mar" },
            { emoji: "ğŸ”", nome: "Montanha" }, { emoji: "ğŸ—º", nome: "Mapa" }, { emoji: "âœ‰ï¸", nome: "Mensagem" },
            { emoji: "ğŸš‡", nome: "MetrÃ´" }, { emoji: "ğŸ¦‡", nome: "Morcego" }, { emoji: "ğŸ”¨", nome: "Machado" }],
        N: [{ emoji: "â„ï¸", nome: "Neve" }, { emoji: "ğŸš¢", nome: "Navio" }],
        O: [{ emoji: "ğŸ¥š", nome: "Ovo" }, { emoji: "ğŸ¢", nome: "Oficina" }, { emoji: "ğŸ¨", nome: "Obra de Arte" },
            { emoji: "ğŸšŒ", nome: "Ã”nibus" }],
        P: [{ emoji: "ğŸ ", nome: "Peixe" }, { emoji: "ğŸ•", nome: "Pizza" }, { emoji: "ğŸ§", nome: "Pinguim" },
            { emoji: "ğŸ", nome: "Presente" }, { emoji: "ğŸšª", nome: "Porta" }, { emoji: "ğŸ™", nome: "Polvo" },
            { emoji: "ğŸ“¦", nome: "Pacote" }, { emoji: "ğŸ¥", nome: "Panqueca" }, { emoji: "ğŸ¥–", nome: "PÃ£o" }],
        Q: [{ emoji: "ğŸ‘‘", nome: "Queijo" }, { emoji: "ğŸƒ", nome: "Quebra-cabeÃ§a" }, { emoji: "ğŸ–¼", nome: "Quadro" }],
        R: [{ emoji: "ğŸ¦Š", nome: "Raposa" }, { emoji: "ğŸ“»", nome: "RÃ¡dio" }, { emoji: "ğŸ¦", nome: "Rinoceronte" },
            { emoji: "ğŸ¤–", nome: "Robo" }],
        S: [{ emoji: "ğŸš¦", nome: "SemÃ¡foro" }, { emoji: "ğŸŒ", nome: "Sol" }, { emoji: "ğŸ¥—", nome: "Salada" },
            { emoji: "ğŸ””", nome: "Sino de Natal" }],
        T: [{ emoji: "ğŸ©", nome: "Teatro" }, { emoji: "ğŸŒ®", nome: "Taco" }, { emoji: "ğŸš†", nome: "Trem" },
            { emoji: "ğŸ¹", nome: "Teclado" }, { emoji: "ğŸº", nome: "Trompete" }, { emoji: "ğŸ“", nome: "Telefone" },
            { emoji: "ğŸŒ", nome: "Terra" }, { emoji: "ğŸ†", nome: "TrofÃ©u" }, { emoji: "ğŸ¥", nome: "Tambor" }],
        U: [{ emoji: "ğŸ¦„", nome: "UnicÃ³rnio" }, { emoji: "ğŸ‡", nome: "Uva" }],
        V: [{ emoji: "ğŸ»", nome: "Violino" }, { emoji: "ğŸŒ‹", nome: "VulcÃ£o" }, { emoji: "ğŸ·", nome: "Vinho" },
            { emoji: "ğŸ®", nome: "Videogame" }, { emoji: "ğŸ“¹", nome: "VÃ­deo" }, { emoji: "ğŸš", nome: "Van" },
            { emoji: "ğŸ”Š", nome: "Volume" }],
        X: [{ emoji: "âŒ", nome: "Xis" }],
        Z: [{ emoji: "ğŸ¦“", nome: "Zebra" }]
    };
    function initLettersGame() {
        const content = document.getElementById("content");
        const validLetters = Object.keys(emojiDatabase);
        let targetLetter = validLetters[Math.floor(Math.random() * validLetters.length)];
        while (targetLetter === lastLetter) {
            targetLetter = validLetters[Math.floor(Math.random() * validLetters.length)];
        }
        lastLetter = targetLetter;
        const validEmojis = emojiDatabase[targetLetter];
        content.innerHTML = `
      <h2>Encontre emojis que comeÃ§am com:</h2>
      <div style="font-size:2rem;">${targetLetter}</div>
      <div class="emoji-grid"></div>
    `;
        const grid = content.querySelector(".emoji-grid");
        const allEmojis = Object.values(emojiDatabase).flat();
        const correctOptions = shuffle([...validEmojis]).slice(0,3);
        const incorrectOptions = shuffle(allEmojis.filter((e) => !validEmojis.includes(e))).slice(0,7);
        const mixedOptions = shuffle([...correctOptions, ...incorrectOptions]);
        mixedOptions.forEach((emojiObj) => {
            const div = document.createElement("div");
            div.className = "emoji-option";
            div.innerHTML = `
        <div>${emojiObj.emoji}</div>
        <div class="emoji-name">${emojiObj.nome}</div>
      `;
            div.onclick = () => {
                if(locked) return;
                checkEmoji(validEmojis.includes(emojiObj), emojiObj.nome);
            };
            grid.appendChild(div);
        });
        speak(`Encontre coisas que comeÃ§am com a letra ${targetLetter}`);
    }
    function checkEmoji(isCorrect, nome) {
        locked = true;
        if (isCorrect) {
            updateStars(1);
            showFeedback("Certo!", true);
            scheduleReplayGame("letters");
        } else {
            updateStars(-1);
            showFeedback(`"${nome}" comeÃ§a com ${nome[0].toUpperCase()}!`, false);
            speak(`Ops! ${nome} comeÃ§a com ${nome[0].toUpperCase()}!`);
            locked = false;
        }
    }

    /* 3) CONTAR */
    function initCountingGame() {
        const content = document.getElementById("content");
        let targetCount = Math.floor(Math.random() * 20) + 1;
        while (targetCount === lastCount) {
            targetCount = Math.floor(Math.random() * 20) + 1;
        }
        lastCount = targetCount;
        const possibleEmojis = ["ğŸ", "â­", "ğŸ»", "ğŸˆ", "ğŸª"];
        const targetEmoji = shuffle(possibleEmojis)[0];
        content.innerHTML = `
      <h2>Conte atÃ©:</h2>
      <div class="counting-target">
        <div class="count-box">${targetCount}</div>
        <div class="count-box">${targetEmoji}</div>
      </div>
      <div id="counter">0</div>
      <div class="emoji-grid"></div>
    `;
        const grid = content.querySelector(".emoji-grid");
        const distractors = [
            "ğŸ¶","ğŸ‰","ğŸš—","ğŸ®","ğŸ•","ğŸ€","ğŸ ","ğŸ©","ğŸš‚","ğŸŒ»",
            "ğŸ±","ğŸ¦Š","ğŸ°","ğŸ”","ğŸš‘","ğŸ¦"
        ];
        const options = shuffle([ targetEmoji, ...shuffle(distractors).slice(0,9) ]);
        options.forEach((emoji) => {
            const div = document.createElement("div");
            div.className = "emoji-option";
            div.textContent = emoji;
            div.onclick = () => {
                if(locked) return;
                handleCountClick(emoji === targetEmoji, targetCount);
            };
            grid.appendChild(div);
        });
        speak(`Clique ${targetCount} vezes no ${getEmojiName(targetEmoji)}`);
    }
    function handleCountClick(isCorrect, target) {
        if (!isCorrect) {
            speak("Esse nÃ£o Ã© o emoji correto!");
            updateStars(-1);
            showFeedback("Emoji errado!", false);
            return;
        }
        const counter = document.getElementById("counter");
        let count = parseInt(counter.textContent) + 1;
        counter.textContent = count;
        speak(count.toString());
        if (count === target) {
            locked = true;
            updateStars(1);
            showFeedback("Contagem correta!", true);
            scheduleReplayGame("counting");
        }
    }
    function getEmojiName(emoji) {
        const names = {
            "ğŸ": "maÃ§Ã£","â­": "estrela","ğŸ»": "urso","ğŸˆ": "balÃ£o","ğŸª": "biscoito",
            "ğŸ¶": "cachorro","ğŸ‰": "melancia","ğŸš—": "carro","ğŸ®": "videogame","ğŸ•": "pizza",
            "ğŸ€": "bola","ğŸ ": "peixe","ğŸ©": "rosquinha","ğŸš‚": "trem","ğŸŒ»": "girassol",
            "ğŸ±": "gato","ğŸ¦Š": "raposa","ğŸ°": "coelho","ğŸ”": "galinha","ğŸš‘": "ambulÃ¢ncia",
            "ğŸ¦": "leÃ£o"
        };
        return names[emoji] || "objeto";
    }

    /* 4) PALAVRAS */
    function initWordGame() {
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Monte a palavra do emoji:</h2>";
        const allEmojis = Object.values(emojiDatabase).flat();
        let randomEmoji = shuffle(allEmojis)[0];
        while (randomEmoji === lastWordEmoji) {
            randomEmoji = shuffle(allEmojis)[0];
        }
        lastWordEmoji = randomEmoji;
        const originalName = randomEmoji.nome.toUpperCase();
        const targetLetters = Array.from(originalName).filter(c => c!==" " && c!=="-");
        let targetDisplay = "";
        targetLetters.forEach((letter, i) => {
            targetDisplay += `<span class="letter-box" id="target-letter-${i}">${letter}</span>`;
        });
        content.innerHTML += `
      <div class="word-target">
        ${randomEmoji.emoji}
        <div id="target-word">${targetDisplay}</div>
      </div>
      <div class="scrambled-letters" id="scrambled-letters"></div>
    `;
        let scrambledLetters = shuffle([...targetLetters]);
        const lettersContainer = document.getElementById("scrambled-letters");
        scrambledLetters.forEach((letter) => {
            const div = document.createElement("div");
            div.className = "word-letter";
            div.textContent = letter;
            div.onclick = function () {
                if(locked) return;
                handleLetterClick(this, targetLetters);
            };
            lettersContainer.appendChild(div);
        });
        speak(`Monte a palavra: ${randomEmoji.nome}`);
    }
    function handleLetterClick(letterElement, targetLetters) {
        const revealedLetters = document.querySelectorAll("#target-word .revealed");
        const nextIndex = revealedLetters.length;
        speak(letterElement.textContent);
        if (nextIndex < targetLetters.length) {
            const correctLetter = targetLetters[nextIndex];
            if (letterElement.textContent === correctLetter) {
                document.getElementById(`target-letter-${nextIndex}`).classList.add("revealed");
                letterElement.style.visibility = "hidden";
                if (nextIndex === targetLetters.length - 1) {
                    locked = true;
                    showFeedback("Palavra correta!", true);
                    updateStars(1);
                    scheduleReplayGame("word");
                }
            } else {
                updateStars(-1);
                showFeedback("Tente novamente!", false);
                speak("Essa nÃ£o Ã© a letra correta");
            }
        }
    }

    /* 5) SOMBRAS */
    function initShadowGame() {
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Toque em um emoji e depois em sua sombra:</h2>";
        const allShadowEmojis = Object.values(emojiDatabase).flat().map(o => o.emoji);
        let uniqueEmojis = Array.from(new Set(allShadowEmojis));
        let chosenEmojis = shuffle(uniqueEmojis).slice(0, 4);
        if(JSON.stringify(chosenEmojis)===JSON.stringify(lastShadowSet)){
            chosenEmojis = shuffle(uniqueEmojis).slice(0,4);
        }
        lastShadowSet = chosenEmojis;
        content.innerHTML += `
      <div class="shadow-container-wrapper">
        <div class="shadow-column" id="shadow-slots">
          ${chosenEmojis.map(e=>`
            <div class="shadow-slot" data-expected="${e}"
                 onclick="selectShadowSlot(this,'${e}')">
              ${e}
            </div>
          `).join("")}
        </div>
        <div class="shadow-column" id="shadow-items">
          ${shuffle(chosenEmojis).map(e=>`
            <div class="shadow-item"
                 onclick="selectShadowItem(this,'${e}')">
              ${e}
            </div>
          `).join("")}
        </div>
      </div>
    `;
        window.shadowGameState = {
            correctMatches:0,
            totalItems: chosenEmojis.length,
            selectedEmoji: null,
            selectedElement: null
        };
        speak("Toque em um emoji e depois na sua sombra correspondente");
    }
    function selectShadowItem(el, emoji) {
        if(locked) return;
        if(window.shadowGameState.selectedElement){
            window.shadowGameState.selectedElement.style.opacity = "1";
        }
        window.shadowGameState.selectedEmoji = emoji;
        window.shadowGameState.selectedElement = el;
        el.style.opacity = "0.5";
    }
    function selectShadowSlot(slotEl, expectedEmoji) {
        if(locked) return;
        const selected = window.shadowGameState.selectedEmoji;
        const selectedEl = window.shadowGameState.selectedElement;
        if(!selected) return;
        if(selected === expectedEmoji){
            slotEl.classList.add("shadow-match");
            slotEl.classList.remove("shadow-slot");
            window.shadowGameState.correctMatches++;
            if(selectedEl) selectedEl.style.display = "none";
            showFeedback("Correto!", true);
            if(window.shadowGameState.correctMatches === window.shadowGameState.totalItems){
                locked = true;
                updateStars(1);
                scheduleReplayGame("shadows");
            }
        } else {
            slotEl.classList.add("shadow-mismatch");
            setTimeout(()=> slotEl.classList.remove("shadow-mismatch"),1000);
            speak("Ops! NÃ£o Ã© a sombra certa");
            updateStars(-1);
            showFeedback("Sombra incorreta!", false);
        }
        if(selectedEl) selectedEl.style.opacity = "1";
        window.shadowGameState.selectedEmoji=null;
        window.shadowGameState.selectedElement=null;
    }

    /* 6) QUEBRA CABEÃ‡A */
    function initPuzzleGame() {
        window.puzzleGameState = {
            selectedNumber:null,
            correctMatches:0,
            totalPairs:5
        };
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Combine os nÃºmeros com a quantidade:</h2>";
        let randomNums = shuffle([...Array(9)].map((_,i)=> i+1)).slice(0,5);
        while(JSON.stringify(randomNums)===JSON.stringify(lastPuzzleSet)){
            randomNums = shuffle([...Array(9)].map((_,i)=> i+1)).slice(0,5);
        }
        lastPuzzleSet = randomNums;
        const emojis = ["ğŸ","â­","ğŸˆ","ğŸ±","ğŸš—","ğŸ®","ğŸ•","ğŸ¶","ğŸŒº"];
        content.innerHTML += `
      <div class="numbers-container">
        ${randomNums.map(num=>`
          <div class="puzzle-piece number-piece"
               data-number="${num}"
               onclick="selectNumber(this,${num})">
            ${num}
          </div>
        `).join("")}
      </div>
      <div class="quantities-container">
        ${shuffle(randomNums).map(num=>`
          <div class="puzzle-piece emoji-piece"
               data-number="${num}"
               onclick="matchQuantity(this,${num})">
            <div class="puzzle-emoji-grid">
              ${Array(num).fill(emojis[num-1]).map(e=>`<div class="emoji-cell">${e}</div>`).join("")}
            </div>
          </div>
        `).join("")}
      </div>
    `;
        speak("Conte o nÃºmero de figuras e combine com o nÃºmero correto");
    }
    function selectNumber(el, number){
        if(locked) return;
        document.querySelectorAll(".number-piece").forEach(p=> p.classList.remove("selected"));
        el.classList.add("selected");
        window.puzzleGameState.selectedNumber = number;
    }
    function matchQuantity(el, quantity){
        if(locked) return;
        if(window.puzzleGameState.selectedNumber===null){
            showFeedback("Selecione um nÃºmero primeiro!", false);
            return;
        }
        if(quantity === window.puzzleGameState.selectedNumber){
            el.classList.add("matched");
            document.querySelector(`.number-piece[data-number="${quantity}"]`).classList.add("matched");
            window.puzzleGameState.correctMatches++;
            showFeedback("CombinaÃ§Ã£o correta!", true);
            if(window.puzzleGameState.correctMatches===window.puzzleGameState.totalPairs){
                locked = true;
                updateStars(1);
                showFeedback("VocÃª completou o quebra-cabeÃ§a!", true);
                scheduleReplayGame("puzzle");
            }
        } else {
            showFeedback("Tente novamente!", false);
            el.classList.add("wrong");
            setTimeout(()=> el.classList.remove("wrong"),500);
            updateStars(-1);
        }
        window.puzzleGameState.selectedNumber = null;
        document.querySelectorAll(".number-piece").forEach(p=>{
            if(!p.classList.contains("matched")){
                p.classList.remove("selected");
            }
        });
    }

    /* 7) CORES */
    function initColorGame() {
        const allColors = [
            { name: "Vermelho", hex:"#FF0000" },
            { name: "Azul",     hex:"#0000FF" },
            { name: "Verde",    hex:"#00FF00" },
            { name: "Amarelo",  hex:"#FFD700" },
            { name: "Roxo",     hex:"#800080" },
            { name: "Laranja",  hex:"#FFA500" },
            { name: "Rosa",     hex:"#FF69B4" },
            { name: "Marrom",   hex:"#8B4513" },
        ];
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Toque em uma cor e depois na caixa correta:</h2>";
        let roundColors = shuffle(allColors).slice(0,3);
        while(JSON.stringify(roundColors)===JSON.stringify(lastColorsSet)){
            roundColors = shuffle(allColors).slice(0,3);
        }
        lastColorsSet = roundColors;
        content.innerHTML += `
      <div style="display:flex; justify-content:center; flex-wrap:wrap; gap:5px; margin-bottom:5px;" id="color-items">
        ${roundColors.map(c=>`
          <div class="color-item"
               style="background:${c.hex}"
               data-colorname="${c.name}"
               onclick="selectColorItem(this,'${c.hex}')"></div>
        `).join("")}
      </div>
      <div style="display:flex; justify-content:center; flex-wrap:wrap; gap:5px;" id="color-bins">
        ${roundColors.map(c=>`
          <div class="color-bin"
               style="border-color:${c.hex}"
               data-targetcolor="${c.hex}"
               data-filled="false"
               onclick="placeColor(this,'${c.hex}')">
            <span style="color:${c.hex}">${c.name}</span>
          </div>
        `).join("")}
      </div>
    `;
        window.colorGameState = {
            totalColors: roundColors.length,
            correctMatches:0,
            selectedColor:null,
            selectedElement:null
        };
        speak("Combine as cores nas caixas correspondentes");
    }
    function selectColorItem(el, color){
        if(locked) return;
        if(window.colorGameState.selectedElement){
            window.colorGameState.selectedElement.style.opacity="1";
        }
        window.colorGameState.selectedColor = color;
        window.colorGameState.selectedElement = el;
        el.style.opacity="0.5";
    }
    function placeColor(binEl, targetColor){
        if(locked) return;
        const selected = window.colorGameState.selectedColor;
        const selectedEl = window.colorGameState.selectedElement;
        if(!selected) return;
        if(binEl.getAttribute("data-filled")==="true"){
            showFeedback("Esta caixa jÃ¡ estÃ¡ preenchida!", false);
            if(selectedEl) selectedEl.style.opacity="1";
            window.colorGameState.selectedColor=null;
            window.colorGameState.selectedElement=null;
            return;
        }
        if(selected===targetColor){
            binEl.style.backgroundColor = selected;
            binEl.setAttribute("data-filled","true");
            window.colorGameState.correctMatches++;
            showFeedback("Cor correta!", true);
            if(selectedEl) selectedEl.style.display="none";
            if(window.colorGameState.correctMatches===window.colorGameState.totalColors){
                locked=true;
                updateStars(1);
                showFeedback("Cores completas!", true);
                scheduleReplayGame("colors");
            }
        } else {
            showFeedback("Tente outra cor", false);
            binEl.style.animation="shake 0.5s";
            setTimeout(()=> binEl.style.animation="",500);
            updateStars(-1);
            speak("Cor incorreta, tente novamente");
        }
        if(selectedEl) selectedEl.style.opacity="1";
        window.colorGameState.selectedColor=null;
        window.colorGameState.selectedElement=null;
    }

    /* 8) CLIMA */
    function initWeatherGame(){
        const weatherData = [
            { icon:"â˜€ï¸", correctItems:["ğŸ•¶ï¸","ğŸ©","ğŸ§´"], title:"Ensolarado" },
            { icon:"ğŸŒ§ï¸", correctItems:["â˜‚ï¸","ğŸ§¥","ğŸ¥¾"], title:"Chuvoso" },
            { icon:"â„ï¸", correctItems:["ğŸ§¤","ğŸ§£","ğŸ¿"], title:"Frio" }
        ];
        const content = document.getElementById("content");
        let currentWeather = weatherData[Math.floor(Math.random()*weatherData.length)];
        while(currentWeather===lastWeather){
            currentWeather = weatherData[Math.floor(Math.random()*weatherData.length)];
        }
        lastWeather = currentWeather;
        const incorrectItems = ["ğŸ¸","ğŸ“˜","ğŸˆ","ğŸª","ğŸ­","ğŸ¨"];
        const allItems = shuffle([...currentWeather.correctItems, ...shuffle(incorrectItems).slice(0,3)]);
        content.innerHTML=`
      <h2>Escolha os itens para o clima:</h2>
      <div class="weather-card">
        <div style="font-size:40px">${currentWeather.icon}</div>
        <h3 style="font-size:1rem; margin-top:5px;">${currentWeather.title}</h3>
        <div class="weather-items" id="weather-items">
          ${allItems.map(item=>`
            <div class="weather-item"
                 onclick="handleWeatherItem(this,'${item}','${currentWeather.icon}')">
              ${item}
            </div>
          `).join("")}
        </div>
      </div>
    `;
        window.weatherGameState={
            correctCount:0,
            totalCorrect:currentWeather.correctItems.length,
            currentIcon: currentWeather.icon
        };
        speak(`Selecione as figuras para o clima ${currentWeather.title}`);
    }
    function handleWeatherItem(el, item, correctIcon){
        if(locked) return;
        const correctItems = {
            "â˜€ï¸":["ğŸ•¶ï¸","ğŸ©","ğŸ§´"],
            "ğŸŒ§ï¸":["â˜‚ï¸","ğŸ§¥","ğŸ¥¾"],
            "â„ï¸":["ğŸ§¤","ğŸ§£","ğŸ¿"]
        }[correctIcon];
        if(el.classList.contains("selected")) return;
        if(correctItems.includes(item)){
            el.classList.add("selected");
            showFeedback("Item correto!", true);
            window.weatherGameState.correctCount++;
            if(window.weatherGameState.correctCount===window.weatherGameState.totalCorrect){
                locked=true;
                updateStars(1);
                showFeedback("Desafio completo!", true);
                scheduleReplayGame("weather");
            }
        } else {
            el.style.background="#FFCDD2";
            el.style.animation="shake 0.5s";
            showFeedback("NÃ£o Ã© para este clima!", false);
            speak("NÃ£o Ã© para este clima");
            setTimeout(()=>{
                el.style.background="";
                el.style.animation="";
            },1000);
            updateStars(-1);
        }
    }

    /* 9) CATEGORIAS */
    function initCategoryGame(){
        const content = document.getElementById("content");
        content.innerHTML="<h2>Classifique os itens em suas categorias:</h2>";
        const categories = [
            {
                name:"Animais", icon:"ğŸ¶",
                items:["ğŸ±","ğŸ™","ğŸ¶","ğŸ·","ğŸ¦Š","ğŸ¦","ğŸ¯","ğŸº","ğŸ¸","ğŸ¦“","ğŸ¦’","ğŸµ","ğŸ¼","ğŸ¹","ğŸ°",
                    "ğŸ»","ğŸ¨","ğŸ”","ğŸ¦†","ğŸ¦…","ğŸ¦‰","ğŸ¢","ğŸ","ğŸ¦‹","ğŸ¦‡","ğŸ¦”","ğŸ¦£","ğŸŠ","ğŸ›","ğŸ¦•","ğŸ¦–"]
            },
            {
                name:"Frutas", icon:"ğŸ",
                items:["ğŸ","ğŸŒ","ğŸ‡","ğŸŠ","ğŸ¥","ğŸ","ğŸ","ğŸ‘","ğŸ’","ğŸ‰","ğŸ“","ğŸ¥­","ğŸ…","ğŸ","ğŸ‹","ğŸ¥¥","ğŸ«"]
            },
            {
                name:"VeÃ­culos", icon:"ğŸš—",
                items:["ğŸš—","âœˆï¸","ğŸš²","ğŸšŒ","â›µ","ğŸš•","ğŸš™","ğŸš","ğŸï¸","ğŸš“","ğŸš‘","ğŸš’","ğŸš","ğŸ›µ","ğŸï¸","ğŸš‚","ğŸš†","ğŸš‡",
                    "ğŸš","ğŸš","ğŸšŠ","ğŸ›©ï¸","ğŸš¤","â›´ï¸","ğŸš¢","ğŸ›¥ï¸","ğŸ›³ï¸","ğŸš€","ğŸš","ğŸš¡","ğŸš ","ğŸšŸ","ğŸ¦¼"]
            }
        ];
        const allCategoryItems = [];
        categories.forEach(cat=>{
            const shuffledItems = shuffle([...cat.items]);
            const selectedItems = shuffledItems.slice(0,5);
            selectedItems.forEach(i=> allCategoryItems.push({ emoji:i, category: cat.name }));
        });
        const currentSet=JSON.stringify(allCategoryItems);
        if(currentSet===JSON.stringify(lastCategoriesSet)){
            allCategoryItems.length=0;
            categories.forEach(cat=>{
                const shuffled=shuffle([...cat.items]);
                const fiveItems=shuffled.slice(0,5);
                fiveItems.forEach(i=> allCategoryItems.push({emoji:i, category:cat.name}));
            });
        }
        lastCategoriesSet = allCategoryItems;
        let html = `<div class="category-game-container" style="justify-content:center; margin-bottom:5px;">`;
        categories.forEach(cat=>{
            html += `
        <div class="category-bin"
             data-category="${cat.name}"
             data-filled="0"
             onclick="placeInCategory(this,'${cat.name}')">
          <div class="category-label">${cat.icon} ${cat.name}</div>
          <div class="bin-items-container" id="bin-${cat.name}"></div>
        </div>
      `;
        });
        html += `</div>`;
        html += `<div class="category-game-container" style="flex-wrap:wrap;" id="cat-items-container">`;
        shuffle(allCategoryItems).forEach(obj=>{
            html += `
        <div class="category-item"
             data-emoji="${obj.emoji}"
             data-cat="${obj.category}"
             onclick="selectCategoryItem(this)">
          ${obj.emoji}
        </div>
      `;
        });
        html += `</div>`;
        content.innerHTML += html;
        window.categoryGameState = {
            totalItems: allCategoryItems.length,
            correct:0,
            selectedItem:null,
            selectedElement:null
        };
        speak("Toque em um item e depois na categoria correta");
    }
    function selectCategoryItem(el){
        if(locked) return;
        if(window.categoryGameState.selectedElement){
            window.categoryGameState.selectedElement.style.opacity="1";
        }
        window.categoryGameState.selectedItem={
            emoji: el.getAttribute("data-emoji"),
            category: el.getAttribute("data-cat")
        };
        window.categoryGameState.selectedElement=el;
        el.style.opacity="0.5";
    }
    function placeInCategory(binEl, targetCategory){
        if(locked) return;
        const selItem = window.categoryGameState.selectedItem;
        const selEl   = window.categoryGameState.selectedElement;
        if(!selItem) return;
        if(selItem.category===targetCategory){
            binEl.classList.add("category-matched");
            const filledCount = parseInt(binEl.getAttribute("data-filled"))+1;
            binEl.setAttribute("data-filled",filledCount);
            const binContainer = binEl.querySelector(".bin-items-container");
            const newEmojiDiv = document.createElement("div");
            newEmojiDiv.style.fontSize="1.2rem";
            newEmojiDiv.textContent=selItem.emoji;
            binContainer.appendChild(newEmojiDiv);
            selEl.classList.add("hidden-item");
            window.categoryGameState.correct++;
            showFeedback("Correto!", true);
            speak(`Muito bem! ${selItem.emoji} Ã© da categoria ${targetCategory}`);
            if(window.categoryGameState.correct===window.categoryGameState.totalItems){
                locked=true;
                updateStars(1);
                showFeedback("Categorias completadas!", true);
                scheduleReplayGame("categories");
            }
        } else {
            binEl.classList.add("category-wrong");
            setTimeout(()=> binEl.classList.remove("category-wrong"),800);
            showFeedback("Categoria incorreta!", false);
            updateStars(-1);
            speak("Essa nÃ£o Ã© a categoria certa");
        }
        if(selEl) selEl.style.opacity="1";
        window.categoryGameState.selectedItem=null;
        window.categoryGameState.selectedElement=null;
    }

    /* 10) LEITURA */
    const readingWords = [
        { word:"barata",   syllables:["ba","ra","ta"] },
        { word:"banana",   syllables:["ba","na","na"] },
        { word:"pipoca",   syllables:["pi","po","ca"] },
        { word:"macaco",   syllables:["ma","ca","co"] },
        { word:"cavalo",   syllables:["ca","va","lo"] },
        { word:"tartaruga",syllables:["tar","ta","ru","ga"] },
        { word:"amigo",    syllables:["a","mi","go"] },
        { word:"arara",    syllables:["a","ra","ra"] },
        { word:"batata",   syllables:["ba","ta","ta"] },
        { word:"girafa",   syllables:["gi","ra","fa"] },
        { word:"cachorro", syllables:["ca","cho","rro"] }
    ];
    function initReadingGame(){
        const content = document.getElementById("content");
        content.innerHTML=`
      <h2 class="reading-title">Toque para formar a palavra!</h2>
      <div id="reading-result" class="reading-result"></div>
      <div id="reading-syllables" class="reading-word-box"></div>
    `;
        let randomWord = shuffle(readingWords)[0];
        while(randomWord.word===lastReadingWord?.word){
            randomWord = shuffle(readingWords)[0];
        }
        lastReadingWord = randomWord;
        const originalSyllables = [...randomWord.syllables];
        const scrambled = shuffle([...randomWord.syllables]);
        window.readingGameState={
            originalWord: randomWord.word,
            syllables: originalSyllables,
            userIndex:0
        };
        const resultContainer = document.getElementById("reading-result");
        originalSyllables.forEach((_,idx)=>{
            const span = document.createElement("div");
            span.className="reading-result-syllable";
            span.id=`result-syllable-${idx}`;
            resultContainer.appendChild(span);
        });
        const syllablesContainer = document.getElementById("reading-syllables");
        scrambled.forEach(syl=>{
            const div = document.createElement("div");
            div.className="reading-syllable";
            div.textContent=syl;
            div.onclick=()=>{
                if(locked) return;
                handleReadingTap(div);
            };
            syllablesContainer.appendChild(div);
        });
        speak(`Forme a palavra ${randomWord.word.toUpperCase()}. Toque nas sÃ­labas na ordem correta.`);
    }
    function handleReadingTap(el){
        const state = window.readingGameState;
        const nextNeeded = state.syllables[state.userIndex];
        const tapped = el.textContent;
        if(tapped===nextNeeded){
            const slot = document.getElementById(`result-syllable-${state.userIndex}`);
            slot.textContent = tapped;
            slot.style.backgroundColor="#c8e6c9";
            slot.style.borderColor="#4caf50";
            el.style.visibility="hidden";
            speak(tapped);
            state.userIndex++;
            if(state.userIndex===state.syllables.length){
                locked=true;
                showFeedback(`VocÃª formou "${state.originalWord.toUpperCase()}"!`, true);
                updateStars(1);
                scheduleReplayGame("reading");
            }
        } else {
            showFeedback("SÃ­laba errada, tente novamente!", false);
            speak("NÃ£o Ã© essa sÃ­laba");
            updateStars(-1);
        }
    }

    /* Palworld */
    function initPalworldGame(){
        const content = document.getElementById("content");
        content.innerHTML="<h2>Encontre a primeira letra do Pal:</h2>";
        const randomPal = shuffle(palworldData)[0];
        content.innerHTML+=`
      <div class="pal-list">
        <div class="pal-item">
          <img src="${randomPal.img}" alt="${randomPal.name}" />
          <div class="pal-name">${randomPal.name}</div>
        </div>
      </div>
      <div class="letters-options" id="letters-options"></div>
    `;
        const correctLetter = randomPal.name[0].toUpperCase();
        const allLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
        const options = shuffle([
            correctLetter,
            ...shuffle(allLetters.filter(l=>l!==correctLetter)).slice(0,5)
        ]);
        const lettersBox = document.getElementById("letters-options");
        options.forEach(letter=>{
            const div = document.createElement("div");
            div.className="letter-choice";
            div.textContent=letter;
            div.onclick=()=>{
                if(locked) return;
                checkPalworldLetter(letter,correctLetter);
            };
            lettersBox.appendChild(div);
        });
        speak(`Qual a primeira letra de ${randomPal.name}?`);
    }
    function checkPalworldLetter(letter, correct){
        locked=true;
        if(letter===correct){
            updateStars(1);
            showFeedback("Certo!", true);
            scheduleReplayGame("palworld");
        } else {
            updateStars(-1);
            showFeedback("Letra errada!", false);
            speak(`A primeira letra Ã© ${correct}`);
            locked=false;
        }
    }

    /* Pokemon */
    function initPokemonGame(){
        const content = document.getElementById("content");
        content.innerHTML="<h2>Encontre a primeira letra do Pokemon:</h2>";
        const randomPoke = shuffle(pokemonData)[0];
        content.innerHTML+=`
      <div class="pokemon-list">
        <div class="pokemon-item">
          <img src="${randomPoke.img}" alt="${randomPoke.name}" />
          <div class="pokemon-name">${randomPoke.name}</div>
        </div>
      </div>
      <div class="letters-options" id="pokemon-letters-options"></div>
    `;
        const correctLetter = randomPoke.name[0].toUpperCase();
        const allLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
        const options = shuffle([
            correctLetter,
            ...shuffle(allLetters.filter(l=>l!==correctLetter)).slice(0,5)
        ]);
        const lettersBox = document.getElementById("pokemon-letters-options");
        options.forEach(letter=>{
            const div = document.createElement("div");
            div.className="letter-choice";
            div.textContent=letter;
            div.onclick=()=>{
                if(locked) return;
                checkPokemonLetter(letter,correctLetter);
            };
            lettersBox.appendChild(div);
        });
        speak(`Qual a primeira letra de ${randomPoke.name}?`);
    }
    function checkPokemonLetter(letter, correct){
        locked=true;
        if(letter===correct){
            updateStars(1);
            showFeedback("Certo!", true);
            scheduleReplayGame("pokemon");
        } else {
            updateStars(-1);
            showFeedback("Letra errada!", false);
            speak(`A primeira letra Ã© ${correct}`);
            locked=false;
        }
    }

    /* FunÃ§Ãµes auxiliares */
    function speak(text){
        if(speechSynth.speaking) speechSynth.cancel();
        const utt = new SpeechSynthesisUtterance(text);
        utt.lang="pt-BR";
        utt.rate=0.9;
        speechSynth.speak(utt);
    }
    function shuffle(arr){
        return arr.sort(()=>Math.random()-0.5);
    }
    function showFeedback(msg, isCorrect){
        const fdb = document.getElementById("feedback");
        fdb.textContent=msg;
        fdb.style.color= isCorrect ? "#2E7D32" : "#C62828";
    }
    function updateStars(change) {
        const newStars = Math.max(0, stars + change);
        if (newStars !== stars) {
            stars = newStars;
            localStorage.setItem("stars", String(stars));
            starsCountEl.textContent = stars;
            if(!gameStars[currentGame]) {
                gameStars[currentGame] = 0;
            }
            gameStars[currentGame] = Math.max(0, gameStars[currentGame] + change);
            localStorage.setItem("gameStars", JSON.stringify(gameStars));
            if (change > 0) {
                speak("Muito bem!");
                maybeGiveSticker();
            } else if (change < 0 && stars > 0) {
                speak("NÃ£o desista! Continue tentando!");
            }
            checkGoal();
            buildMainMenu(false);
        }
    }
    function maybeGiveSticker(){
        if(Math.floor(Math.random()*5)===0){
            const st = possibleStickers[Math.floor(Math.random()* possibleStickers.length)];
            stickerList.push(st);
            localStorage.setItem("myStickers", JSON.stringify(stickerList));
            updateStickerCount();
            createStickerFly(st.img);
        }
    }
    function createStickerFly(imgUrl){
        const stickerFlyEl = document.createElement("div");
        stickerFlyEl.className = "sticker-fly";
        const startX = window.innerWidth / 2 - 40;
        const startY = window.innerHeight / 2 - 40;
        stickerFlyEl.style.left = `${startX}px`;
        stickerFlyEl.style.top  = `${startY}px`;
        const img = document.createElement("img");
        img.src = imgUrl;
        stickerFlyEl.appendChild(img);
        document.body.appendChild(stickerFlyEl);
        stickerFlyEl.getBoundingClientRect();
        const btnRect = document.getElementById("stickers-btn").getBoundingClientRect();
        const destX = btnRect.left + (btnRect.width/2) - 40;
        const destY = btnRect.top  - 40;
        stickerFlyEl.style.transform = `translate(${destX - startX}px, ${destY - startY}px) scale(0.3)`;
        stickerFlyEl.style.opacity = "0";
        stickerFlyEl.addEventListener("transitionend", ()=>{
            if(stickerFlyEl.parentNode) {
                stickerFlyEl.parentNode.removeChild(stickerFlyEl);
            }
        });
    }
    function checkGoal(){
        if(!hasReachedGoal && savedGoal>0 && stars>=savedGoal){
            hasReachedGoal=true;
            localStorage.setItem("hasReachedGoal","true");
            trophyInfoEl.style.display="inline-block";
            showCongratsModal();
            startConfetti();
        }
    }

    /* Modal ParabÃ©ns */
    function showCongratsModal(){
        const backdrop = document.getElementById("modal-backdrop");
        const modal = document.getElementById("congratsModal");
        backdrop.style.display="block";
        modal.style.display="block";
        speak("ParabÃ©ns! VocÃª atingiu sua meta de estrelas!");
    }
    function continueAfterGoal(){
        stopConfetti();
        document.getElementById("modal-backdrop").style.display="none";
        document.getElementById("congratsModal").style.display="none";
    }
    function restartGame(){
        stopConfetti();
        localStorage.removeItem("playerName");
        localStorage.removeItem("stars");
        localStorage.removeItem("playerGoal");
        localStorage.removeItem("hasReachedGoal");
        localStorage.removeItem("gameStars");
        localStorage.removeItem("myStickers");
        location.reload();
    }

    /* Confetes */
    function startConfetti(){
        confettiCanvas.width=window.innerWidth;
        confettiCanvas.height=window.innerHeight;
        confettiCanvas.style.display="block";
        confettiActive=true;
        const confettiPieces=[];
        for(let i=0;i<150;i++){
            confettiPieces.push({
                x: Math.random()* confettiCanvas.width,
                y: Math.random()* confettiCanvas.height,
                r: Math.random()*6+2,
                d: Math.random()+1,
                color:`hsl(${Math.floor(Math.random()*360)},100%,50%)`
            });
        }
        function drawConfetti(){
            confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
            confettiPieces.forEach(cf=>{
                confettiCtx.beginPath();
                confettiCtx.fillStyle=cf.color;
                confettiCtx.arc(cf.x, cf.y, cf.r, 0, 2*Math.PI);
                confettiCtx.fill();
            });
            updateConfetti();
            if(confettiActive) requestAnimationFrame(drawConfetti);
        }
        function updateConfetti(){
            confettiPieces.forEach(cf=>{
                cf.y += Math.cos(cf.d)+1+cf.r/2;
                cf.x += Math.sin(cf.d);
                if(cf.y>confettiCanvas.height){
                    cf.x=Math.random()* confettiCanvas.width;
                    cf.y=-10;
                }
            });
        }
        drawConfetti();
    }
    function stopConfetti(){
        confettiActive=false;
        confettiCanvas.style.display="none";
    }

    /* Modal Figurinhas */
    function openStickersModal(){
        const modal = document.getElementById("stickers-modal");
        const backdrop = document.getElementById("modal-backdrop");
        const container = document.getElementById("stickers-container");
        container.innerHTML="";
        stickerList.forEach(st=>{
            const div = document.createElement("div");
            div.className="sticker-item";
            const img = document.createElement("img");
            img.src=st.img;
            img.alt=st.name;
            div.appendChild(img);
            container.appendChild(div);
        });
        backdrop.style.display="block";
        modal.style.display="block";
    }
    function closeStickersModal(){
        const modal = document.getElementById("stickers-modal");
        const backdrop = document.getElementById("modal-backdrop");
        modal.style.display="none";
        backdrop.style.display="none";
    }
</script>
</body>
</html>
