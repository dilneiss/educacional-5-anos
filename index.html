<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0"
    />
    <title>Jogo Educativo Infantil</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <style>
        html, body {
            margin: 0;
            padding: 0;
            background-color: #fffbf5;
            font-family: "Arial", sans-serif;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            height: 100%;
            width: 100%;
        }
        body::-webkit-scrollbar {
            width: 8px;
        }
        body::-webkit-scrollbar-thumb {
            background: #888;
        }
        body::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow: hidden;
            /* para n√£o ficar oculto atr√°s do menu fixo */
            padding-top: 60px;
        }

        /* MENU TOPO FIXO */
        .top-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.95);
            padding: 6px 15px;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.2);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 10;
        }
        #backToMenuBtn {
            font-size: 20px;
            background: transparent;
            border: none;
            color: #888;
            cursor: pointer;
            padding: 4px;
            transition: 0.3s;
        }
        #backToMenuBtn:hover {
            color: #ff5722;
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .player-name {
            font-size: 18px;
            color: #2e7d32;
            font-weight: bold;
            margin: 0;
            white-space: nowrap;
        }
        .stars-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 16px;
            line-height: 1.1;
        }
        .stars-info span:first-child {
            font-size: 20px;
            margin-bottom: 3px;
        }
        .trophy-info {
            font-size: 20px;
            color: #ffbf00;
            display: none;
            margin-left: 8px;
        }

        #stickers-btn {
            position: relative;
            font-size: 14px;
            padding: 6px 12px;
            background: #ff9800;
            border-radius: 6px;
            border: none;
            color: #fff;
            cursor: pointer;
            white-space: nowrap;
            transition: 0.3s;
        }
        #stickers-btn:hover {
            background: #fa8500;
        }
        #stickers-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: red;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            color: white;
            font-weight: bold;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #mainContent {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .container {
            text-align: center;
            padding: 10px;
        }
        .main-title {
            font-size: 2.3rem;
            font-weight: bold;
            color: #ff5722;
            margin: 20px 0 10px;
        }
        #start-menu {
            margin-top: 15px;
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to   { opacity: 1; transform: translateY(0);   }
        }
        .start-menu-btn {
            width: 220px;
            font-size: 18px;
            margin: 10px auto;
            padding: 10px 0;
            display: block;
            border-radius: 10px;
            transition: 0.3s;
        }
        .start-menu-btn:hover {
            transform: scale(1.03);
        }
        .start-menu-input {
            font-size: 18px;
            border-radius: 8px;
            border: 2px solid #ccc;
            padding: 6px 8px;
            width: 250px;
            max-width: 80%;
            text-align: center;
            margin-bottom: 15px;
        }

        .feedback {
            font-size: 1rem;
            margin: 0.5rem 0;
            min-height: 30px;
            text-align: center;
            transition: 0.3s;
        }
        button {
            cursor: pointer;
            border: none;
            border-radius: 10px;
        }
        .btn-primary { background-color: #2196f3; color: #fff; }
        .btn-warning { background-color: #ffc107; color: #000; }
        .btn-danger  { background-color: #f44336; color: #fff; }
        .btn-info    { background-color: #00bcd4; color: #fff; }
        .btn-success { background-color: #4caf50; color: #fff; }

        .d-none { display: none !important; }

        #main-menu {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            overflow-y: auto;
            max-height: calc(100vh - 160px);
            padding: 10px;
            animation: fadeIn 0.5s ease-in-out;
        }
        .game-mode {
            background: #ffeed0;
            border-radius: 10px;
            padding: 8px;
            cursor: pointer;
            border: 2px solid #ccc;
            width: 130px;
            height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .game-mode:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }
        .game-mode div {
            display: block;
            text-align: center;
            width: 100%;
            font-weight: bold;
        }
        .game-mode div:nth-child(2) {
            font-weight: normal;
            font-size: 14px;
            margin-top: 5px;
        }

        #game-area {
            flex: 1;
            overflow: hidden;
            display: none;
            padding: 5px;
        }
        #content {
            font-size: 1rem;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            animation: fadeIn 0.4s ease-in-out;
            width: 100%;
        }
        #content h2 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            text-align: center;
            color: #444;
        }

        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-gap: 5px;
            max-width: 95%;
            margin-bottom: 5px;
        }
        .number-option {
            background-color: #c8e6c9;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            border-radius: 8px;
            border: 2px solid #000;
            cursor: pointer;
            transition: 0.2s;
        }
        .number-option:hover {
            transform: scale(1.05);
        }
        .target-number {
            background-color: #ffd700;
            width: 60px;
            height: 60px;
            border-radius: 8px;
            font-size: 1.2rem;
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }

        .emoji-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-gap: 10px;
            max-width: 95%;
            margin-bottom: 5px;
        }
        .emoji-option {
            background-color: #c8e6c9;
            width: 65px;
            height: 65px;
            border-radius: 8px;
            border: 2px solid #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            cursor: pointer;
            text-align: center;
            overflow: hidden;
            transition: 0.2s;
        }
        .emoji-option:hover {
            transform: scale(1.05);
        }
        .emoji-name {
            font-size: 0.7rem;
            margin-top: 1px;
        }

        .counting-target {
            display: flex;
            gap: 5px;
            justify-content: center;
            align-items: center;
            margin-bottom: 8px;
        }
        .count-box {
            width: 50px;
            height: 50px;
            font-size: 1.2rem;
            background: #fff9c4;
            border: 2px solid #000;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #counter {
            font-size: 1.2rem;
            margin: 5px;
            font-weight: bold;
        }
        .counting-emoji-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-gap: 8px;
            max-width: 95%;
            margin-bottom: 5px;
        }
        .count-emoji-option {
            background-color: #c8e6c9;
            width: 65px;
            height: 65px;
            border-radius: 8px;
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            cursor: pointer;
            overflow: hidden;
            transition: 0.2s;
        }
        .count-emoji-option:hover {
            transform: scale(1.05);
        }

        .word-target {
            font-size: 1rem;
            margin: 5px;
            color: #555;
            text-align: center;
        }
        .target-emoji-big {
            font-size: 2.5rem;
            display: block;
            margin-bottom: 8px;
        }
        .letter-box {
            width: 30px;
            height: 30px;
            display: inline-block;
            margin: 2px;
            font-size: 1.2rem;
            color: #666;
            border-bottom: 2px solid #999;
            text-align: center;
        }
        .scrambled-letters {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            max-width: 95%;
            margin-bottom: 5px;
        }
        .word-letter {
            background-color: #ffd700;
            width: 45px;
            height: 45px;
            border-radius: 5px;
            font-size: 1.2rem;
            border: 2px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.2s;
        }
        .word-letter:hover {
            transform: scale(1.05);
        }
        .revealed {
            color: #2e7d32 !important;
            border-bottom: 2px solid #2e7d32;
        }

        .shadow-container-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            width: 100%;
            height: 65vh;
            overflow: hidden;
        }
        .shadow-column {
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            align-items: center;
            justify-content: flex-start;
            width: 48%;
            gap: 10px;
            max-height: 65vh;
        }
        .shadow-slot,
        .shadow-item {
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            border-radius: 8px;
            border: 2px solid #000;
            cursor: pointer;
            background: #fff9c4;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 5px;
            text-align: center;
            position: relative;
            transition: 0.2s;
        }
        .shadow-slot::before {
            content: attr(data-expected);
            position: absolute;
            font-size: 1.5rem;
            opacity: 0.3;
        }
        .shadow-match {
            background: #c8e6c9 !important;
            border-color: #4caf50 !important;
        }
        .shadow-mismatch {
            background: #ffcdd2 !important;
            border-color: #c62828 !important;
            animation: shake 0.5s;
        }

        .selected {
            outline: 3px dashed #76ff03;
            outline-offset: -3px;
        }

        .numbers-container {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 5px 0;
            flex-wrap: nowrap;
            overflow: hidden;
            max-width: 95%;
        }
        .quantities-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            max-width: 95%;
            margin-bottom: 5px;
            justify-items: center;
        }
        .puzzle-piece {
            width: 60px;
            height: 60px;
            font-size: 1rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid transparent;
            background: #ffb74d;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: 0.2s;
        }
        .puzzle-piece:hover {
            transform: scale(1.05);
        }
        .number-piece {
            background: #81d4fa;
            border-color: #000;
        }
        .emoji-piece {
            border-color: #000;
            background: #fff;
        }
        .puzzle-emoji-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 2px;
            justify-content: center;
            align-items: center;
            max-width: 60px;
            max-height: 60px;
            overflow: hidden;
        }
        .emoji-cell {
            font-size: 1rem;
            width: 15px;
            height: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .matched {
            background: #c8e6c9 !important;
            border-color: #4caf50 !important;
        }

        .color-area {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin-bottom: 10px;
            max-width: 95%;
        }
        .color-item {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid #fff;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: 0.2s;
        }
        .color-item:hover {
            transform: scale(1.05);
        }
        .color-bin {
            width: 70px;
            height: 70px;
            border: 2px dashed #000;
            border-radius: 8px;
            background-color: white;
            font-size: 0.8rem;
            padding: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.2s;
        }
        .color-bin:hover {
            transform: scale(1.05);
        }

        .weather-card {
            width: 90%;
            max-width: 400px;
            margin: 5px auto;
            padding: 10px;
            border-radius: 8px;
            background: #fff;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        .weather-icon {
            font-size: 3rem;
            margin-bottom: 5px;
        }
        .weather-title {
            font-size: 1.2rem;
            margin: 5px 0;
        }
        .weather-items {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-top: 5px;
        }
        .weather-item {
            font-size: 1.5rem;
            background: #f5f5f5;
            border-radius: 5px;
            padding: 5px;
            cursor: pointer;
            transition: 0.2s;
        }
        .weather-item:hover {
            background: #e0e0e0;
        }
        .weather-correct {
            background: #c8e6c9 !important;
            border: 2px solid #4caf50;
        }

        .category-game-container {
            display: flex;
            flex-wrap: nowrap;
            gap: 10px;
            justify-content: center;
            margin: 5px auto;
            width: 100%;
            overflow: hidden;
            max-width: 95%;
        }
        .category-bin {
            width: 90px;
            min-height: 60px;
            border: 2px dashed #000;
            border-radius: 8px;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2px;
            gap: 2px;
            font-size: 0.7rem;
            transition: 0.2s;
        }
        .category-bin:hover {
            transform: scale(1.05);
        }
        .bin-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 2px;
            justify-content: center;
            min-height: 30px;
        }
        .category-item {
            width: 50px;
            height: 50px;
            font-size: 1.4rem;
            border: 2px solid #000;
            border-radius: 6px;
            background-color: #c8e6c9;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin: 2px;
            transition: 0.2s;
        }
        .category-item:hover {
            transform: scale(1.05);
        }
        .category-wrong {
            background-color: #ffcdd2 !important;
            border-color: #c62828 !important;
            animation: shake 0.5s;
        }

        .reading-title {
            font-size: 1rem;
            margin-bottom: 5px;
        }
        .reading-word-box {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            margin-bottom: 5px;
            max-width: 95%;
        }
        .reading-syllable {
            background-color: #ffd54f;
            border: 2px solid #000;
            border-radius: 5px;
            font-size: 1rem;
            padding: 5px 10px;
            cursor: pointer;
            transition: 0.2s;
        }
        .reading-syllable:hover {
            transform: scale(1.05);
        }
        .reading-result {
            display: flex;
            gap: 5px;
            justify-content: center;
            margin-bottom: 5px;
            flex-wrap: wrap;
            max-width: 95%;
        }
        .reading-result-syllable {
            width: 35px;
            height: 35px;
            background-color: #fff9c4;
            border: 2px solid #000;
            border-radius: 5px;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pal-list,
        .pokemon-list {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 5px;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        .pal-item,
        .pokemon-item {
            width: 100%;
            background-color: #fff9c4;
            border: 2px solid #000;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            box-sizing: border-box;
            transition: 0.3s;
        }
        .pal-item:hover,
        .pokemon-item:hover {
            background: #fff2a8;
        }
        .pal-item img,
        .pokemon-item img {
            max-width: 100%;
            max-height: 100px;
            object-fit: contain;
        }
        .pal-name,
        .pokemon-name {
            font-size: 1rem;
            margin-top: 5px;
            font-weight: bold;
        }
        .letters-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            max-width: 95%;
            margin: 0 auto;
        }
        .letter-choice {
            background-color: #c8e6c9;
            width: 40px;
            height: 40px;
            border: 2px solid #000;
            border-radius: 5px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.2s;
        }
        .letter-choice:hover {
            transform: scale(1.05);
            background-color: #aed581;
        }

        @keyframes shake {
            0%   { transform: translateX(0); }
            25%  { transform: translateX(-5px); }
            50%  { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        .sticker-fly {
            position: fixed;
            width: 80px;
            height: 80px;
            pointer-events: none;
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff9c4;
            border: 2px solid #ff9800;
            border-radius: 10px;
            box-shadow: 0 0 5px rgba(0,0,0,.3);
            overflow: hidden;
            transition: transform 1.5s ease, opacity 1.5s ease;
        }
        .sticker-fly img {
            max-width: 70px;
            max-height: 70px;
        }

        .confetti-canvas {
            pointer-events: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            display: none;
        }
        .modal-backdrop {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 9998;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
        }
        .modal-base {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            z-index: 9999;
            width: 90%;
            max-width: 400px;
            display: none;
        }
        #stickers-modal h3 {
            margin-bottom: 10px;
        }
        .stickers-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            margin-bottom: 10px;
            max-height: 40vh;
            overflow-y: auto;
        }
        .sticker-item {
            width: 70px;
            height: 70px;
            background: #ffeb3b;
            padding: 2px;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .sticker-item img {
            max-width: 60px;
            max-height: 60px;
        }
        #congratsModal {
            text-align: center;
            background: linear-gradient(to bottom, #fff9c4, #fff176);
            animation: pop 0.5s ease-in-out;
        }
        #congratsModal h2 {
            font-size: 2rem;
            color: #d32f2f;
        }
        #congratsModal p#congratsText {
            font-size: 1.2rem;
            color: #333;
        }
        @keyframes pop {
            0%   { transform: scale(0.7) translate(-50%, -50%); }
            100% { transform: scale(1)   translate(-50%, -50%); }
        }
        #congratsModal .balloons img {
            width: 70px;
            margin: 0 5px;
            animation: float 2s ease-in-out infinite alternate;
        }
        @keyframes float {
            0%   { transform: translateY(0); }
            100% { transform: translateY(-15px); }
        }

        /* ADAPTADO PARA MOSTRAR OS POK√âMONS EM UMA LINHA S√ì NO CELULAR */
        .pokemon-battle-top {
            text-align: center;
            margin-bottom: 10px;
        }
        .pokemon-battle-top img {
            max-width: 150px;
        }
        .pokemon-battle-name {
            font-size: 0.8rem;
            font-weight: bold;
            margin: 5px 0;
        }
        .pokemon-battle-stats {
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        .pokemon-battle-list {
            display: flex;
            flex-wrap: nowrap; /* n√£o quebrar linha */
            overflow-x: auto;  /* rolagem horizontal */
            -webkit-overflow-scrolling: touch;
            gap: 10px;
            max-width: 100%;
        }
        .pokemon-battle-item {
            background: #fff9c4;
            border: 2px solid #000;
            border-radius: 8px;
            width: 18%;
            flex: 0 0 auto;
            text-align: center;
            padding: 5px;
            cursor: pointer;
            transition: 0.2s;
        }
        .pokemon-battle-item img {
            max-width: 80px;
        }
        .pokemon-battle-item:hover {
            background: #fff2a8;
        }
    </style>
</head>
<body oncontextmenu="return false;">
<canvas class="confetti-canvas" id="confettiCanvas"></canvas>

<div class="modal-backdrop" id="modal-backdrop"></div>

<div class="modal-base" id="stickers-modal">
    <h3>Minhas Figurinhas</h3>
    <div class="stickers-container" id="stickers-container"></div>
    <button class="btn btn-danger" onclick="closeStickersModal()">Fechar</button>
</div>

<div class="modal-base" id="congratsModal">
    <h2>Uau, Parab√©ns!</h2>
    <div class="balloons">
        <img src="img/balao.png" alt="Balloon">
        <img src="img/balao.png" alt="Balloon" style="animation-duration:2.2s;">
        <img src="img/balao.png" alt="Balloon" style="animation-duration:1.8s;">
    </div>
    <p id="congratsText">Voc√™ atingiu sua meta de estrelas!</p>
    <div style="margin-top: 20px;">
        <button class="btn btn-info" onclick="continueAfterGoal()">
            <i class="bi bi-play-fill"></i> Continuar Jogando
        </button>
        <button class="btn btn-outline-secondary" onclick="restartGame()">
            <i class="bi bi-arrow-repeat"></i> Recome√ßar
        </button>
    </div>
</div>

<div class="game-container">
    <div class="top-bar">
        <div class="player-info d-none" id="playerInfoContainer">
            <div class="player-name" id="player-name"></div>
            <div class="stars-info">
                <span>‚≠ê</span>
                <span id="stars-count">0</span>
            </div>
            <div class="trophy-info" id="trophyInfo">üèÜ</div>
            <button id="stickers-btn" onclick="openStickersModal()">Figurinhas
                <div id="stickers-count" style="display:none">0</div>
            </button>
        </div>
        <button id="backToMenuBtn" onclick="cancelNextGameAndMenu()" style="display:none;">‚Üê Menu</button>
    </div>

    <div id="mainContent">
        <div class="container" id="startScreen">
            <h1 class="main-title" id="mainTitle">Vamos Aprender!</h1>
            <div id="start-menu">
                <div id="continue-btn-container">
                    <button class="btn btn-primary start-menu-btn" id="continueGameBtn">Continuar Jogo</button>
                </div>
                <button class="btn btn-success start-menu-btn" id="newGameBtn">Novo Jogo</button>
                <div class="d-none" id="newGameForm">
                    <p>Digite seu nome para come√ßar:</p>
                    <input type="text" id="playerNameInput" class="start-menu-input" />
                    <p>Quantas estrelas quer ganhar?</p>
                    <input type="number" id="playerGoalInput" class="start-menu-input" style="width:120px;" min="1" max="9999" />
                    <br />
                    <button id="startNewGameBtn" class="btn btn-warning">Iniciar</button>
                </div>
            </div>
        </div>

        <div id="main-menu" class="d-none"></div>

        <div id="game-area" class="d-none">
            <div id="content"></div>
            <div id="feedback" class="feedback"></div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('selectstart', (e) => e.preventDefault());
    document.addEventListener('contextmenu', (e) => e.preventDefault());

    let savedName = localStorage.getItem("playerName") || "";
    let savedStars = parseInt(localStorage.getItem("stars") || "0", 10);
    let savedGoal = parseInt(localStorage.getItem("playerGoal") || "0", 10);
    let hasReachedGoal = (localStorage.getItem("hasReachedGoal") === "true");

    let playerName = savedName;
    let stars = savedStars;
    let previousStars = stars;
    let currentGame = null;
    let speechSynth = window.speechSynthesis;
    let nextGameTimeout = null;
    let locked = false;

    let lastNumber = null;
    let lastLetter = null;
    let lastCount = null;
    let lastWordEmoji = null;
    let lastShadowSet = null;
    let lastPuzzleSet = null;
    let lastColorsSet = null;
    let lastWeather = null;
    let lastCategoriesSet = null;
    let lastReadingWord = null;
    let lastPalworld = null;

    let gameStars = JSON.parse(localStorage.getItem("gameStars") || "{}");

    let stickerList = JSON.parse(localStorage.getItem("myStickers") || "[]");
    const stickerCountEl = document.getElementById("stickers-count");
    function updateStickerCount() {
        const count = stickerList.length;
        if(count > 0) {
            stickerCountEl.textContent = count;
            stickerCountEl.style.display = "flex";
        } else {
            stickerCountEl.style.display = "none";
        }
    }
    updateStickerCount();

    const possibleStickers = [
        { name: "Pikachu",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png" },
        { name: "Charmander", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png" },
        { name: "Bulbasaur",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png" },
        { name: "Squirtle",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png" },
        { name: "Stitch",     img: "https://cdn-icons-png.flaticon.com/512/6112/6112465.png" },
        { name: "Pal1",       img: "https://cdn-icons-png.flaticon.com/512/528/528099.png" },
        { name: "Pal2",       img: "https://cdn-icons-png.flaticon.com/512/528/528092.png" },
        { name: "Eevee",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/133.png" },
        { name: "Mew",        img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/151.png" }
    ];

    const palworldData = [
        { name:"Lamball",   img:"img/T_SheepBall_icon_normal.webp" },
        { name:"Cattiva",   img:"img/T_PinkCat_icon_normal.webp" },
        { name:"Chikipi",   img:"img/T_ChickenPal_icon_normal.webp" },
        { name:"Vixy",      img:"img/T_CuteFox_icon_normal.webp" },
        { name:"Cremis",    img:"img/T_WoolFox_icon_normal.webp" },
        { name:"Elizabee",  img:"img/T_QueenBee_icon_normal.webp" },
        { name:"Lunaris",   img:"img/T_Mutant_icon_normal.webp" },
        { name:"Tombat",    img:"img/T_CatBat_icon_normal.webp" },
        { name:"Katress",   img:"img/T_CatMage_icon_normal.webp" },
        { name:"Mammorest Cryst", img:"img/T_GrassMammoth_Ice_icon_normal.webp" },
        { name:"Mammorest", img:"img/T_GrassMammoth_icon_normal.webp" },
        { name:"Anubis",    img:"img/T_Anubis_icon_normal.webp" },
        { name:"Grizzbolt", img:"img/T_ElecPanda_icon_normal.webp" },
        { name:"Paladius",  img:"img/T_SaintCentaur_icon_normal.webp" },
        { name:"Frostallion",img:"img/T_IceHorse_icon_normal.webp" },
        { name:"Jetragon",  img:"img/T_JetDragon_icon_normal.webp" },
        { name:"Bellanoir", img:"img/T_NightLady_icon_normal.webp" },
    ];
    const pokemonData = [
        { name: "Bulbasaur",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png" },
        { name: "Ivysaur",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/2.png" },
        { name: "Venusaur",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/3.png" },
        { name: "Charmander", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png" },
        { name: "Charmeleon", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/5.png" },
        { name: "Charizard",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/6.png" },
        { name: "Squirtle",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png" },
        { name: "Wartortle",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/8.png" },
        { name: "Blastoise",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/9.png" },
        { name: "Caterpie",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/10.png" },
        { name: "Metapod",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/11.png" },
        { name: "Butterfree", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/12.png" },
        { name: "Weedle",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/13.png" },
        { name: "Kakuna",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/14.png" },
        { name: "Beedrill",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/15.png" },
        { name: "Pidgey",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/16.png" },
        { name: "Pidgeotto",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/17.png" },
        { name: "Pidgeot",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/18.png" },
        { name: "Rattata",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/19.png" },
        { name: "Raticate",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/20.png" },
        { name: "Spearow",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/21.png" },
        { name: "Fearow",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/22.png" },
        { name: "Ekans",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/23.png" },
        { name: "Arbok",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/24.png" },
        { name: "Pikachu",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png" },
        { name: "Raichu",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/26.png" },
        { name: "Sandshrew",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/27.png" },
        { name: "Sandslash",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/28.png" },
        { name: "Nidoran‚ôÄ",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/29.png" },
        { name: "Nidorina",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/30.png" },
        { name: "Nidoqueen",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/31.png" },
        { name: "Nidoran‚ôÇ",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/32.png" },
        { name: "Nidorino",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/33.png" },
        { name: "Nidoking",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/34.png" },
        { name: "Clefairy",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/35.png" },
        { name: "Clefable",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/36.png" },
        { name: "Vulpix",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/37.png" },
        { name: "Ninetales",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/38.png" },
        { name: "Jigglypuff", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/39.png" },
        { name: "Wigglytuff", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/40.png" },
        { name: "Zubat",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/41.png" },
        { name: "Golbat",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/42.png" },
        { name: "Oddish",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/43.png" },
        { name: "Gloom",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/44.png" },
        { name: "Vileplume",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/45.png" },
        { name: "Paras",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/46.png" },
        { name: "Parasect",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/47.png" },
        { name: "Venonat",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/48.png" },
        { name: "Venomoth",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/49.png" },
        { name: "Diglett",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/50.png" },
        { name: "Dugtrio",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/51.png" },
        { name: "Meowth",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/52.png" },
        { name: "Persian",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/53.png" },
        { name: "Psyduck",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/54.png" },
        { name: "Golduck",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/55.png" },
        { name: "Mankey",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/56.png" },
        { name: "Primeape",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/57.png" },
        { name: "Growlithe",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/58.png" },
        { name: "Arcanine",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/59.png" },
        { name: "Poliwag",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/60.png" },
        { name: "Poliwhirl",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/61.png" },
        { name: "Poliwrath",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/62.png" },
        { name: "Abra",       img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/63.png" },
        { name: "Kadabra",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/64.png" },
        { name: "Alakazam",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/65.png" },
        { name: "Machop",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/66.png" },
        { name: "Machoke",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/67.png" },
        { name: "Machamp",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/68.png" },
        { name: "Bellsprout", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/69.png" },
        { name: "Weepinbell", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/70.png" },
        { name: "Victreebel", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/71.png" },
        { name: "Tentacool",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/72.png" },
        { name: "Tentacruel", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/73.png" },
        { name: "Geodude",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/74.png" },
        { name: "Graveler",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/75.png" },
        { name: "Golem",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/76.png" },
        { name: "Ponyta",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/77.png" },
        { name: "Rapidash",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/78.png" },
        { name: "Slowpoke",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/79.png" },
        { name: "Slowbro",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/80.png" },
        { name: "Magnemite",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/81.png" },
        { name: "Magneton",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/82.png" },
        { name: "Farfetch'd", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/83.png" },
        { name: "Doduo",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/84.png" },
        { name: "Dodrio",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/85.png" },
        { name: "Seel",       img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/86.png" },
        { name: "Dewgong",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/87.png" },
        { name: "Grimer",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/88.png" },
        { name: "Muk",        img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/89.png" },
        { name: "Shellder",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/90.png" },
        { name: "Cloyster",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/91.png" },
        { name: "Gastly",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/92.png" },
        { name: "Haunter",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/93.png" },
        { name: "Gengar",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/94.png" },
        { name: "Onix",       img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/95.png" },
        { name: "Drowzee",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/96.png" },
        { name: "Hypno",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/97.png" },
        { name: "Krabby",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/98.png" },
        { name: "Kingler",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/99.png" },
        { name: "Voltorb",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/100.png" },
        { name: "Electrode",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/101.png" },
        { name: "Exeggcute",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/102.png" },
        { name: "Exeggutor",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/103.png" },
        { name: "Cubone",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/104.png" },
        { name: "Marowak",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/105.png" },
        { name: "Hitmonlee",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/106.png" },
        { name: "Hitmonchan", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/107.png" },
        { name: "Lickitung",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/108.png" },
        { name: "Koffing",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/109.png" },
        { name: "Weezing",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/110.png" },
        { name: "Rhyhorn",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/111.png" },
        { name: "Rhydon",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/112.png" },
        { name: "Chansey",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/113.png" },
        { name: "Tangela",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/114.png" },
        { name: "Kangaskhan", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/115.png" },
        { name: "Horsea",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/116.png" },
        { name: "Seadra",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/117.png" },
        { name: "Goldeen",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/118.png" },
        { name: "Seaking",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/119.png" },
        { name: "Staryu",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/120.png" },
        { name: "Starmie",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/121.png" },
        { name: "Mr. Mime",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/122.png" },
        { name: "Scyther",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/123.png" },
        { name: "Jynx",       img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/124.png" },
        { name: "Electabuzz", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/125.png" },
        { name: "Magmar",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/126.png" },
        { name: "Pinsir",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/127.png" },
        { name: "Tauros",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/128.png" },
        { name: "Magikarp",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/129.png" },
        { name: "Gyarados",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/130.png" },
        { name: "Lapras",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/131.png" },
        { name: "Ditto",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/132.png" },
        { name: "Eevee",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/133.png" },
        { name: "Vaporeon",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/134.png" },
        { name: "Jolteon",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/135.png" },
        { name: "Flareon",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/136.png" },
        { name: "Porygon",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/137.png" },
        { name: "Omanyte",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/138.png" },
        { name: "Omastar",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/139.png" },
        { name: "Kabuto",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/140.png" },
        { name: "Kabutops",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/141.png" },
        { name: "Aerodactyl", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/142.png" },
        { name: "Snorlax",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/143.png" },
        { name: "Articuno",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/144.png" },
        { name: "Zapdos",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/145.png" },
        { name: "Moltres",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/146.png" },
        { name: "Dratini",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/147.png" },
        { name: "Dragonair",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/148.png" },
        { name: "Dragonite",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/149.png" },
        { name: "Mewtwo",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/150.png" },
        { name: "Mew",        img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/151.png" },
        { name: "Chikorita",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/152.png" },
        { name: "Bayleef",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/153.png" },
        { name: "Meganium",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/154.png" },
        { name: "Cyndaquil",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/155.png" },
        { name: "Quilava",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/156.png" },
        { name: "Typhlosion", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/157.png" },
        { name: "Totodile",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/158.png" },
        { name: "Croconaw",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/159.png" },
        { name: "Feraligatr", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/160.png" },
        { name: "Sentret",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/161.png" },
        { name: "Furret",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/162.png" },
        { name: "Hoothoot",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/163.png" },
        { name: "Noctowl",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/164.png" },
        { name: "Ledyba",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/165.png" },
        { name: "Ledian",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/166.png" },
        { name: "Spinarak",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/167.png" },
        { name: "Ariados",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/168.png" },
        { name: "Crobat",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/169.png" },
        { name: "Chinchou",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/170.png" },
        { name: "Lanturn",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/171.png" },
        { name: "Pichu",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/172.png" },
        { name: "Cleffa",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/173.png" },
        { name: "Igglybuff",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/174.png" },
        { name: "Togepi",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/175.png" },
        { name: "Togetic",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/176.png" },
        { name: "Natu",       img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/177.png" },
        { name: "Xatu",       img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/178.png" },
        { name: "Mareep",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/179.png" },
        { name: "Flaaffy",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/180.png" },
        { name: "Ampharos",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/181.png" },
        { name: "Bellossom",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/182.png" },
        { name: "Marill",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/183.png" },
        { name: "Azumarill",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/184.png" },
        { name: "Sudowoodo",  img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/185.png" },
        { name: "Politoed",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/186.png" },
        { name: "Hoppip",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/187.png" },
        { name: "Skiploom",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/188.png" },
        { name: "Jumpluff",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/189.png" },
        { name: "Aipom",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/190.png" },
        { name: "Sunkern",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/191.png" },
        { name: "Sunflora",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/192.png" },
        { name: "Yanma",      img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/193.png" },
        { name: "Wooper",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/194.png" },
        { name: "Quagsire",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/195.png" },
        { name: "Espeon",     img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/196.png" },
        { name: "Umbreon",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/197.png" },
        { name: "Murkrow",    img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/198.png" },
        { name: "Slowking",   img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/199.png" },
        { name: "Misdreavus", img: "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/200.png" }
    ];


    const startMenuEl = document.getElementById("start-menu");
    const continueBtnContainer = document.getElementById("continue-btn-container");
    const continueGameBtn = document.getElementById("continueGameBtn");
    const newGameBtn = document.getElementById("newGameBtn");
    const newGameForm = document.getElementById("newGameForm");
    const playerNameInput = document.getElementById("playerNameInput");
    const playerGoalInput = document.getElementById("playerGoalInput");
    const startNewGameBtn = document.getElementById("startNewGameBtn");
    const playerInfoContainer = document.getElementById("playerInfoContainer");
    const trophyInfoEl = document.getElementById("trophyInfo");
    const playerNameEl = document.getElementById("player-name");
    const starsCountEl = document.getElementById("stars-count");
    const mainTitleEl = document.getElementById("mainTitle");
    const mainMenuEl = document.getElementById("main-menu");
    const gameAreaEl = document.getElementById("game-area");
    const backToMenuBtn = document.getElementById("backToMenuBtn");
    const confettiCanvas = document.getElementById("confettiCanvas");
    const confettiCtx = confettiCanvas.getContext("2d");
    let confettiActive = false;

    window.onload = function () {
        showStartMenu();
        if(hasReachedGoal) {
            trophyInfoEl.style.display = "inline-block";
        }
    };

    function showStartMenu() {
        document.getElementById("startScreen").style.display = "block";
        if (!savedName) {
            continueBtnContainer.style.display = "none";
        } else {
            continueBtnContainer.style.display = "block";
        }
        mainMenuEl.classList.add("d-none");
        playerInfoContainer.classList.add("d-none");
        gameAreaEl.classList.add("d-none");
        mainTitleEl.style.display = "block";
        backToMenuBtn.style.display = "none";
        playerNameInput.value = savedName || "";
    }

    continueGameBtn.onclick = function () {
        playerName = savedName;
        stars = savedStars;
        previousStars = stars;
        savedGoal = parseInt(localStorage.getItem("playerGoal") || "0", 10);
        hasReachedGoal = (localStorage.getItem("hasReachedGoal") === "true");
        document.getElementById("startScreen").style.display = "none";
        showPlayerInfo();
        buildMainMenu();
        showMainMenu();
    };

    newGameBtn.onclick = function () {
        newGameForm.classList.remove("d-none");
    };

    startNewGameBtn.onclick = function () {
        const chosenName = playerNameInput.value.trim();
        const chosenGoal = parseInt(playerGoalInput.value.trim() || "0", 10);
        if (!chosenName) {
            alert("Por favor, informe um nome para iniciar!");
            return;
        }
        if (chosenGoal < 1) {
            alert("Por favor, informe uma meta de estrelas v√°lida!");
            return;
        }
        playerName = chosenName;
        stars = 0;
        previousStars = 0;
        localStorage.setItem("playerName", playerName);
        localStorage.setItem("stars", String(stars));
        savedGoal = chosenGoal;
        localStorage.setItem("playerGoal", String(chosenGoal));
        hasReachedGoal = false;
        localStorage.setItem("hasReachedGoal", "false");
        gameStars = {};
        localStorage.setItem("gameStars", JSON.stringify(gameStars));
        stickerList = [];
        localStorage.removeItem("myStickers");
        updateStickerCount();
        document.getElementById("startScreen").style.display = "none";
        showPlayerInfo();
        buildMainMenu();
        showMainMenu();
    };

    function showPlayerInfo() {
        playerInfoContainer.classList.remove("d-none");
        playerNameEl.textContent = playerName;
        starsCountEl.textContent = stars;
        trophyInfoEl.style.display = hasReachedGoal ? "inline-block" : "none";
    }

    function buildMainMenu(showMenu = true) {
        if (showMenu) {
            mainMenuEl.classList.remove("d-none");
        }
        mainMenuEl.innerHTML = "";
        const gameConfigs = [
            { id: "numbers",       label: "N√∫meros" },
            { id: "letters",       label: "Letras" },
            { id: "counting",      label: "Contar" },
            { id: "word",          label: "Palavras" },
            { id: "shadows",       label: "Sombras" },
            { id: "puzzle",        label: "Quebra-cabe√ßa" },
            { id: "colors",        label: "Cores" },
            { id: "weather",       label: "Clima" },
            { id: "categories",    label: "Categorias" },
            { id: "reading",       label: "Formar Palavra" },
            { id: "palworld",      label: "Palworld" },
            { id: "pokemon",       label: "Pokemon" },
            { id: "pokemonBattle", label: "Pok√©Battle" },
            { id: "habitat", label: "Habitats" },
            { id: "combos", label: "Combina√ß√µes" },
            { id: "arms", label: "Bra√ßos" },
            { id: "litleFarm", label: "Fazendinha" }
        ];
        gameConfigs.forEach((cfg) => {
            const starsInThisGame = gameStars[cfg.id] || 0;
            const gmDiv = document.createElement("div");
            gmDiv.className = "game-mode";
            gmDiv.onclick = () => startGame(cfg.id);
            const titleDiv = document.createElement("div");
            titleDiv.textContent = cfg.label;
            const starDiv = document.createElement("div");
            starDiv.textContent = `(${starsInThisGame}‚≠ê)`;
            gmDiv.appendChild(titleDiv);
            gmDiv.appendChild(starDiv);
            mainMenuEl.appendChild(gmDiv);
        });
    }

    function showMainMenu() {
        clearTimeoutIfAny();
        locked = false;
        document.getElementById("startScreen").style.display = "none";
        mainMenuEl.classList.remove("d-none");
        gameAreaEl.classList.add("d-none");
        mainTitleEl.style.display = "none";
        playerInfoContainer.classList.remove("d-none");
        backToMenuBtn.style.display = "none";
    }

    function cancelNextGameAndMenu() {
        clearTimeoutIfAny();
        locked = false;
        if (stars > previousStars) {
            speak("Uau, voc√™ conseguiu mais estrelas! Que incr√≠vel! Continue assim!");
            showFeedback("Uau, voc√™ conseguiu mais estrelas! Que incr√≠vel! Continue assim!", true);
        } else if (stars < previousStars) {
            speak("N√£o fique triste, voc√™ vai conseguir na pr√≥xima! Continue tentando!");
            showFeedback("N√£o fique triste, voc√™ vai conseguir na pr√≥xima! Continue tentando!", false);
        }
        previousStars = stars;
        showMainMenu();
    }

    function clearTimeoutIfAny() {
        if (nextGameTimeout) {
            clearTimeout(nextGameTimeout);
            nextGameTimeout = null;
        }
    }

    function startGame(mode) {
        clearTimeoutIfAny();
        locked = false;
        currentGame = mode;
        mainMenuEl.classList.add("d-none");
        gameAreaEl.classList.remove("d-none");
        gameAreaEl.style.display = "block";
        backToMenuBtn.style.display = "inline";
        document.getElementById("feedback").textContent = "";
        document.getElementById("content").innerHTML = "";
        switch (mode) {
            case "numbers":       initNumbersGame(); break;
            case "letters":       initLettersGame(); break;
            case "counting":      initCountingGame(); break;
            case "word":          initWordGame(); break;
            case "shadows":       initShadowGame(); break;
            case "puzzle":        initPuzzleGame(); break;
            case "colors":        initColorGame(); break;
            case "weather":       initWeatherGame(); break;
            case "categories":    initCategoryGame(); break;
            case "reading":       initReadingGame(); break;
            case "palworld":      initPalworldGame(); break;
            case "pokemon":       initPokemonGame(); break;
            case "pokemonBattle": initPokemonBattleGame(); break;
            case "habitat":       initHabitatGame(); break;
            case "combos": initCombosGame(); break;
            case "arms": initArmsGame(); break;
            case "litleFarm": initLitleFarmGame(); break;
        }
    }

    function scheduleReplayGame(mode, delay=1500) {
        clearTimeoutIfAny();
        nextGameTimeout = setTimeout(() => {
            startGame(mode);
        }, delay);
    }

    const emojiDatabase = {
        A: [{ emoji: "‚úàÔ∏è", nome: "Avi√£o" }, { emoji: "üå≥", nome: "√Årvore" }, { emoji: "üé®", nome: "Arte" },
            { emoji: "üèπ", nome: "Arco e Flecha" }, { emoji: "üêú", nome: "Aranha" }, { emoji: "‚öì", nome: "√Çncora" },
            { emoji: "üé≠", nome: "Ator" }, { emoji: "üöë", nome: "Ambul√¢ncia" }, { emoji: "üåà", nome: "Arco-√≠ris" },
            { emoji: "üçö", nome: "Arroz" }],
        B: [{ emoji: "üéà", nome: "Bal√£o" }, { emoji: "üö≤", nome: "Bicicleta" }, { emoji: "üçå", nome: "Banana" },
            { emoji: "üîã", nome: "Bateria" }, { emoji: "üèÄ", nome: "Basquete" }, { emoji: "üêù", nome: "Abelha" },
            { emoji: "üçü", nome: "Batata Frita" }, { emoji: "‚öñ", nome: "Balan√ßa" }, { emoji: "üçÜ", nome: "Berinjela" },
            { emoji: "‚öΩ", nome: "Bola" }],
        C: [{ emoji: "üè°", nome: "Casa" }, { emoji: "üè∞", nome: "Castelo" }, { emoji: "üèôÔ∏è", nome: "Cidade" },
            { emoji: "üêç", nome: "Cobra" }, { emoji: "üê∂", nome: "Cachorro" }, { emoji: "‚òï", nome: "Caf√©" },
            { emoji: "üçµ", nome: "Ch√°" }, { emoji: "üöó", nome: "Carro" }, { emoji: "üé†", nome: "Carrossel" },
            { emoji: "ü¶å", nome: "Cervo" }, { emoji: "ü•ï", nome: "Cenoura" }, { emoji: "üîë", nome: "Chave" },
            { emoji: "ü¶â", nome: "Coruja" }, { emoji: "üèÉ", nome: "Corrida" }],
        D: [{ emoji: "üé≤", nome: "Dado" }, { emoji: "üêâ", nome: "Drag√£o" }, { emoji: "üíé", nome: "Diamante" },
            { emoji: "üéØ", nome: "Dardo" }, { emoji: "üìÖ", nome: "Data" }],
        E: [{ emoji: "‚≠ê", nome: "Estrela" }, { emoji: "üìß", nome: "E-mail" }, { emoji: "üêò", nome: "Elefante" },
            { emoji: "üîå", nome: "Energia" }, { emoji: "üõ§", nome: "Estrada" }],
        F: [{ emoji: "üéó", nome: "Fita" }, { emoji: "üå∏", nome: "Flor" }, { emoji: "üêú", nome: "Formiga" },
            { emoji: "üî•", nome: "Fogo" }, { emoji: "üé∫", nome: "Flauta" }, { emoji: "üèÅ", nome: "Final" },
            { emoji: "üçÇ", nome: "Folha" }, { emoji: "üöÄ", nome: "Foguete" }, { emoji: "üåπ", nome: "Flor" }],
        G: [{ emoji: "üê¨", nome: "Golfinho" }, { emoji: "üê±", nome: "Gato" }, { emoji: "ü¶í", nome: "Girafa" },
            { emoji: "‚òÇÔ∏è", nome: "Guarda-chuva" }, { emoji: "üé∏", nome: "Guitarra" }, { emoji: "ü•Ö", nome: "Gol" },
            { emoji: "üèåÔ∏è", nome: "Golfe" }],
        H: [{ emoji: "üè•", nome: "Hospital" }, { emoji: "üöÅ", nome: "Helic√≥ptero" }, { emoji: "üêπ", nome: "Hamster" }],
        I: [{ emoji: "üèù", nome: "Ilha" }, { emoji: "üí°", nome: "Ideia" }, { emoji: "üì±", nome: "Internet" },
            { emoji: "üñº", nome: "Imagem" }],
        J: [{ emoji: "üé∑", nome: "Jazz" }, { emoji: "üöô", nome: "Jipe" }],
        K: [{ emoji: "ü•ù", nome: "Kiwi" }, { emoji: "ü§π", nome: "Karat√™" }, { emoji: "ü•ã", nome: "Kimono" }],
        L: [{ emoji: "üçã", nome: "Lim√£o" }, { emoji: "üìö", nome: "Livro" }, { emoji: "üí°", nome: "L√¢mpada" },
            { emoji: "ü¶Å", nome: "Le√£o" }, { emoji: "üåô", nome: "Lua" }, { emoji: "üçä", nome: "Laranja" },
            { emoji: "üèûÔ∏è", nome: "Lago" }, { emoji: "üõ≥", nome: "Lancha" }],
        M: [{ emoji: "üé∂", nome: "M√∫sica" }, { emoji: "üé§", nome: "Microfone" }, { emoji: "üçé", nome: "Ma√ß√£" },
            { emoji: "üêµ", nome: "Macaco" }, { emoji: "üçà", nome: "Mel√£o" }, { emoji: "üåä", nome: "Mar" },
            { emoji: "üèî", nome: "Montanha" }, { emoji: "üó∫", nome: "Mapa" }, { emoji: "‚úâÔ∏è", nome: "Mensagem" },
            { emoji: "üöá", nome: "Metr√¥" }, { emoji: "ü¶á", nome: "Morcego" }, { emoji: "üî®", nome: "Machado" }],
        N: [{ emoji: "‚ùÑÔ∏è", nome: "Neve" }, { emoji: "üö¢", nome: "Navio" }],
        O: [{ emoji: "ü•ö", nome: "Ovo" }, { emoji: "üè¢", nome: "Oficina" }, { emoji: "üé®", nome: "Obra de Arte" },
            { emoji: "üöå", nome: "√înibus" }],
        P: [{ emoji: "üê†", nome: "Peixe" }, { emoji: "üçï", nome: "Pizza" }, { emoji: "üêß", nome: "Pinguim" },
            { emoji: "üéÅ", nome: "Presente" }, { emoji: "üö™", nome: "Porta" }, { emoji: "üêô", nome: "Polvo" },
            { emoji: "üì¶", nome: "Pacote" }, { emoji: "ü•û", nome: "Panqueca" }, { emoji: "ü•ñ", nome: "P√£o" }],
        Q: [{ emoji: "üëë", nome: "Queijo" }, { emoji: "üÉè", nome: "Quebra-cabe√ßa" }, { emoji: "üñº", nome: "Quadro" }],
        R: [{ emoji: "ü¶ä", nome: "Raposa" }, { emoji: "üìª", nome: "R√°dio" }, { emoji: "ü¶è", nome: "Rinoceronte" },
            { emoji: "ü§ñ", nome: "Robo" }],
        S: [{ emoji: "üö¶", nome: "Sem√°foro" }, { emoji: "üåû", nome: "Sol" }, { emoji: "ü•ó", nome: "Salada" },
            { emoji: "üîî", nome: "Sino de Natal" }],
        T: [{ emoji: "üé©", nome: "Teatro" }, { emoji: "üåÆ", nome: "Taco" }, { emoji: "üöÜ", nome: "Trem" },
            { emoji: "üéπ", nome: "Teclado" }, { emoji: "üé∫", nome: "Trompete" }, { emoji: "üìû", nome: "Telefone" },
            { emoji: "üåç", nome: "Terra" }, { emoji: "üèÜ", nome: "Trof√©u" }, { emoji: "ü•Å", nome: "Tambor" }],
        U: [{ emoji: "ü¶Ñ", nome: "Unic√≥rnio" }, { emoji: "üçá", nome: "Uva" }],
        V: [{ emoji: "üéª", nome: "Violino" }, { emoji: "üåã", nome: "Vulc√£o" }, { emoji: "üç∑", nome: "Vinho" },
            { emoji: "üéÆ", nome: "Videogame" }, { emoji: "üìπ", nome: "V√≠deo" }, { emoji: "üöê", nome: "Van" },
            { emoji: "üîä", nome: "Volume" }],
        X: [{ emoji: "‚ùå", nome: "Xis" }],
        Z: [{ emoji: "ü¶ì", nome: "Zebra" }]
    };

    /* Array de exemplos com figuras reais (voc√™ deve colocar os caminhos corretos de imagens). */
    const armsData = [
        {
            childDesc: "Menino com 2 bra√ßos abertos",
            childImg: "img/menino_2abertos.webp",
            positionName: "2 bra√ßos abertos",
            positionImg: "img/menino_2abertos.webp"
        },
        {
            childDesc: "Menino com 1 bra√ßo aberto e outro levantado",
            childImg: "img/menino_1aberto1levantado.webp",
            positionName: "1 bra√ßo aberto + 1 levantado",
            positionImg: "img/menino_1aberto1levantado.webp"
        },
        {
            childDesc: "Menino com 1 bra√ßo abaixado e outro levantado",
            childImg: "img/menino_1abaixado_1levantado.webp",
            positionName: "1 bra√ßo abaixado + 1 levantado",
            positionImg: "img/menino_1abaixado_1levantado.webp"
        },
        {
            childDesc: "Menino com 2 bra√ßos abaixados",
            childImg: "img/menino_2abaixados.webp",
            positionName: "2 bra√ßos abaixados",
            positionImg: "img/menino_2abaixados.webp"
        },
        {
            childDesc: "Menino com 2 bra√ßos levantados",
            childImg: "img/menino_2levantados.webp",
            positionName: "2 bra√ßos levantados",
            positionImg: "img/menino_2levantados.webp",
        },
    ];

    const litleFarmData = [
        {
            childImg: "img/fazendinha_opcao1.webp",
            positionImg: "img/fazendinha_opcao1.webp"
        },
        {
            childImg: "img/fazendinha_opcao2.webp",
            positionImg: "img/fazendinha_opcao2.webp"
        },
        {
            childImg: "img/fazendinha_opcao3.webp",
            positionImg: "img/fazendinha_opcao3.webp"
        },
        {
            childImg: "img/fazendinha_opcao4.webp",
            positionImg: "img/fazendinha_opcao4.webp"
        },
        {
            childImg: "img/fazendinha_opcao5.webp",
            positionImg: "img/fazendinha_opcao5.webp"
        },
        {
            childImg: "img/fazendinha_opcao6.webp",
            positionImg: "img/fazendinha_opcao6.webp"
        },
        {
            childImg: "img/fazendinha_opcao7.webp",
            positionImg: "img/fazendinha_opcao7.webp"
        },
        {
            childImg: "img/fazendinha_opcao8.webp",
            positionImg: "img/fazendinha_opcao8.webp"
        },
        {
            childImg: "img/fazendinha_opcao9.webp",
            positionImg: "img/fazendinha_opcao9.webp"
        },
        {
            childImg: "img/fazendinha_opcao10.webp",
            positionImg: "img/fazendinha_opcao10.webp"
        },
        {
            childImg: "img/fazendinha_opcao11.webp",
            positionImg: "img/fazendinha_opcao11.webp"
        },
        {
            childImg: "img/fazendinha_opcao12.webp",
            positionImg: "img/fazendinha_opcao12.webp"
        },
        {
            childImg: "img/fazendinha_opcao13.webp",
            positionImg: "img/fazendinha_opcao13.webp"
        },
        {
            childImg: "img/fazendinha_opcao14.webp",
            positionImg: "img/fazendinha_opcao14.webp"
        },
        {
            childImg: "img/fazendinha_opcao15.webp",
            positionImg: "img/fazendinha_opcao15.webp"
        },
        {
            childImg: "img/fazendinha_opcao16.webp",
            positionImg: "img/fazendinha_opcao16.webp"
        },
        {
            childImg: "img/fazendinha_opcao17.webp",
            positionImg: "img/fazendinha_opcao17.webp"
        },
        {
            childImg: "img/fazendinha_opcao18.webp",
            positionImg: "img/fazendinha_opcao18.webp"
        },
    ];

    function initNumbersGame() {
        const content = document.getElementById("content");
        let targetNumber = Math.floor(Math.random() * 100) + 1;
        while (targetNumber === lastNumber) {
            targetNumber = Math.floor(Math.random() * 100) + 1;
        }
        lastNumber = targetNumber;
        content.innerHTML = `
          <h2>Encontre o n√∫mero:</h2>
          <div class="target-number">${targetNumber}</div>
          <div class="numbers-grid" id="numbers-grid"></div>
        `;
        let possibleNumbers = Array.from({length:200},(_,i)=> i+1);
        const options = shuffle([
            targetNumber,
            ...shuffle(possibleNumbers.filter((n) => n !== targetNumber)).slice(0,19)
        ]);
        const grid = document.getElementById("numbers-grid");
        options.forEach((num) => {
            const div = document.createElement("div");
            div.className = "number-option";
            div.textContent = num;
            div.onclick = () => {
                if(locked) return;
                checkNumber(num === targetNumber);
            };
            grid.appendChild(div);
        });
        speak(`Encontre o n√∫mero ${targetNumber}`);
    }
    function checkNumber(isCorrect) {
        locked = true;
        if (isCorrect) {
            updateStars(1);
            showFeedback("Correto!", true);
            scheduleReplayGame("numbers");
        } else {
            updateStars(-1);
            showFeedback("Tente novamente!", false);
            speak("Ops! Esse n√£o √© o n√∫mero");
            locked = false;
        }
    }

    function initLettersGame() {
        const content = document.getElementById("content");
        const validLetters = Object.keys(emojiDatabase);
        let targetLetter = validLetters[Math.floor(Math.random() * validLetters.length)];
        while (targetLetter === lastLetter) {
            targetLetter = validLetters[Math.floor(Math.random() * validLetters.length)];
        }
        lastLetter = targetLetter;
        const validEmojis = emojiDatabase[targetLetter];
        content.innerHTML = `
          <h2>Encontre emojis que come√ßam com:</h2>
          <div style="font-size:2rem; margin-bottom:5px;">${targetLetter}</div>
          <div class="emoji-grid" id="emoji-grid"></div>
        `;
        const grid = content.querySelector("#emoji-grid");
        const allEmojis = Object.values(emojiDatabase).flat();
        const correctOptions = shuffle([...validEmojis]).slice(0,3);
        const incorrectOptions = shuffle(allEmojis.filter((e) => !validEmojis.includes(e))).slice(0,13);
        const mixedOptions = shuffle([...correctOptions, ...incorrectOptions]);
        mixedOptions.forEach((emojiObj) => {
            const div = document.createElement("div");
            div.className = "emoji-option";
            div.innerHTML = `
              <div>${emojiObj.emoji}</div>
              <div class="emoji-name">${emojiObj.nome}</div>
            `;
            div.onclick = () => {
                if(locked) return;
                checkEmoji(validEmojis.includes(emojiObj), emojiObj.nome);
            };
            grid.appendChild(div);
        });
        speak(`Encontre coisas que come√ßam com a letra ${targetLetter}`);
    }
    function checkEmoji(isCorrect, nome) {
        locked = true;
        if (isCorrect) {
            updateStars(1);
            showFeedback("Certo!", true);
            scheduleReplayGame("letters");
        } else {
            updateStars(-1);
            showFeedback(`"${nome}" come√ßa com ${nome[0].toUpperCase()}!`, false);
            speak(`Ops! ${nome} come√ßa com ${nome[0].toUpperCase()}!`);
            locked = false;
        }
    }

    function initCountingGame() {
        const content = document.getElementById("content");
        let targetCount = Math.floor(Math.random() * 10) + 1;
        while (targetCount === lastCount) {
            targetCount = Math.floor(Math.random() * 10) + 1;
        }
        lastCount = targetCount;
        const possibleEmojis = ["üçé","‚≠ê","üêª","üéà","üç™","üê∂","üçâ","üöó","üéÆ","üçï","üèÄ","üê†","üç©","üöÇ","üåª","üê±"];
        const targetEmoji = shuffle(possibleEmojis)[0];
        content.innerHTML = `
          <h2>Conte at√©:</h2>
          <div class="counting-target">
            <div class="count-box">${targetCount}</div>
            <div class="count-box">${targetEmoji}</div>
          </div>
          <div id="counter">0</div>
          <div class="counting-emoji-grid" id="countingGrid"></div>
        `;
        const grid = content.querySelector("#countingGrid");
        const distractors = shuffle(possibleEmojis.filter(e => e !== targetEmoji));
        const finalOptions = shuffle([targetEmoji, ...distractors.slice(0,15)]);
        finalOptions.forEach((emoji) => {
            const div = document.createElement("div");
            div.className = "count-emoji-option";
            div.textContent = emoji;
            div.onclick = () => {
                if(locked) return;
                handleCountClick(emoji === targetEmoji, targetCount);
            };
            grid.appendChild(div);
        });
        speak(`Clique ${targetCount} vezes no ${getEmojiName(targetEmoji)}`);
    }
    function handleCountClick(isCorrect, target) {
        if (!isCorrect) {
            speak("Esse n√£o √© o emoji correto!");
            updateStars(-1);
            showFeedback("Emoji errado!", false);
            return;
        }
        const counter = document.getElementById("counter");
        let count = parseInt(counter.textContent) + 1;
        counter.textContent = count;
        speak(count.toString());
        if (count === target) {
            locked = true;
            updateStars(1);
            showFeedback("Contagem correta!", true);
            scheduleReplayGame("counting");
        }
    }
    function getEmojiName(emoji) {
        const names = {
            "üçé": "ma√ß√£","‚≠ê": "estrela","üêª": "urso","üéà": "bal√£o","üç™": "biscoito",
            "üê∂": "cachorro","üçâ": "melancia","üöó": "carro","üéÆ": "videogame","üçï": "pizza",
            "üèÄ": "bola","üê†": "peixe","üç©": "rosquinha","üöÇ": "trem","üåª": "girassol",
            "üê±": "gato"
        };
        return names[emoji] || "objeto";
    }

    function initWordGame() {
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Monte a palavra do emoji:</h2>";
        const allEmojis = Object.values(emojiDatabase).flat();
        let randomEmoji = shuffle(allEmojis)[0];
        while (randomEmoji === lastWordEmoji) {
            randomEmoji = shuffle(allEmojis)[0];
        }
        lastWordEmoji = randomEmoji;
        const originalName = randomEmoji.nome.toUpperCase();
        const targetLetters = Array.from(originalName).filter(c => c!==" " && c!=="-");
        content.innerHTML += `
          <div class="word-target">
            <div class="target-emoji-big">${randomEmoji.emoji}</div>
            <div id="target-word"></div>
          </div>
          <div class="scrambled-letters" id="scrambled-letters"></div>
        `;
        let targetDisplay = "";
        targetLetters.forEach((letter, i) => {
            targetDisplay += `<span class="letter-box" id="target-letter-${i}">${letter}</span>`;
        });
        document.getElementById("target-word").innerHTML = targetDisplay;
        let scrambledLetters = shuffle([...targetLetters]);
        const lettersContainer = document.getElementById("scrambled-letters");
        scrambledLetters.forEach((letter) => {
            const div = document.createElement("div");
            div.className = "word-letter";
            div.textContent = letter;
            div.onclick = function () {
                if(locked) return;
                handleLetterClick(this, targetLetters);
            };
            lettersContainer.appendChild(div);
        });
        speak(`Monte a palavra: ${randomEmoji.nome}`);
    }
    function handleLetterClick(letterElement, targetLetters) {
        const revealedLetters = document.querySelectorAll("#target-word .revealed");
        const nextIndex = revealedLetters.length;
        speak(letterElement.textContent);
        if (nextIndex < targetLetters.length) {
            const correctLetter = targetLetters[nextIndex];
            if (letterElement.textContent === correctLetter) {
                document.getElementById(`target-letter-${nextIndex}`).classList.add("revealed");
                letterElement.style.visibility = "hidden";
                if (nextIndex === targetLetters.length - 1) {
                    locked = true;
                    showFeedback("Palavra correta!", true);
                    updateStars(1);
                    scheduleReplayGame("word");
                }
            } else {
                updateStars(-1);
                showFeedback("Tente novamente!", false);
                speak("Essa n√£o √© a letra correta");
            }
        }
    }

    function initShadowGame() {
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Toque em uma sombra ou em um emoji, depois no par correto:</h2>";
        const allShadowEmojis = Object.values(emojiDatabase).flat().map(o => o.emoji);
        let uniqueEmojis = Array.from(new Set(allShadowEmojis));
        let chosenEmojis = shuffle(uniqueEmojis).slice(0, 4);
        if(JSON.stringify(chosenEmojis)===JSON.stringify(lastShadowSet)){
            chosenEmojis = shuffle(uniqueEmojis).slice(0,4);
        }
        lastShadowSet = chosenEmojis;
        content.innerHTML += `
          <div class="shadow-container-wrapper">
            <div class="shadow-column" id="shadow-slots">
              ${chosenEmojis.map(e=>`
                <div class="shadow-slot" data-expected="${e}"
                     onclick="handleShadowClick(this,'slot','${e}')"></div>
              `).join("")}
            </div>
            <div class="shadow-column" id="shadow-items">
              ${shuffle(chosenEmojis).map(e=>`
                <div class="shadow-item"
                     onclick="handleShadowClick(this,'item','${e}')">
                  ${e}
                </div>
              `).join("")}
            </div>
          </div>
        `;
        window.shadowGameState = {
            selected: null
        };
        speak("Clique primeiro na sombra ou no emoji, depois selecione seu par.");
    }

    function handleShadowClick(el, type, emoji) {
        if(locked) return;
        const st = window.shadowGameState;
        if(!st.selected) {
            st.selected = { element: el, type, emoji };
            el.classList.add("selected");
            return;
        }
        if(st.selected.element === el) {
            el.classList.remove("selected");
            st.selected = null;
            return;
        }
        const isMatch = (st.selected.emoji === emoji) && (st.selected.type !== type);
        const previouslySelectedEl = st.selected.element;
        if(isMatch) {
            previouslySelectedEl.classList.remove("selected");
            previouslySelectedEl.classList.add("shadow-match");
            el.classList.add("shadow-match");
            el.classList.remove("selected");
            showFeedback("Correto!", true);
            speak("Muito bem!");
            checkAllShadowMatched();
        } else {
            previouslySelectedEl.classList.add("shadow-mismatch");
            el.classList.add("shadow-mismatch");
            speak("Ops! N√£o √© o par certo");
            showFeedback("N√£o √© o par certo!", false);
            updateStars(-1);
            setTimeout(()=>{
                previouslySelectedEl.classList.remove("shadow-mismatch","selected");
                el.classList.remove("shadow-mismatch","selected");
            },800);
        }
        st.selected = null;
    }

    function checkAllShadowMatched() {
        const slots = document.querySelectorAll(".shadow-slot");
        const matchedSlots = Array.from(slots).filter(s => s.classList.contains("shadow-match"));
        if(matchedSlots.length === slots.length) {
            locked = true;
            updateStars(1);
            scheduleReplayGame("shadows");
        }
    }

    function initPuzzleGame() {
        window.puzzleGameState = {
            selected: null,
            correctMatches:0,
            totalPairs:5
        };
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Combine os n√∫meros com a quantidade (em qualquer ordem):</h2>";
        let randomNums = shuffle([...Array(9)].map((_,i)=> i+1)).slice(0,5);
        while(JSON.stringify(randomNums)===JSON.stringify(lastPuzzleSet)){
            randomNums = shuffle([...Array(9)].map((_,i)=> i+1)).slice(0,5);
        }
        lastPuzzleSet = randomNums;
        const emojis = ["üçé","‚≠ê","üéà","üê±","üöó","üéÆ","üçï","üê∂","üå∫"];
        content.innerHTML += `
          <div class="numbers-container">
            ${randomNums.map(num=>`
              <div class="puzzle-piece number-piece"
                   data-num="${num}"
                   onclick="handlePuzzleClick(this,'number',${num})">
                ${num}
              </div>
            `).join("")}
          </div>
          <div class="quantities-container">
            ${shuffle(randomNums).map(num=>`
              <div class="puzzle-piece emoji-piece"
                   data-num="${num}"
                   onclick="handlePuzzleClick(this,'emoji',${num})">
                <div class="puzzle-emoji-grid">
                  ${Array(num).fill(emojis[num-1]).map(e=>`<div class="emoji-cell">${e}</div>`).join("")}
                </div>
              </div>
            `).join("")}
          </div>
        `;
        speak("Conte o n√∫mero de figuras e combine com o n√∫mero correto");
    }

    function handlePuzzleClick(el, type, num) {
        if(locked) return;
        const st = window.puzzleGameState;
        if(!st.selected) {
            el.classList.add("selected");
            st.selected = { el, type, num };
            return;
        }
        if(st.selected.el === el) {
            el.classList.remove("selected");
            st.selected = null;
            return;
        }
        const isPair = (st.selected.num === num) && (st.selected.type !== type);
        if(isPair) {
            st.selected.el.classList.remove("selected");
            st.selected.el.classList.add("matched");
            el.classList.add("matched");
            el.classList.remove("selected");
            st.correctMatches++;
            showFeedback("Combina√ß√£o correta!", true);
            if(st.correctMatches === st.totalPairs) {
                locked = true;
                updateStars(1);
                showFeedback("Voc√™ completou o quebra-cabe√ßa!", true);
                scheduleReplayGame("puzzle");
            }
            st.selected = null;
        } else {
            showFeedback("Tente novamente!", false);
            speak("N√£o combinam!");
            updateStars(-1);
            st.selected.el.classList.add("wrong");
            el.classList.add("wrong");
            setTimeout(()=>{
                st.selected.el.classList.remove("wrong","selected");
                el.classList.remove("wrong");
            },600);
            st.selected = null;
        }
    }

    function initColorGame() {
        const allColors = [
            { name: "Vermelho", hex:"#FF0000" },
            { name: "Azul",     hex:"#0000FF" },
            { name: "Verde",    hex:"#00FF00" },
            { name: "Amarelo",  hex:"#FFD700" },
            { name: "Roxo",     hex:"#800080" },
            { name: "Laranja",  hex:"#FFA500" },
            { name: "Rosa",     hex:"#FF69B4" },
            { name: "Marrom",   hex:"#8B4513" },
        ];
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Toque em uma cor ou em uma caixa, depois escolha seu par correspondente:</h2>";
        let roundColors = shuffle(allColors).slice(0,3);
        while(JSON.stringify(roundColors)===JSON.stringify(lastColorsSet)){
            roundColors = shuffle(allColors).slice(0,3);
        }
        lastColorsSet = roundColors;
        content.innerHTML += `
          <div class="color-area" id="colorItems">
            ${roundColors.map(c=>`
              <div class="color-item"
                   style="background:${c.hex}"
                   data-colorname="${c.name}"
                   onclick="handleColorClick(this,'color','${c.hex}')"></div>
            `).join("")}
          </div>
          <div class="color-area" id="colorBins">
            ${roundColors.map(c=>`
              <div class="color-bin"
                   style="border-color:${c.hex}"
                   data-color="${c.hex}"
                   data-filled="false"
                   onclick="handleColorClick(this,'bin','${c.hex}')">
                <span style="color:${c.hex}">${c.name}</span>
              </div>
            `).join("")}
          </div>
        `;
        window.colorGameState = {
            selected: null,
            correctMatches:0,
            total: roundColors.length
        };
        speak("Combine as cores com as caixas correspondentes");
    }

    function handleColorClick(el, type, colorHex){
        if(locked) return;
        const st = window.colorGameState;
        if(!st.selected) {
            el.classList.add("selected");
            st.selected = { el, type, colorHex };
            return;
        }
        if(st.selected.el === el) {
            el.classList.remove("selected");
            st.selected = null;
            return;
        }
        if(st.selected.colorHex === colorHex && st.selected.type !== type) {
            if(type === "bin") {
                el.classList.remove("selected");
                st.selected.el.classList.remove("selected");
                el.style.backgroundColor = colorHex;
                el.setAttribute("data-filled","true");
                st.correctMatches++;
                showFeedback("Cor correta!", true);
                speak("Muito bem!");
                st.selected.el.style.display = "none";
            } else {
                st.selected.el.classList.remove("selected");
                el.classList.remove("selected");
                st.selected.el.style.backgroundColor = st.selected.colorHex;
                st.selected.el.setAttribute("data-filled","true");
                st.correctMatches++;
                showFeedback("Cor correta!", true);
                speak("Muito bem!");
                el.style.display = "none";
            }
            st.selected = null;
            if(st.correctMatches === st.total) {
                locked = true;
                updateStars(1);
                showFeedback("Cores completas!", true);
                scheduleReplayGame("colors");
            }
        } else {
            showFeedback("Tente outra cor", false);
            speak("Cor incorreta, tente novamente");
            updateStars(-1);
            st.selected.el.classList.add("wrong");
            el.classList.add("wrong");
            setTimeout(()=>{
                st.selected.el.classList.remove("wrong","selected");
                el.classList.remove("wrong","selected");
            },600);
            st.selected = null;
        }
    }

    function initWeatherGame(){
        const weatherData = [
            { icon:"‚òÄÔ∏è", correctItems:["üï∂Ô∏è","üé©","üß¥"], title:"Ensolarado" },
            { icon:"üåßÔ∏è", correctItems:["‚òÇÔ∏è","üß•","ü•æ"], title:"Chuvoso" },
            { icon:"‚ùÑÔ∏è", correctItems:["üß§","üß£","üéø"], title:"Frio" }
        ];
        const content = document.getElementById("content");
        let currentWeather = weatherData[Math.floor(Math.random()*weatherData.length)];
        while(currentWeather===lastWeather){
            currentWeather = weatherData[Math.floor(Math.random()*weatherData.length)];
        }
        lastWeather = currentWeather;
        const incorrectItems = ["üé∏","üìò","üéà","üé™","üé≠","üé®","üçï","üö≤"];
        const allItems = shuffle([...currentWeather.correctItems, ...shuffle(incorrectItems).slice(0,3)]);
        content.innerHTML=`
          <h2>Escolha os itens para o clima:</h2>
          <div class="weather-card">
            <div class="weather-icon">${currentWeather.icon}</div>
            <div class="weather-title">${currentWeather.title}</div>
            <div class="weather-items" id="weather-items">
              ${allItems.map(item=>`
                <div class="weather-item"
                     onclick="handleWeatherItem(this,'${item}','${currentWeather.icon}')">
                  ${item}
                </div>
              `).join("")}
            </div>
          </div>
        `;
        window.weatherGameState={
            correctCount:0,
            totalCorrect:currentWeather.correctItems.length,
            currentIcon: currentWeather.icon
        };
        speak(`Selecione as figuras para o clima ${currentWeather.title}`);
    }
    function handleWeatherItem(el, item, correctIcon){
        if(locked) return;
        const correctItems = {
            "‚òÄÔ∏è":["üï∂Ô∏è","üé©","üß¥"],
            "üåßÔ∏è":["‚òÇÔ∏è","üß•","ü•æ"],
            "‚ùÑÔ∏è":["üß§","üß£","üéø"]
        }[correctIcon];
        if(el.classList.contains("selected")) return;
        if(correctItems.includes(item)){
            el.classList.add("weather-correct");
            el.classList.add("selected");
            showFeedback("Item correto!", true);
            window.weatherGameState.correctCount++;
            if(window.weatherGameState.correctCount===window.weatherGameState.totalCorrect){
                locked=true;
                updateStars(1);
                showFeedback("Desafio completo!", true);
                scheduleReplayGame("weather");
            }
        } else {
            el.style.background="#FFCDD2";
            el.style.animation="shake 0.5s";
            showFeedback("N√£o √© para este clima!", false);
            speak("N√£o √© para este clima");
            setTimeout(()=>{
                el.style.background="";
                el.style.animation="";
            },1000);
            updateStars(-1);
        }
    }

    /* ALTERADO: A CADA ACERTO NO JOGO "CATEGORIAS" DAR 1 ESTRELA TAMB√âM */
    function initCategoryGame(){
        const content = document.getElementById("content");
        content.innerHTML="<h2>Classifique os itens em suas categorias:</h2>";
        const categories = [
            {
                name:"Animais", icon:"üê∂",
                items:[
                    "üê±","üêô","üê∂","üê∑","ü¶ä","ü¶Å","üêØ","üê∫","üê∏","ü¶ì","ü¶í","üêµ","üêº","üêπ","üê∞",
                    "üêª","üê®","üêî","ü¶Ü","ü¶Ö","ü¶â","üê¢","üêç","ü¶ã","ü¶á","ü¶î","ü¶£","üêä","üêõ","ü¶ï","ü¶ñ"
                ]
            },
            {
                name:"Frutas", icon:"üçé",
                items:[
                    "üçé","üçå","üçá","üçä","ü•ù","üçê","üçç","üçë","üçí","üçâ","üçì","ü•≠","üçÖ","üçè","üçã","ü••","ü´ê"
                ]
            },
            {
                name:"Ve√≠culos", icon:"üöó",
                items:[
                    "üöó","‚úàÔ∏è","üö≤","üöå","‚õµ","üöï","üöô","üöé","üèéÔ∏è","üöì","üöë","üöí","üöê","üõµ","üèçÔ∏è","üöÇ","üöÜ",
                    "üöá","üöù","üöû","üöä","üõ©Ô∏è","üö§","‚õ¥Ô∏è","üö¢","üõ•Ô∏è","üõ≥Ô∏è","üöÄ","üöÅ","üö°","üö†","üöü","ü¶º"
                ]
            }
        ];
        const allCategoryData = [];
        for(const cat of categories){
            for(const em of cat.items){
                allCategoryData.push({ emoji: em, category: cat.name });
            }
        }
        const chosenItems = [];
        categories.forEach(cat => {
            const shuffled = shuffle(cat.items);
            const selected = shuffled.slice(0,10);
            selected.forEach( em => {
                chosenItems.push({ emoji: em, category: cat.name });
            });
        });
        lastCategoriesSet = chosenItems;
        let html = `<div class="category-game-container" style="margin-bottom:5px;">`;
        categories.forEach(cat=>{
            html += `
              <div class="category-bin"
                   data-category="${cat.name}"
                   data-filled="0"
                   onclick="placeInCategory(this,'${cat.name}')">
                <div class="category-label">${cat.icon} ${cat.name}</div>
                <div class="bin-items-container" id="bin-${cat.name}"></div>
              </div>
            `;
        });
        html += `</div>`;
        html += `<div class="category-game-container" style="flex-wrap:wrap;" id="cat-items-container">`;
        const shuffledFinal = shuffle(chosenItems);
        shuffledFinal.forEach(obj=>{
            html += `
              <div class="category-item"
                   data-emoji="${obj.emoji}"
                   data-cat="${obj.category}"
                   onclick="selectCategoryItem(this)">
                ${obj.emoji}
              </div>
            `;
        });
        html += `</div>`;
        content.innerHTML = "<h2>Classifique os itens em suas categorias:</h2>" + html;
        const totalCorrect = chosenItems.length;
        window.categoryGameState = {
            totalItems: totalCorrect,
            correct:0,
            selectedItem:null,
            selectedElement:null
        };
        speak("Toque em um item e depois na categoria correta");
    }
    function selectCategoryItem(el){
        if(locked) return;
        if(window.categoryGameState.selectedElement){
            window.categoryGameState.selectedElement.classList.remove("selected");
            window.categoryGameState.selectedElement.style.opacity="1";
        }
        window.categoryGameState.selectedItem={
            emoji: el.getAttribute("data-emoji"),
            category: el.getAttribute("data-cat")
        };
        window.categoryGameState.selectedElement=el;
        el.classList.add("selected");
        el.style.opacity="0.5";
    }
    function placeInCategory(binEl, targetCategory) {
        if (locked) return;
        const selItem = window.categoryGameState.selectedItem;
        const selEl   = window.categoryGameState.selectedElement;
        if (!selItem) return;
        if (selItem.category === targetCategory) {
            binEl.classList.add("category-matched");
            const filledCount = parseInt(binEl.getAttribute("data-filled")) + 1;
            binEl.setAttribute("data-filled", filledCount);
            const binContainer = binEl.querySelector(".bin-items-container");
            const newEmojiDiv = document.createElement("div");
            newEmojiDiv.style.fontSize = "1.2rem";
            newEmojiDiv.textContent = selItem.emoji;
            binContainer.appendChild(newEmojiDiv);
            selEl.style.display = "none";
            window.categoryGameState.correct++;
            showFeedback("Correto!", true);
            speak(`Muito bem! ${selItem.emoji} √© da categoria ${targetCategory}`);

            /* NOVO: A CADA ACERTO GANHAR 1 ESTRELA */
            updateStars(1);

        } else {
            binEl.classList.add("category-wrong");
            setTimeout(() => binEl.classList.remove("category-wrong"), 800);
            showFeedback("Categoria incorreta!", false);
            speak("Essa n√£o √© a categoria certa");
            updateStars(-1);
        }
        if (selEl) {
            selEl.classList.remove("selected");
            selEl.style.opacity = "1";
        }
        window.categoryGameState.selectedItem = null;
        window.categoryGameState.selectedElement = null;
        if (window.categoryGameState.correct === window.categoryGameState.totalItems) {
            showFeedback("Categorias completadas!", true);
            updateStars(1);
            locked = true;
            setTimeout(() => {
                scheduleReplayGame("categories");
            }, 1200);
        }
    }

    const readingWords = [
        { word:"barata",   syllables:["ba","ra","ta"] },
        { word:"banana",   syllables:["ba","na","na"] },
        { word:"pipoca",   syllables:["pi","po","ca"] },
        { word:"macaco",   syllables:["ma","ca","co"] },
        { word:"cavalo",   syllables:["ca","va","lo"] },
        { word:"tartaruga",syllables:["tar","ta","ru","ga"] },
        { word:"amigo",    syllables:["a","mi","go"] },
        { word:"arara",    syllables:["a","ra","ra"] },
        { word:"batata",   syllables:["ba","ta","ta"] },
        { word:"girafa",   syllables:["gi","ra","fa"] },
        { word:"cachorro", syllables:["ca","cho","rro"] }
    ];
    function initReadingGame(){
        const content = document.getElementById("content");
        content.innerHTML=`
          <h2 class="reading-title">Toque para formar a palavra!</h2>
          <div id="reading-result" class="reading-result"></div>
          <div id="reading-syllables" class="reading-word-box"></div>
        `;
        let randomWord = shuffle(readingWords)[0];
        while(randomWord.word===lastReadingWord?.word){
            randomWord = shuffle(readingWords)[0];
        }
        lastReadingWord = randomWord;
        const originalSyllables = [...randomWord.syllables];
        const scrambled = shuffle([...randomWord.syllables]);
        window.readingGameState={
            originalWord: randomWord.word,
            syllables: originalSyllables,
            userIndex:0
        };
        const resultContainer = document.getElementById("reading-result");
        originalSyllables.forEach((_,idx)=>{
            const span = document.createElement("div");
            span.className="reading-result-syllable";
            span.id=`result-syllable-${idx}`;
            resultContainer.appendChild(span);
        });
        const syllablesContainer = document.getElementById("reading-syllables");
        scrambled.forEach(syl=>{
            const div = document.createElement("div");
            div.className="reading-syllable";
            div.textContent=syl;
            div.onclick=()=>{
                if(locked) return;
                handleReadingTap(div);
            };
            syllablesContainer.appendChild(div);
        });
        speak(`Forme a palavra ${randomWord.word.toUpperCase()}. Toque nas s√≠labas na ordem correta.`);
    }
    function handleReadingTap(el){
        const state = window.readingGameState;
        const nextNeeded = state.syllables[state.userIndex];
        const tapped = el.textContent;
        if(tapped===nextNeeded){
            const slot = document.getElementById(`result-syllable-${state.userIndex}`);
            slot.textContent = tapped;
            slot.style.backgroundColor="#c8e6c9";
            slot.style.borderColor="#4caf50";
            el.style.visibility="hidden";
            speak(tapped);
            state.userIndex++;
            if(state.userIndex===state.syllables.length){
                locked=true;
                showFeedback(`Voc√™ formou "${state.originalWord.toUpperCase()}"!`, true);
                updateStars(1);
                scheduleReplayGame("reading");
            }
        } else {
            showFeedback("S√≠laba errada, tente novamente!", false);
            speak("N√£o √© essa s√≠laba");
            updateStars(-1);
        }
    }

    function initPalworldGame(){
        const content = document.getElementById("content");
        content.innerHTML="<h2>Encontre a primeira letra do Pal:</h2>";
        let availablePals = palworldData;
        if(lastPalworld){
            availablePals = palworldData.filter(p => p.name !== lastPalworld);
        }
        let randomPal = shuffle(availablePals)[0];
        lastPalworld = randomPal.name;
        content.innerHTML+=`
          <div class="pal-list">
            <div class="pal-item">
              <img src="${randomPal.img}" alt="${randomPal.name}" />
              <div class="pal-name">${randomPal.name}</div>
            </div>
          </div>
          <div class="letters-options" id="letters-options"></div>
        `;
        const correctLetter = randomPal.name[0].toUpperCase();
        const allLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
        const options = shuffle([
            correctLetter,
            ...shuffle(allLetters.filter(l=>l!==correctLetter)).slice(0,5)
        ]);
        const lettersBox = document.getElementById("letters-options");
        options.forEach(letter=>{
            const div = document.createElement("div");
            div.className="letter-choice";
            div.textContent=letter;
            div.onclick=()=>{
                if(locked) return;
                checkPalworldLetter(letter,correctLetter);
            };
            lettersBox.appendChild(div);
        });
        speak(`Qual a primeira letra de ${randomPal.name}?`);
    }
    function checkPalworldLetter(letter, correct){
        locked=true;
        if(letter===correct){
            updateStars(1);
            showFeedback("Certo!", true);
            scheduleReplayGame("palworld");
        } else {
            updateStars(-1);
            showFeedback("Letra errada!", false);
            speak(`A primeira letra √© ${correct}`);
            locked=false;
        }
    }

    function initPokemonGame(){
        const content = document.getElementById("content");
        content.innerHTML="<h2>Encontre a primeira letra do Pokemon:</h2>";
        const randomPoke = shuffle(pokemonData)[0];
        content.innerHTML+=`
          <div class="pokemon-list">
            <div class="pokemon-item">
              <img src="${randomPoke.img}" alt="${randomPoke.name}" />
              <div class="pokemon-name">${randomPoke.name}</div>
            </div>
          </div>
          <div class="letters-options" id="pokemon-letters-options"></div>
        `;
        const correctLetter = randomPoke.name[0].toUpperCase();
        const allLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
        const options = shuffle([
            correctLetter,
            ...shuffle(allLetters.filter(l=>l!==correctLetter)).slice(0,5)
        ]);
        const lettersBox = document.getElementById("pokemon-letters-options");
        options.forEach(letter=>{
            const div = document.createElement("div");
            div.className="letter-choice";
            div.textContent=letter;
            div.onclick=()=>{
                if(locked) return;
                checkPokemonLetter(letter,correctLetter);
            };
            lettersBox.appendChild(div);
        });
        speak(`Qual a primeira letra de ${randomPoke.name}?`);
    }
    function checkPokemonLetter(letter, correct){
        locked=true;
        if(letter===correct){
            updateStars(1);
            showFeedback("Certo!", true);
            scheduleReplayGame("pokemon");
        } else {
            updateStars(-1);
            showFeedback("Letra errada!", false);
            speak(`A primeira letra √© ${correct}`);
            locked=false;
        }
    }

    function randomInt(min, max){
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    function initPokemonBattleGame(){
        const content = document.getElementById("content");
        content.innerHTML="<h2>Escolha o Pok√©mon que possui poder de defesa menor que o poder de luta do Pok√©mon do topo:</h2>";

        const topPokemon = pokemonData[Math.floor(Math.random() * pokemonData.length)];
        const topFight = randomInt(20, 200);
        const topDefense = randomInt(20, 200);

        content.innerHTML += `
          <div class="pokemon-battle-top">
            <img src="${topPokemon.img}" alt="${topPokemon.name}" />
            <div class="pokemon-battle-name">${topPokemon.name}</div>
            <div class="pokemon-battle-stats">‚öîÔ∏è ${topFight}</div>
          </div>
        `;

        let correctPokemon = null;
        do {
            correctPokemon = pokemonData[Math.floor(Math.random()*pokemonData.length)];
        } while(correctPokemon.name === topPokemon.name);

        let correctDefense = randomInt(20,200);
        while(!(correctDefense < topFight)) {
            correctDefense = randomInt(20,200);
        }
        let correctFight = randomInt(20,200);

        const incorrectList = [];
        while(incorrectList.length < 4){
            let candidate = pokemonData[Math.floor(Math.random()*pokemonData.length)];
            if(candidate.name !== topPokemon.name && candidate.name !== correctPokemon.name){
                const candDef = randomInt(20,200);
                if(candDef >= topFight){
                    incorrectList.push({
                        name: candidate.name,
                        img: candidate.img,
                        fight: randomInt(20,200),
                        defense: candDef
                    });
                }
            }
        }

        const correctChoice = {
            name: correctPokemon.name,
            img: correctPokemon.img,
            fight: correctFight,
            defense: correctDefense
        };

        const finalList = [ correctChoice, ...incorrectList ];
        const finalShuffled = shuffle(finalList);

        content.innerHTML += `<div class="pokemon-battle-list" id="pokemonBattleList"></div>`;
        const listEl = document.getElementById("pokemonBattleList");
        finalShuffled.forEach(p => {
            const item = document.createElement("div");
            item.className = "pokemon-battle-item";
            item.innerHTML = `
              <img src="${p.img}" alt="${p.name}" />
              <div class="pokemon-battle-name">${p.name}</div>
              <div class="pokemon-battle-stats">üõ°Ô∏è ${p.defense}</div>
            `;
            item.onclick = () => {
                if(locked) return;
                handlePokemonBattleChoice(p, topFight);
            };
            listEl.appendChild(item);
        });

        speak(`O poder de luta de ${topPokemon.name} √© ${topFight}. Selecione um Pok√©mon que tenha poder de defesa menor que ${topFight}.`);
    }

    function handlePokemonBattleChoice(p, topFight){
        locked = true;
        if(p.defense < topFight){
            updateStars(1);
            showFeedback("Certo!", true);
            scheduleReplayGame("pokemonBattle");
        } else {
            updateStars(-1);
            showFeedback("Errado!", false);
            speak("Esse Pok√©mon n√£o tem defesa menor. Tente novamente!");
            locked = false;
        }
    }

    /* ARRAY COM PARES DE ANIMAIS E HABITATS */
    const habitatPairsData = [
        { animal: "Abelha",  animalImg: "üêù", habitat: "Colm√©ia",   habitatImg: "üçØ"    },
        { animal: "Peixe",   animalImg: "üêü", habitat: "Rio",       habitatImg: "üåä"    },
        { animal: "Cachorro",animalImg: "üê∂", habitat: "Casinha",   habitatImg: "üè†"    },
        { animal: "Aranha",  animalImg: "üï∑", habitat: "Teia",      habitatImg: "üï∏"    },
        { animal: "Coelho",  animalImg: "üê∞", habitat: "Toca",      habitatImg: "üï≥"    },
        { animal: "Cavalo",  animalImg: "üê¥", habitat: "Est√°bulo",  habitatImg: "üêéüè†"   },
        { animal: "Galinha", animalImg: "üêî", habitat: "Galinheiro",habitatImg: "ü™∫"    },
        { animal: "Gato",    animalImg: "üê±", habitat: "Sof√°",      habitatImg: "üõã"    },
        { animal: "Formiga", animalImg: "üêú", habitat: "Formigueiro",habitatImg:"üêúüè†"  },
        { animal: "Caracol", animalImg: "üêå", habitat: "Concha",    habitatImg: "üêö"    },
        { animal: "P√°ssaro", animalImg: "üê¶", habitat: "Ninho",     habitatImg: "ü™π"    },
        { animal: "Vaca",    animalImg: "üêÆ", habitat: "Curral",    habitatImg: "üêÑüè†"   }
    ];

    /* Para evitar repetir exatamente a mesma sele√ß√£o de pares em sequ√™ncia */
    let lastHabitatSet = null;

    /* Fun√ß√£o principal do jogo de Habitats */
    function initHabitatGame() {
        locked = false;
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Combine o animal com seu habitat:</h2>";

        // Embaralha todos os pares e pega 5 (ajuste conforme desejar)
        let shuffled = shuffle([...habitatPairsData]);
        let selectedPairs = shuffled.slice(0, 5);

        // Se for igual ao √∫ltimo sorteio, embaralha de novo
        if (JSON.stringify(selectedPairs) === JSON.stringify(lastHabitatSet)) {
            shuffled = shuffle([...habitatPairsData]);
            selectedPairs = shuffled.slice(0, 5);
        }
        lastHabitatSet = selectedPairs;

        // Atribui um ID interno para cada par, assim podemos identificar corretamente mesmo ap√≥s shuffle
        selectedPairs.forEach((pair, i) => {
            pair.__id = i; // um √≠ndice de 0 a 4, por exemplo
        });

        // Salva no estado global
        window.habitatGameState = {
            pairs: selectedPairs,
            selected: null,       // quem est√° selecionado
            correctMatches: 0,    // quantos pares corretos j√° foram encontrados
            total: selectedPairs.length
        };

        // Monta o layout: esquerda (animais) e direita (habitats)
        // - N√£o shuffle na esquerda, mas shuffle na direita para a crian√ßa n√£o ver a mesma ordem
        const leftColumnHTML = selectedPairs.map(pair => `
      <div class="habitat-item"
           style="border:2px solid #000; border-radius:8px; background:#fff9c4; padding:8px; text-align:center; cursor:pointer; transition:0.2s;"
           onclick="handleHabitatClick(this, 'animal', ${pair.__id})"
           data-habitat="${pair.habitat}">
        <div style="font-size:2rem;">${pair.animalImg}</div>
        <div style="font-size:0.9rem; margin-top:4px;">${pair.animal}</div>
      </div>
    `).join("");

        // Coluna da direita: habitats embaralhados, mas cada elemento mant√©m o mesmo __id do seu par
        const rightColumnHTML = shuffle([...selectedPairs]).map(pair => `
      <div class="habitat-item"
           style="border:2px solid #000; border-radius:8px; background:#c8e6c9; padding:8px; text-align:center; cursor:pointer; transition:0.2s;"
           onclick="handleHabitatClick(this, 'habitat', ${pair.__id})"
           data-habitat="${pair.habitat}">
        <div style="font-size:2rem;">${pair.habitatImg}</div>
        <div style="font-size:0.9rem; margin-top:4px;">${pair.habitat}</div>
      </div>
    `).join("");

        // Renderiza as duas colunas
        content.innerHTML += `
      <div style="display:flex; flex-direction:row; gap:10px; justify-content:center; align-items:flex-start; flex-wrap:wrap; width:100%;">
        <!-- Coluna da Esquerda (Animais) -->
        <div style="flex:1; max-width:200px; display:flex; flex-direction:column; gap:10px; margin:0 auto;">
          ${leftColumnHTML}
        </div>
        <!-- Coluna da Direita (Habitats) -->
        <div style="flex:1; max-width:200px; display:flex; flex-direction:column; gap:10px; margin:0 auto;">
          ${rightColumnHTML}
        </div>
      </div>
    `;

        speak("Selecione primeiro o animal ou seu habitat e depois toque no par correspondente.");
    }

    /* Fun√ß√£o de clique nos elementos (animais ou habitats) */
    function handleHabitatClick(el, type, pairId) {
        if (locked) return;
        const state = window.habitatGameState;

        // Se n√£o h√° nenhum selecionado
        if (!state.selected) {
            state.selected = { element: el, type, pairId };
            el.classList.add("selected");
            return;
        }

        // Se clicou no mesmo elemento, des-seleciona
        if (state.selected.element === el) {
            el.classList.remove("selected");
            state.selected = null;
            return;
        }

        // J√° existe um selecionado e clicamos em outro
        const pair1 = state.selected;             // { element, type, pairId }
        const pair2 = { element: el, type, pairId };

        // Verifica se √© um match
        const isMatch = checkHabitatMatch(pair1, pair2, state);

        if (isMatch) {
            // Marcar como correto
            pair1.element.classList.remove("selected");
            pair2.element.classList.remove("selected");
            pair1.element.classList.add("shadow-match");
            pair2.element.classList.add("shadow-match");
            showFeedback("Correto!", true);
            speak("Muito bem!");

            state.correctMatches++;
            updateStars(1);

            // Se completou todos
            if (state.correctMatches === state.total) {
                locked = true;
                showFeedback("Voc√™ combinou todos os animais e habitats!", true);
                scheduleReplayGame("habitat");
            }
        } else {
            // Resposta errada
            pair1.element.classList.add("shadow-mismatch");
            pair2.element.classList.add("shadow-mismatch");
            showFeedback("N√£o √© o par certo!", false);
            speak("Ops! Tente novamente.");
            updateStars(-1);

            setTimeout(() => {
                pair1.element.classList.remove("shadow-mismatch", "selected");
                pair2.element.classList.remove("shadow-mismatch", "selected");
            }, 700);
        }

        // Limpa a sele√ß√£o
        state.selected = null;
    }

    /* Verifica se os dois cliques formam um par correto */
    function checkHabitatMatch(sel1, sel2, state) {
        // Precisamos que sejam tipos diferentes (animal/habitat)
        if (sel1.type === sel2.type) {
            return false;
        }

        // Pega o "par" da lista principal pelo pairId
        const pair1Obj = state.pairs[sel1.pairId]; // ex: {animal:"Cavalo", habitat:"Est√°bulo", ...}
        const pair2Obj = state.pairs[sel2.pairId];

        // Se "sel1" √© animal e "sel2" √© habitat, ent√£o checamos se pair1Obj e pair2Obj s√£o o mesmo par
        if (sel1.type === "animal" && sel2.type === "habitat") {
            // Precisamos que sel1.pairId === sel2.pairId, ou seja, ambos apontam pro MESMO item do array
            // E tamb√©m podemos checar se habitat bate com data-habitat
            return (sel1.pairId === sel2.pairId);
        }

        // Caso contr√°rio, se "sel1" √© habitat e "sel2" √© animal
        if (sel1.type === "habitat" && sel2.type === "animal") {
            return (sel1.pairId === sel2.pairId);
        }

        return false;
    }

    const combosData = [
        {
            itemA: "Menino",
            itemAImg: "üë¶",
            itemB: "Bon√©",
            itemBImg: "üß¢"
        },
        {
            itemA: "Menina",
            itemAImg: "üëß",
            itemB: "La√ßo",
            itemBImg: "üéÄ"
        },
        {
            itemA: "Flor",
            itemAImg: "üå∑",
            itemB: "Vaso",
            itemBImg: "üè∫"
        },
        {
            itemA: "Passarinho",
            itemAImg: "üê¶",
            itemB: "Gaiola",
            itemBImg: "ü¶úüè†"
        },
        {
            itemA: "Peixe",
            itemAImg: "üêü",
            itemB: "Aqu√°rio",
            itemBImg: "üêüüè†"
        },
        {
            itemA: "Caf√©",
            itemAImg: "‚òï",
            itemB: "X√≠cara",
            itemBImg: "üçµ"
        },
        {
            itemA: "Pincel",
            itemAImg: "üñåÔ∏è",
            itemB: "Tinta",
            itemBImg: "üé®"
        },
        {
            itemA: "Bola",
            itemAImg: "‚öΩ",
            itemB: "Gol",
            itemBImg: "ü•Ö"
        },
        {
            itemA: "Livro",
            itemAImg: "üìñ",
            itemB: "Estante",
            itemBImg: "ü™ë"
        },
        {
            itemA: "Sapato",
            itemAImg: "üëü",
            itemB: "P√©",
            itemBImg: "ü¶∂"
        },
        {
            itemA: "Celular",
            itemAImg: "üì±",
            itemB: "Carregador",
            itemBImg: "üîå"
        },
        {
            itemA: "Chave",
            itemAImg: "üîë",
            itemB: "Fechadura",
            itemBImg: "üö™"
        }
    ];

    /* Para evitar repetir o mesmo conjunto de combina√ß√µes em sequ√™ncia */
    let lastCombosSet = null;

    /* Fun√ß√£o principal para iniciar o jogo de Combina√ß√µes */
    function initCombosGame() {
        locked = false;
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Combine os itens corretos:</h2>";

        // Embaralha o array e seleciona 5 combina√ß√µes
        let shuffled = shuffle([...combosData]);
        let selected = shuffled.slice(0, 5);

        // Evita sortear o mesmo conjunto de 5 logo em seguida
        if (JSON.stringify(selected) === JSON.stringify(lastCombosSet)) {
            shuffled = shuffle([...combosData]);
            selected = shuffled.slice(0, 5);
        }
        lastCombosSet = selected;

        // Atribui um ID interno para cada par
        selected.forEach((pair, i) => {
            pair.__id = i;
        });

        // Armazena estado
        window.combosGameState = {
            pairs: selected,
            selected: null,
            correctMatches: 0,
            total: selected.length
        };

        /*
         * Monta layout:
         * - Coluna esquerda: itemA (n√£o embaralha)
         * - Coluna direita: itemB (embaralha)
         */
        const leftColumnHTML = selected.map(pair => `
    <div class="combos-item"
         style="border:2px solid #000; border-radius:8px; background:#fff9c4; padding:8px; text-align:center; cursor:pointer;"
         onclick="handleCombosClick(this, 'itemA', ${pair.__id})">
      <div style="font-size:2rem;">${pair.itemAImg}</div>
      <div style="font-size:0.9rem; margin-top:4px;">${pair.itemA}</div>
    </div>
  `).join("");

        const rightColumnHTML = shuffle([...selected]).map(pair => `
    <div class="combos-item"
         style="border:2px solid #000; border-radius:8px; background:#c8e6c9; padding:8px; text-align:center; cursor:pointer;"
         onclick="handleCombosClick(this, 'itemB', ${pair.__id})">
      <div style="font-size:2rem;">${pair.itemBImg}</div>
      <div style="font-size:0.9rem; margin-top:4px;">${pair.itemB}</div>
    </div>
  `).join("");

        content.innerHTML += `
    <div style="display:flex; flex-direction:row; gap:10px; justify-content:center; align-items:flex-start; flex-wrap:wrap; width:100%;">
      <div style="flex:1; max-width:200px; display:flex; flex-direction:column; gap:10px; margin:0 auto;">
        ${leftColumnHTML}
      </div>
      <div style="flex:1; max-width:200px; display:flex; flex-direction:column; gap:10px; margin:0 auto;">
        ${rightColumnHTML}
      </div>
    </div>
  `;

        speak("Toque em um item e depois no outro que faz par com ele.");
    }

    /* Clique em cada lado (itemA ou itemB) */
    function handleCombosClick(el, type, pairId) {
        if (locked) return;

        const state = window.combosGameState;

        // Se nada est√° selecionado
        if (!state.selected) {
            state.selected = { element: el, type, pairId };
            el.classList.add("selected");
            return;
        }

        // Se clicou no mesmo elemento, des-seleciona
        if (state.selected.element === el) {
            el.classList.remove("selected");
            state.selected = null;
            return;
        }

        // Temos um selecionado e clicamos em outro
        const sel1 = state.selected;
        const sel2 = { element: el, type, pairId };

        const isMatch = checkCombosMatch(sel1, sel2, state);

        if (isMatch) {
            sel1.element.classList.remove("selected");
            sel2.element.classList.remove("selected");
            sel1.element.classList.add("shadow-match");
            sel2.element.classList.add("shadow-match");
            showFeedback("Correto!", true);
            speak("Muito bem!");
            state.correctMatches++;
            updateStars(1);

            if (state.correctMatches === state.total) {
                locked = true;
                showFeedback("Voc√™ acertou todos os pares!", true);
                scheduleReplayGame("combos");
            }
        } else {
            sel1.element.classList.add("shadow-mismatch");
            sel2.element.classList.add("shadow-mismatch");
            showFeedback("N√£o combinam!", false);
            speak("N√£o √© o par certo. Tente novamente.");
            updateStars(-1);

            setTimeout(() => {
                sel1.element.classList.remove("shadow-mismatch", "selected");
                sel2.element.classList.remove("shadow-mismatch", "selected");
            }, 700);
        }

        state.selected = null;
    }

    /* Verifica se dois cliques formam um par correto */
    function checkCombosMatch(a, b, state) {
        // Precisam ser tipos diferentes (itemA e itemB)
        if (a.type === b.type) return false;
        // Verifica se apontam para o mesmo pairId
        return (a.pairId === b.pairId);
    }

    /* Guardar o √∫ltimo conjunto sorteado para n√£o repetir imediatamente */
    let lastArmsSet = null;

    /* Fun√ß√£o principal do jogo de Bra√ßos */
    function initArmsGame() {
        locked = false;
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Combine a crian√ßa com a posi√ß√£o correspondente dos bra√ßos:</h2>";

        // Embaralha e pega 5 (ou ajuste conforme desejar)
        let shuffled = shuffle([...armsData]);
        let selected = shuffled.slice(0, 5);

        // Evita repetir o mesmo conjunto
        if (JSON.stringify(selected) === JSON.stringify(lastArmsSet)) {
            shuffled = shuffle([...armsData]);
            selected = shuffled.slice(0, 5);
        }
        lastArmsSet = selected;

        // Define um ID interno para cada item
        selected.forEach((pose, i) => {
            pose.__id = i;
        });

        // Guarda estado do jogo
        window.armsGameState = {
            pairs: selected,
            selected: null,
            correctMatches: 0,
            total: selected.length
        };

        // Coluna da esquerda (a crian√ßa), sem embaralhar
        const leftColumnHTML = selected.map(pose => `
    <div class="arms-item"
         style="border:2px solid #000; border-radius:8px; background:#fff9c4; padding:8px; text-align:center; cursor:pointer;"
         onclick="handleArmsClick(this, 'child', ${pose.__id})">
      <div>
        <img src="${pose.childImg}" alt="Crian√ßa" style="max-width:100%; height:auto; border-radius:5px;" />
      </div>
      <div style="font-size:0.9rem; margin-top:4px;">
        ${pose.childDesc}
      </div>
    </div>
  `).join("");

        // Coluna da direita (posi√ß√£o correspondente), embaralhada
        const rightColumnHTML = shuffle([...selected]).map(pose => `
    <div class="arms-item"
         style="border:2px solid #000; border-radius:8px; background:#c8e6c9; padding:8px; text-align:center; cursor:pointer;"
         onclick="handleArmsClick(this, 'position', ${pose.__id})">
      <div>
        <img src="${pose.positionImg}" alt="Posi√ß√£o" style="max-width:100%; height:auto; border-radius:5px;" />
      </div>
      <div style="font-size:0.9rem; margin-top:4px;">
        ${pose.positionName}
      </div>
    </div>
  `).join("");

        // Monta a UI
        content.innerHTML += `
    <div style="display:flex; flex-direction:row; gap:10px; justify-content:center; align-items:flex-start; flex-wrap:wrap; width:100%;">
      <!-- Coluna da Esquerda -->
      <div style="flex:1; max-width:220px; display:flex; flex-direction:column; gap:10px; margin:0 auto;">
        ${leftColumnHTML}
      </div>
      <!-- Coluna da Direita -->
      <div style="flex:1; max-width:220px; display:flex; flex-direction:column; gap:10px; margin:0 auto;">
        ${rightColumnHTML}
      </div>
    </div>
  `;

        speak("Escolha a crian√ßa e depois a posi√ß√£o dos bra√ßos que corresponde.");
    }

    /* Clique nos itens (lado esquerdo = 'child', lado direito = 'position') */
    function handleArmsClick(el, type, pairId) {
        if (locked) return;

        const state = window.armsGameState;

        // Se nada est√° selecionado ainda
        if (!state.selected) {
            state.selected = { element: el, type, pairId };
            el.classList.add("selected");
            return;
        }

        // Se clicou no mesmo elemento, des-seleciona
        if (state.selected.element === el) {
            el.classList.remove("selected");
            state.selected = null;
            return;
        }

        // J√° temos um selecionado e clicamos em outro
        const sel1 = state.selected;
        const sel2 = { element: el, type, pairId };

        // Verifica se √© um par
        const isMatch = checkArmsMatch(sel1, sel2, state);

        if (isMatch) {
            sel1.element.classList.remove("selected");
            sel2.element.classList.remove("selected");
            sel1.element.classList.add("shadow-match");
            sel2.element.classList.add("shadow-match");
            showFeedback("Correto!", true);
            speak("Muito bem!");
            state.correctMatches++;
            updateStars(1);

            if (state.correctMatches === state.total) {
                locked = true;
                showFeedback("Voc√™ encontrou todos os pares!", true);
                scheduleReplayGame("arms");
            }
        } else {
            sel1.element.classList.add("shadow-mismatch");
            sel2.element.classList.add("shadow-mismatch");
            showFeedback("N√£o √© o par certo!", false);
            speak("Tente novamente.");
            updateStars(-1);

            setTimeout(() => {
                sel1.element.classList.remove("shadow-mismatch", "selected");
                sel2.element.classList.remove("shadow-mismatch", "selected");
            }, 700);
        }

        state.selected = null;
    }

    /* Verifica se formam o par v√°lido */
    function checkArmsMatch(a, b, state) {
        // Precisamos que um seja 'child' e o outro 'position'
        if (a.type === b.type) return false;
        // Precisam ter o mesmo __id
        return (a.pairId === b.pairId);
    }

    /* Vari√°vel para guardar o √∫ltimo conjunto sorteado e evitar repeti√ß√£o */
    let lastFarmSet = null;

    /* Fun√ß√£o principal do jogo de Fazendinha */
    function initLitleFarmGame() {
        locked = false;
        const content = document.getElementById("content");
        content.innerHTML = "<h2>Combine as imagens iguais da fazendinha:</h2>";

        // Embaralha o array e seleciona 5 pares (voc√™ pode alterar para 6, 7, etc.)
        let shuffled = shuffle([...litleFarmData]);
        let selected = shuffled.slice(0, 5);

        // Evita repetir o mesmo conjunto
        if (JSON.stringify(selected) === JSON.stringify(lastFarmSet)) {
            shuffled = shuffle([...litleFarmData]);
            selected = shuffled.slice(0, 5);
        }
        lastFarmSet = selected;

        // Atribui um ID interno para cada par
        selected.forEach((item, i) => {
            item.__id = i;
        });

        // Estado do jogo
        window.litleFarmGameState = {
            pairs: selected,
            selected: null,
            correctMatches: 0,
            total: selected.length
        };

        /*
         * Criamos duas colunas:
         *   - Esquerda: childImg (sem embaralhar)
         *   - Direita: positionImg (embaralhada)
         */
        const leftColumnHTML = selected.map(item => `
    <div class="farm-item"
         style="border:2px solid #000; border-radius:8px; background:#fff9c4; padding:8px; text-align:center; cursor:pointer;"
         onclick="handleFarmClick(this, 'child', ${item.__id})">
      <img src="${item.childImg}" alt="Fazendinha" style="max-width:100%; height:auto; border-radius:5px;" />
    </div>
  `).join("");

        const rightColumnHTML = shuffle([...selected]).map(item => `
    <div class="farm-item"
         style="border:2px solid #000; border-radius:8px; background:#c8e6c9; padding:8px; text-align:center; cursor:pointer;"
         onclick="handleFarmClick(this, 'position', ${item.__id})">
      <img src="${item.positionImg}" alt="Fazendinha" style="max-width:100%; height:auto; border-radius:5px;" />
    </div>
  `).join("");

        // Renderiza
        content.innerHTML += `
    <div style="display:flex; flex-direction:row; gap:10px; justify-content:center; align-items:flex-start; flex-wrap:wrap; width:100%;">
      <div style="flex:1; max-width:220px; display:flex; flex-direction:column; gap:10px; margin:0 auto;">
        ${leftColumnHTML}
      </div>
      <div style="flex:1; max-width:220px; display:flex; flex-direction:column; gap:10px; margin:0 auto;">
        ${rightColumnHTML}
      </div>
    </div>
  `;

        speak("Selecione a imagem da fazendinha e depois a correspondente.");
    }

    /* Fun√ß√£o de clique nos itens (lado esquerdo = 'child', lado direito = 'position') */
    function handleFarmClick(el, type, pairId) {
        if (locked) return;

        const state = window.litleFarmGameState;

        // Se n√£o h√° nada selecionado
        if (!state.selected) {
            state.selected = { element: el, type, pairId };
            el.classList.add("selected");
            return;
        }

        // Se clicou no mesmo elemento, des-seleciona
        if (state.selected.element === el) {
            el.classList.remove("selected");
            state.selected = null;
            return;
        }

        // J√° temos um selecionado, ent√£o comparamos com o atual
        const sel1 = state.selected;
        const sel2 = { element: el, type, pairId };

        const isMatch = checkFarmMatch(sel1, sel2, state);

        if (isMatch) {
            sel1.element.classList.remove("selected");
            sel2.element.classList.remove("selected");
            sel1.element.classList.add("shadow-match");
            sel2.element.classList.add("shadow-match");
            showFeedback("Correto!", true);
            speak("Muito bem!");
            state.correctMatches++;
            updateStars(1);

            // Se completou todos
            if (state.correctMatches === state.total) {
                locked = true;
                showFeedback("Parab√©ns, voc√™ encontrou todas as combina√ß√µes!", true);
                scheduleReplayGame("litleFarm");
            }
        } else {
            // Se n√£o corresponde
            sel1.element.classList.add("shadow-mismatch");
            sel2.element.classList.add("shadow-mismatch");
            showFeedback("N√£o √© o par certo!", false);
            speak("Tente novamente.");
            updateStars(-1);

            setTimeout(() => {
                sel1.element.classList.remove("shadow-mismatch", "selected");
                sel2.element.classList.remove("shadow-mismatch", "selected");
            }, 700);
        }

        // Limpa a sele√ß√£o
        state.selected = null;
    }

    /* Verifica se formam o par v√°lido */
    function checkFarmMatch(a, b, state) {
        // Precisamos que um seja 'child' e o outro 'position'
        if (a.type === b.type) return false;
        // Precisam ter o mesmo __id
        return (a.pairId === b.pairId);
    }

    function speak(text){
        if(speechSynth.speaking) speechSynth.cancel();
        const utt = new SpeechSynthesisUtterance(text);
        utt.lang="pt-BR";
        utt.rate=0.9;
        speechSynth.speak(utt);
    }
    function shuffle(arr){
        return arr.sort(()=>Math.random()-0.5);
    }
    function showFeedback(msg, isCorrect){
        const fdb = document.getElementById("feedback");
        fdb.textContent=msg;
        fdb.style.color= isCorrect ? "#2E7D32" : "#C62828";
    }
    function updateStars(change) {
        const newStars = Math.max(0, stars + change);
        if (newStars !== stars) {
            stars = newStars;
            localStorage.setItem("stars", String(stars));
            starsCountEl.textContent = stars;
            if(!gameStars[currentGame]) {
                gameStars[currentGame] = 0;
            }
            gameStars[currentGame] = Math.max(0, gameStars[currentGame] + change);
            localStorage.setItem("gameStars", JSON.stringify(gameStars));
            if (change > 0) {
                speak("Muito bem!");
                maybeGiveSticker();
            } else if (change < 0 && stars > 0) {
                speak("N√£o desista! Continue tentando!");
            }
            checkGoal();
            buildMainMenu(false);
        }
    }
    function maybeGiveSticker(){
        if(Math.floor(Math.random()*5)===0){
            const st = possibleStickers[Math.floor(Math.random()* possibleStickers.length)];
            stickerList.push(st);
            localStorage.setItem("myStickers", JSON.stringify(stickerList));
            updateStickerCount();
            createStickerFly(st.img);
        }
    }
    function createStickerFly(imgUrl){
        const stickerFlyEl = document.createElement("div");
        stickerFlyEl.className = "sticker-fly";
        const startX = window.innerWidth / 2 - 40;
        const startY = window.innerHeight / 2 - 40;
        stickerFlyEl.style.left = `${startX}px`;
        stickerFlyEl.style.top  = `${startY}px`;
        const img = document.createElement("img");
        img.src = imgUrl;
        stickerFlyEl.appendChild(img);
        document.body.appendChild(stickerFlyEl);
        stickerFlyEl.getBoundingClientRect();
        const btnRect = document.getElementById("stickers-btn").getBoundingClientRect();
        const destX = btnRect.left + (btnRect.width/2) - 40;
        const destY = btnRect.top  - 40;
        stickerFlyEl.style.transform = `translate(${destX - startX}px, ${destY - startY}px) scale(0.3)`;
        stickerFlyEl.style.opacity = "0";
        stickerFlyEl.addEventListener("transitionend", ()=>{
            if(stickerFlyEl.parentNode) {
                stickerFlyEl.parentNode.removeChild(stickerFlyEl);
            }
        });
    }
    function checkGoal(){
        if(!hasReachedGoal && savedGoal>0 && stars>=savedGoal){
            hasReachedGoal=true;
            localStorage.setItem("hasReachedGoal","true");
            trophyInfoEl.style.display="inline-block";
            showCongratsModal();
            startConfetti();
        }
    }

    function showCongratsModal(){
        const backdrop = document.getElementById("modal-backdrop");
        const modal = document.getElementById("congratsModal");
        backdrop.style.display="block";
        modal.style.display="block";
        speak("Parab√©ns! Voc√™ atingiu sua meta de estrelas!");
    }
    function continueAfterGoal(){
        stopConfetti();
        document.getElementById("modal-backdrop").style.display="none";
        document.getElementById("congratsModal").style.display="none";
    }
    function restartGame(){
        stopConfetti();
        localStorage.removeItem("stars");
        localStorage.removeItem("playerGoal");
        localStorage.removeItem("hasReachedGoal");
        localStorage.removeItem("gameStars");
        localStorage.removeItem("myStickers");
        location.reload();
    }

    function startConfetti(){
        confettiCanvas.width=window.innerWidth;
        confettiCanvas.height=window.innerHeight;
        confettiCanvas.style.display="block";
        confettiActive=true;
        const confettiPieces=[];
        for(let i=0;i<150;i++){
            confettiPieces.push({
                x: Math.random()* confettiCanvas.width,
                y: Math.random()* confettiCanvas.height,
                r: Math.random()*6+2,
                d: Math.random()+1,
                color:`hsl(${Math.floor(Math.random()*360)},100%,50%)`
            });
        }
        function drawConfetti(){
            confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
            confettiPieces.forEach(cf=>{
                confettiCtx.beginPath();
                confettiCtx.fillStyle=cf.color;
                confettiCtx.arc(cf.x, cf.y, cf.r, 0, 2*Math.PI);
                confettiCtx.fill();
            });
            updateConfetti();
            if(confettiActive) requestAnimationFrame(drawConfetti);
        }
        function updateConfetti(){
            confettiPieces.forEach(cf=>{
                cf.y += Math.cos(cf.d)+1+cf.r/2;
                cf.x += Math.sin(cf.d);
                if(cf.y>confettiCanvas.height){
                    cf.x=Math.random()* confettiCanvas.width;
                    cf.y=-10;
                }
            });
        }
        drawConfetti();
    }
    function stopConfetti(){
        confettiActive=false;
        confettiCanvas.style.display="none";
    }

    function openStickersModal(){
        const modal = document.getElementById("stickers-modal");
        const backdrop = document.getElementById("modal-backdrop");
        const container = document.getElementById("stickers-container");
        container.innerHTML="";
        stickerList.forEach(st=>{
            const div = document.createElement("div");
            div.className="sticker-item";
            const img = document.createElement("img");
            img.src=st.img;
            img.alt=st.name;
            div.appendChild(img);
            container.appendChild(div);
        });
        backdrop.style.display="block";
        modal.style.display="block";
    }
    function closeStickersModal(){
        const modal = document.getElementById("stickers-modal");
        const backdrop = document.getElementById("modal-backdrop");
        modal.style.display="none";
        backdrop.style.display="none";
    }
</script>
</body>
</html>
