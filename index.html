<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo Educativo Infantil</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #FFF3E0;
            margin-bottom: 80px;
        }

        .container {
            text-align: center;
        }
        .main-title {
            font-size: 3rem;
            font-weight: bold;
            color: #ff5722;
            margin: 40px 0 20px;
        }
        #start-menu {
            display: none;
            margin-top: 30px;
        }
        .start-menu-btn {
            width: 250px;
            display: inline-block;
            margin: 20px auto;
        }
        .start-menu-input {
            font-size: 24px;
            border-radius: 8px;
            border: 2px solid #ccc;
            padding: 8px 10px;
            width: 300px;
            max-width: 80%;
            text-align: center;
            margin-bottom: 20px;
        }
        button {
            font-size: 24px;
            padding: 15px 30px;
            margin: 15px;
            border-radius: 15px;
            background-color: #4CAF50;
            border: none;
            color: white;
            cursor: pointer;
        }

        .feedback {
            font-size: 1.5rem;
            margin: 1rem 0;
            min-height: 60px;
        }

        .game-mode {
            background-color: #81d4fa;
            border-radius: 20px;
            padding: 20px;
            margin: 10px;
            cursor: pointer;
            font-size: 1.5rem;
            transition: transform 0.2s;
            border: 3px solid #000;
        }
        .game-mode:hover {
            transform: scale(1.05);
        }

        #game-area {
            display: none;
        }

        .player-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 15px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
        }
        .player-name {
            font-size: 24px;
            color: #2e7d32;
            font-weight: bold;
            margin: 0;
        }
        .stars-info {
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .stars-info span {
            font-size: 28px;
        }

        /* Categorias */
        .category-game-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        .category-bin {
            width: 180px;
            min-height: 150px;
            border: 3px dashed #000;
            border-radius: 15px;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            gap: 10px;
            transition: background 0.3s;
        }
        .category-label {
            font-size: 1.2rem;
            font-weight: bold;
        }
        /* Ãrea onde os emojis corretos aparecerÃ£o */
        .bin-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            min-height: 50px; /* pra nÃ£o sumir visualmente */
        }

        .category-item {
            width: 80px;
            height: 80px;
            margin: 5px;
            border-radius: 10px;
            font-size: 2rem;
            border: 3px solid #000;
            background-color: #C8E6C9;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        /* Para nÃ£o desalinhar os itens quando estiver "oculto" */
        .category-item.hidden-item {
            visibility: hidden; /* esconde visual mas mantÃ©m espaÃ§o */
        }

        .category-matched {
            background-color: #C8E6C9 !important;
            border-color: #4CAF50 !important;
        }
        .category-wrong {
            background-color: #FFCDD2 !important;
            border-color: #C62828 !important;
            animation: shake 0.5s;
        }

        /* AnimaÃ§Ã£o shake */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        /* Outros jogos (apenas mantidos para contexto) */
        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            justify-items: center;
            margin-top: 20px;
        }
        .number-option {
            background-color: #C8E6C9;
            width: 100px;
            height: 100px;
            margin: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            border-radius: 15px;
            cursor: pointer;
            border: 3px solid #000;
        }
        .target-number {
            background-color: #FFD700 !important;
            color: #000;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 120px;
            height: 120px;
            border-radius: 15px;
            font-size: 2rem;
            border: 3px solid #000;
        }

        /* Jogo de Letras */
        .emoji-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        .emoji-option {
            background-color: #C8E6C9;
            width: 120px;
            height: 120px;
            margin: 10px;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            border-radius: 15px;
            cursor: pointer;
            border: 3px solid #000;
        }
        .emoji-name {
            font-size: 14px;
            margin-top: 5px;
        }

        /* Jogo de Contar */
        .counting-target {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 15px;
        }
        .count-box {
            width: 80px;
            height: 80px;
            font-size: 2rem;
            background: #FFF9C4;
            border: 3px solid #000;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .counting-game .emoji-option {
            width: 100px;
            height: 100px;
            margin: 5px;
            font-size: 40px;
        }

        /* Jogo de Palavras */
        .word-letter {
            background-color: #FFD700;
            width: 60px;
            height: 60px;
            margin: 5px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            border-radius: 10px;
            cursor: pointer;
            border: 2px solid #000;
        }
        .word-target {
            font-size: 40px;
            margin: 20px;
            color: #888;
            opacity: 0.7;
        }
        .letter-box {
            display: inline-block;
            width: 40px;
            height: 40px;
            margin: 5px;
            font-size: 24px;
            color: #666;
            border-bottom: 3px solid #999;
        }
        .revealed {
            color: #2E7D32 !important;
            border-bottom: 3px solid #2E7D32;
        }
        .scrambled-letters {
            margin: 20px;
        }

        /* Jogo das Sombras */
        .shadow-container {
            display: flex;
            justify-content: space-around;
            margin: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .shadow-item {
            width: 150px;
            height: 150px;
            margin: 10px;
            cursor: move;
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
        }
        .shadow-slot {
            width: 150px;
            height: 150px;
            margin: 10px;
            background: #E0E0E0;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            opacity: 0.3;
        }
        .shadow-match {
            background: #C8E6C9 !important;
            border: 3px solid #4CAF50 !important;
            opacity: 1 !important;
        }
        .shadow-mismatch {
            background: #FFCDD2 !important;
            border: 3px solid #C62828 !important;
            animation: shake 0.5s;
        }
        .dragging {
            opacity: 0.5;
            transform: scale(0.9);
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        /* Quebra-cabeÃ§a NumÃ©rico */
        .numbers-container,
        .quantities-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px auto;
            max-width: 800px;
        }
        .puzzle-piece {
            width: 130px;
            height: 130px;
            font-size: 30px;
            margin: 5px;
            background: #FFB74D;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }
        .puzzle-piece:hover {
            transform: scale(1.05);
        }
        .number-piece {
            font-size: 36px;
            font-weight: bold;
            background: #81D4FA;
        }
        .emoji-piece {
            background: transparent !important;
            padding: 5px;
        }
        .puzzle-emoji-grid {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 6px;
            width: 100%;
            height: 100%;
            overflow: hidden;
            padding: 5px;
        }
        .emoji-cell {
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
        }
        .puzzle-piece.selected {
            border-color: #4CAF50;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }
        .puzzle-piece.matched {
            background: #C8E6C9;
            cursor: default;
            border-color: #4CAF50;
        }
        .puzzle-piece.matched .emoji-cell {
            background: rgba(76, 175, 80, 0.1);
        }
        .puzzle-piece.wrong {
            animation: shake 0.5s;
            background: #FFCDD2;
        }
        .puzzle-piece.wrong .emoji-cell {
            background: rgba(244, 67, 54, 0.1);
        }

        /* Cores */
        .color-bin {
            width: 120px;
            height: 120px;
            margin: 10px;
            border: 3px dashed #000;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            background-color: white;
        }
        .color-bin span {
            font-size: 16px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }
        .color-item {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid #fff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .color-item:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        /* Clima */
        .weather-card {
            background: #FFF;
            padding: 20px;
            margin: 20px;
            border-radius: 15px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            display: inline-block;
            width: 250px;
        }
        .weather-items {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        .weather-item {
            font-size: 30px;
            padding: 10px;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            background: #F5F5F5;
        }
        .weather-item.selected {
            background: #C8E6C9 !important;
            transform: scale(1.1);
            border: 2px solid #4CAF50;
        }

        /* Categorias */
        .category-game-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        .category-bin {
            width: 180px;
            min-height: 150px;
            border: 3px dashed #000;
            border-radius: 15px;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            gap: 10px;
            transition: background 0.3s;
        }
        .category-label {
            font-size: 1.2rem;
            font-weight: bold;
        }
        .category-item {
            width: 80px;
            height: 80px;
            margin: 5px;
            border-radius: 10px;
            font-size: 2rem;
            border: 3px solid #000;
            background-color: #C8E6C9;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .category-matched {
            background-color: #C8E6C9 !important;
            border-color: #4CAF50 !important;
        }
        .category-wrong {
            background-color: #FFCDD2 !important;
            border-color: #C62828 !important;
            animation: shake 0.5s;
        }

        .d-none {
            display: none !important;
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">

<div class="container flex-grow-1">

    <!-- TÃ­tulo no topo para destaque, estilo "Super Mario" (inspirado) -->
    <h1 class="main-title">Vamos Aprender!</h1>

    <!-- Menu inicial -->
    <div id="start-menu">
        <div id="continue-btn-container">
            <!-- BotÃ£o de continuar (sÃ³ mostra se tiver name salvo) -->
            <button class="btn btn-primary start-menu-btn" id="continueGameBtn">
                Continuar Jogo
            </button>
        </div>
        <button class="btn btn-success start-menu-btn" id="newGameBtn">
            Novo Jogo
        </button>

        <!-- Campo para digitar nome do jogador (sÃ³ aparece ao iniciar um novo jogo) -->
        <div class="d-none" id="newGameForm">
            <p>Digite seu nome para comeÃ§ar:</p>
            <input type="text" id="playerNameInput" class="start-menu-input" />
            <br />
            <button id="startNewGameBtn" class="btn btn-warning">
                Iniciar
            </button>
        </div>
    </div>

    <!-- Info do jogador (nome e estrelas) -->
    <div class="player-info d-none" id="playerInfoContainer">
        <div class="player-name" id="player-name"></div>
        <div class="stars-info">
            <span>â­</span>
            <span id="stars-count">0</span>
        </div>
    </div>

    <!-- Menu principal de modos de jogo -->
    <div id="main-menu" class="d-none">
        <div class="row g-2">
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('numbers')">ğŸ”¢ NÃºmeros</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('letters')">ğŸ”¤ Letras</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('counting')">ğŸ Contar</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('word')">ğŸ§© Palavras</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('shadows')">ğŸ­ Sombras</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('puzzle')">ğŸ§© Quebra cabeÃ§a</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('colors')">ğŸ¨ Cores</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('weather')">â˜” Clima</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('categories')">ğŸš€ Categorias</div>
            </div>
        </div>
    </div>

    <!-- Ãrea de jogo -->
    <div id="game-area" class="d-none">
        <div id="content" class="my-4"></div>
        <div id="feedback" class="feedback text-center"></div>
        <div class="text-center my-3">
            <button class="btn btn-lg btn-primary" onclick="showMainMenu()">
                Voltar ao Menu
            </button>
        </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // LÃª dados salvos
    let savedName = localStorage.getItem('playerName') || '';
    let savedStars = parseInt(localStorage.getItem('stars') || '0', 10);

    let playerName = savedName;
    let stars = savedStars;
    let previousStars = stars;
    let currentGame = null;
    let speechSynth = window.speechSynthesis;

    // ELEMENTOS
    const startMenuEl = document.getElementById('start-menu');
    const continueBtnContainer = document.getElementById('continue-btn-container');
    const continueGameBtn = document.getElementById('continueGameBtn');
    const newGameBtn = document.getElementById('newGameBtn');
    const newGameForm = document.getElementById('newGameForm');
    const playerNameInput = document.getElementById('playerNameInput');
    const startNewGameBtn = document.getElementById('startNewGameBtn');

    const playerInfoContainer = document.getElementById('playerInfoContainer');
    const playerNameEl = document.getElementById('player-name');
    const starsCountEl = document.getElementById('stars-count');

    const mainMenuEl = document.getElementById('main-menu');
    const gameAreaEl = document.getElementById('game-area');

    // 1. Exibir a tela inicial (start-menu) ao carregar
    window.onload = function() {
        showStartMenu();
    };

    function showStartMenu() {
        // Exibe menu inicial
        startMenuEl.style.display = 'block';

        // Se nÃ£o houver name salvo, esconde o botÃ£o "Continuar"
        if (!savedName) {
            continueBtnContainer.style.display = 'none';
        } else {
            continueBtnContainer.style.display = 'block';
        }

        // Oculta o resto
        mainMenuEl.classList.add('d-none');
        playerInfoContainer.classList.add('d-none');
        gameAreaEl.classList.add('d-none');

        // Preenche o input com o nome anterior (UX)
        playerNameInput.value = savedName;
    }

    // BotÃ£o "Continuar" Jogo
    continueGameBtn.onclick = function() {
        // Reusa o nome salvo e estrelas salvas
        playerName = savedName;
        stars = savedStars;
        previousStars = stars;
        localStorage.setItem('stars', String(stars));
        localStorage.setItem('playerName', playerName);

        // Exibe o menu principal e info do jogador
        startMenuEl.style.display = 'none';
        showPlayerInfo();
        showMainMenu();
    };

    // BotÃ£o "Novo Jogo"
    newGameBtn.onclick = function() {
        // Mostra form para inserir nome
        newGameForm.classList.remove('d-none');
    };

    // BotÃ£o "Iniciar" (depois de digitar nome)
    startNewGameBtn.onclick = function() {
        const chosenName = playerNameInput.value.trim();
        if (!chosenName) {
            alert('Por favor, informe um nome para iniciar!');
            return;
        }
        // Reseta jogo e salva nome
        playerName = chosenName;
        stars = 0;
        previousStars = 0;
        savedName = playerName;
        savedStars = stars;
        localStorage.setItem('playerName', playerName);
        localStorage.setItem('stars', String(stars));

        // Fecha menu inicial e exibe o menu principal
        startMenuEl.style.display = 'none';
        showPlayerInfo();
        showMainMenu();
    };

    // Exibe o menu principal e info do jogador (pÃ³s-inÃ­cio)
    function showMainMenu() {
        gameAreaEl.classList.add('d-none');
        mainMenuEl.classList.remove('d-none');

        if(stars > previousStars) {
            speak(`${playerName}, vocÃª tem ${stars} estrelas! Muito bem!`);
            previousStars = stars;
        } else if(stars < previousStars && stars > 0) {
            speak(`${playerName}, agora vocÃª tem ${stars} estrelas. Vamos recuperar!`);
            previousStars = stars;
        }
    }

    function showPlayerInfo() {
        // Atualiza DOM com nome e estrelas
        playerInfoContainer.classList.remove('d-none');
        playerNameEl.textContent = playerName;
        starsCountEl.textContent = stars;
    }

    const numbers = Array.from({length: 20}, (_, i) => i + 1);

    const emojiDatabase = {
        "A": [
            {"emoji": "âœˆï¸", "nome": "AviÃ£o"},
            {"emoji": "ğŸŒ³", "nome": "Ãrvore"},
            {"emoji": "ğŸ¨", "nome": "Arte"},
            {"emoji": "ğŸ¹", "nome": "Arco e Flecha"},
            {"emoji": "ğŸœ", "nome": "Aranha"},
            {"emoji": "âš“", "nome": "Ã‚ncora"},
            {"emoji": "ğŸ­", "nome": "Ator"},
            {"emoji": "ğŸš‘", "nome": "AmbulÃ¢ncia"},
            {"emoji": "ğŸŒˆ", "nome": "Arco-Ã­ris"},
            {"emoji": "ğŸš", "nome": "Arroz"}
        ],
        "B": [
            {"emoji": "ğŸˆ", "nome": "BalÃ£o"},
            {"emoji": "ğŸš²", "nome": "Bicicleta"},
            {"emoji": "ğŸŒ", "nome": "Banana"},
            {"emoji": "ğŸ”‹", "nome": "Bateria"},
            {"emoji": "ğŸ€", "nome": "Basquete"},
            {"emoji": "ğŸ", "nome": "Abelha"},
            {"emoji": "ğŸŸ", "nome": "Batata Frita"},
            {"emoji": "âš–", "nome": "BalanÃ§a"},
            {"emoji": "ğŸ†", "nome": "Berinjela"},
            {"emoji": "âš½", "nome": "Bola"}
        ],
        "C": [
            {"emoji": "ğŸ¡", "nome": "Casa"},
            {"emoji": "ğŸ°", "nome": "Castelo"},
            {"emoji": "ğŸ™ï¸", "nome": "Cidade"},
            {"emoji": "ğŸ", "nome": "Cobra"},
            {"emoji": "ğŸ¶", "nome": "Cachorro"},
            {"emoji": "â˜•", "nome": "CafÃ©"},
            {"emoji": "ğŸµ", "nome": "ChÃ¡"},
            {"emoji": "ğŸš—", "nome": "Carro"},
            {"emoji": "ğŸ ", "nome": "Carrossel"},
            {"emoji": "ğŸ¦Œ", "nome": "Cervo"},
            {"emoji": "ğŸ¥•", "nome": "Cenoura"},
            {"emoji": "ğŸ”‘", "nome": "Chave"},
            {"emoji": "ğŸ¦‰", "nome": "Coruja"},
            {"emoji": "ğŸƒ", "nome": "Corrida"}
        ],
        "D": [
            {"emoji": "ğŸ²", "nome": "Dado"},
            {"emoji": "ğŸ‰", "nome": "DragÃ£o"},
            {"emoji": "ğŸ’", "nome": "Diamante"},
            {"emoji": "ğŸ¯", "nome": "Dardo"},
            {"emoji": "ğŸ“…", "nome": "Data"}
        ],
        "E": [
            {"emoji": "â­", "nome": "Estrela"},
            {"emoji": "ğŸ“§", "nome": "E-mail"},
            {"emoji": "ğŸ˜", "nome": "Elefante"},
            {"emoji": "ğŸ”Œ", "nome": "Energia"},
            {"emoji": "ğŸ›¤", "nome": "Estrada"}
        ],
        "F": [
            {"emoji": "ğŸ—", "nome": "Fita"},
            {"emoji": "ğŸŒ¸", "nome": "Flor"},
            {"emoji": "ğŸœ", "nome": "Formiga"},
            {"emoji": "ğŸ”¥", "nome": "Fogo"},
            {"emoji": "ğŸº", "nome": "Flauta"},
            {"emoji": "ğŸ", "nome": "Final"},
            {"emoji": "ğŸ‚", "nome": "Folha"},
            {"emoji": "ğŸš€", "nome": "Foguete"},
            {"emoji": "ğŸŒ¹", "nome": "Flor"}
        ],
        "G": [
            {"emoji": "ğŸ¬", "nome": "Golfinho"},
            {"emoji": "ğŸ±", "nome": "Gato"},
            {"emoji": "ğŸ¦’", "nome": "Girafa"},
            {"emoji": "â˜‚ï¸", "nome": "Guarda-chuva"},
            {"emoji": "ğŸ¸", "nome": "Guitarra"},
            {"emoji": "ğŸ¥…", "nome": "Gol"},
            {"emoji": "ğŸŒï¸", "nome": "Golfe"}
        ],
        "H": [
            {"emoji": "ğŸ¥", "nome": "Hospital"},
            {"emoji": "ğŸš", "nome": "HelicÃ³ptero"},
            {"emoji": "ğŸ¹", "nome": "Hamster"}
        ],
        "I": [
            {"emoji": "ğŸ", "nome": "Ilha"},
            {"emoji": "ğŸ’¡", "nome": "Ideia"},
            {"emoji": "ğŸ“±", "nome": "Internet"},
            {"emoji": "ğŸ–¼", "nome": "Imagem"}
        ],
        "J": [
            {"emoji": "ğŸ·", "nome": "Jazz"},
            {"emoji": "ğŸš™", "nome": "Jipe"}
        ],
        "K": [
            {"emoji": "ğŸ¥", "nome": "Kiwi"},
            {"emoji": "ğŸ¤¹", "nome": "KaratÃª"},
            {"emoji": "ğŸ¥‹", "nome": "Kimono"}
        ],
        "L": [
            {"emoji": "ğŸ‹", "nome": "LimÃ£o"},
            {"emoji": "ğŸ“š", "nome": "Livro"},
            {"emoji": "ğŸ’¡", "nome": "LÃ¢mpada"},
            {"emoji": "ğŸ¦", "nome": "LeÃ£o"},
            {"emoji": "ğŸŒ™", "nome": "Lua"},
            {"emoji": "ğŸŠ", "nome": "Laranja"},
            {"emoji": "ğŸï¸", "nome": "Lago"},
            {"emoji": "ğŸ›³", "nome": "Lancha"}
        ],
        "M": [
            {"emoji": "ğŸ¶", "nome": "MÃºsica"},
            {"emoji": "ğŸ¤", "nome": "Microfone"},
            {"emoji": "ğŸ", "nome": "MaÃ§Ã£"},
            {"emoji": "ğŸµ", "nome": "Macaco"},
            {"emoji": "ğŸˆ", "nome": "MelÃ£o"},
            {"emoji": "ğŸŒŠ", "nome": "Mar"},
            {"emoji": "ğŸ”", "nome": "Montanha"},
            {"emoji": "ğŸ—º", "nome": "Mapa"},
            {"emoji": "âœ‰ï¸", "nome": "Mensagem"},
            {"emoji": "ğŸš‡", "nome": "MetrÃ´"},
            {"emoji": "ğŸ¦‡", "nome": "Morcego"},
            {"emoji": "ğŸ”¨", "nome": "Machado"}
        ],
        "N": [
            {"emoji": "â„ï¸", "nome": "Neve"},
            {"emoji": "ğŸš¢", "nome": "Navio"}
        ],
        "O": [
            {"emoji": "ğŸ¥š", "nome": "Ovo"},
            {"emoji": "ğŸ¢", "nome": "Oficina"},
            {"emoji": "ğŸ¨", "nome": "Obra de Arte"},
            {"emoji": "ğŸšŒ", "nome": "Ã”nibus"}
        ],
        "P": [
            {"emoji": "ğŸ ", "nome": "Peixe"},
            {"emoji": "ğŸ•", "nome": "Pizza"},
            {"emoji": "ğŸ§", "nome": "Pinguim"},
            {"emoji": "ğŸ", "nome": "Presente"},
            {"emoji": "ğŸšª", "nome": "Porta"},
            {"emoji": "ğŸ™", "nome": "Polvo"},
            {"emoji": "ğŸ“¦", "nome": "Pacote"},
            {"emoji": "ğŸ¥", "nome": "Panqueca"},
            {"emoji": "ğŸ¥–", "nome": "PÃ£o"}
        ],
        "Q": [
            {"emoji": "ğŸ‘‘", "nome": "Queijo"},
            {"emoji": "ğŸƒ", "nome": "Quebra-cabeÃ§a"},
            {"emoji": "ğŸ–¼", "nome": "Quadro"}
        ],
        "R": [
            {"emoji": "ğŸ¦Š", "nome": "Raposa"},
            {"emoji": "ğŸ“»", "nome": "RÃ¡dio"},
            {"emoji": "ğŸ¦", "nome": "Rinoceronte"},
            {"emoji": "ğŸ¤–", "nome": "Robo"}
        ],
        "S": [
            {"emoji": "ğŸš¦", "nome": "SemÃ¡foro"},
            {"emoji": "ğŸŒ", "nome": "Sol"},
            {"emoji": "ğŸ¥—", "nome": "Salada"},
            {"emoji": "ğŸ””", "nome": "Sino de Natal"}
        ],
        "T": [
            {"emoji": "ğŸ©", "nome": "Teatro"},
            {"emoji": "ğŸŒ®", "nome": "Taco"},
            {"emoji": "ğŸš†", "nome": "Trem"},
            {"emoji": "ğŸ¹", "nome": "Teclado"},
            {"emoji": "ğŸº", "nome": "Trompete"},
            {"emoji": "ğŸ“", "nome": "Telefone"},
            {"emoji": "ğŸŒ", "nome": "Terra"},
            {"emoji": "ğŸ†", "nome": "TrofÃ©u"},
            {"emoji": "ğŸ¥", "nome": "Tambor"}
        ],
        "U": [
            {"emoji": "ğŸ¦„", "nome": "UnicÃ³rnio"},
            {"emoji": "ğŸ‡", "nome": "Uva"}
        ],
        "V": [
            {"emoji": "ğŸ»", "nome": "Violino"},
            {"emoji": "ğŸŒ‹", "nome": "VulcÃ£o"},
            {"emoji": "ğŸ·", "nome": "Vinho"},
            {"emoji": "ğŸ®", "nome": "Videogame"},
            {"emoji": "ğŸ“¹", "nome": "VÃ­deo"},
            {"emoji": "ğŸš", "nome": "Van"},
            {"emoji": "ğŸ”Š", "nome": "Volume"}
        ],
        "X": [
            {"emoji": "âŒ", "nome": "Xis"}
        ],
        "Z": [
            {"emoji": "ğŸ¦“", "nome": "Zebra"}
        ]
    };

    function startGame(mode) {
        mainMenuEl.classList.add('d-none');
        const gameArea = document.getElementById('game-area');
        gameArea.classList.remove('d-none');
        gameArea.style.display = 'block';

        document.getElementById('feedback').textContent = '';
        currentGame = mode;

        if(mode === 'numbers') initNumbersGame();
        else if(mode === 'letters') initLettersGame();
        else if(mode === 'counting') initCountingGame();
        else if(mode === 'word') initWordGame();
        else if(mode === 'shadows') initShadowGame();
        else if(mode === 'puzzle') initPuzzleGame();
        else if(mode === 'colors') initColorGame();
        else if(mode === 'weather') initWeatherGame();
        else if(mode === 'categories') initCategoryGame();
    }

    /* Jogo de NÃºmeros */
    function initNumbersGame() {
        const content = document.getElementById('content');
        const targetNumber = numbers[Math.floor(Math.random() * 20)];

        content.innerHTML = `
            <h2>Encontre o nÃºmero:</h2>
            <div style="display:flex; justify-content:center; margin-top:20px;">
                <div class="target-number">${targetNumber}</div>
            </div>
            <div class="numbers-grid" id="numbers-grid"></div>
        `;

        const options = shuffle([targetNumber, ...shuffle(numbers.filter(n => n !== targetNumber)).slice(0, 4)]);
        const grid = document.getElementById('numbers-grid');
        options.forEach(num => {
            const div = document.createElement('div');
            div.className = 'number-option';
            div.textContent = num;
            div.onclick = () => checkNumber(num === targetNumber);
            grid.appendChild(div);
        });

        speak(`Encontre o nÃºmero ${targetNumber}`);
    }

    function checkNumber(isCorrect) {
        if(isCorrect) {
            updateStars(1);
            showFeedback('ğŸ¯ Correto! VocÃª Ã© demais!', true);
            setTimeout(() => startGame('numbers'), 2000);
        } else {
            updateStars(-1);
            showFeedback('ğŸ¤” Tente novamente!', false);
            speak("Ops! Esse nÃ£o Ã© o nÃºmero");
        }
    }

    /* Jogo de Letras */
    function initLettersGame() {
        const content = document.getElementById('content');
        const validLetters = Object.keys(emojiDatabase);
        const targetLetter = validLetters[Math.floor(Math.random() * validLetters.length)];
        const validEmojis = emojiDatabase[targetLetter];

        content.innerHTML = `
            <h2>Encontre emojis que comeÃ§am com:</h2>
            <div class="target-display" style="font-size:4rem;">${targetLetter}</div>
            <div class="emoji-grid"></div>
        `;

        const grid = document.querySelector('.emoji-grid');
        const allEmojis = Object.values(emojiDatabase).flat();

        const correctOptions = shuffle([...validEmojis]).slice(0, 3);
        const incorrectOptions = shuffle(allEmojis.filter(e => !validEmojis.includes(e))).slice(0, 7);
        const mixedOptions = shuffle([...correctOptions, ...incorrectOptions]);

        mixedOptions.forEach(emojiObj => {
            const div = document.createElement('div');
            div.className = 'emoji-option';
            div.innerHTML = `
                <div>${emojiObj.emoji}</div>
                <div class="emoji-name">${emojiObj.nome}</div>
            `;
            div.onclick = () => checkEmoji(validEmojis.includes(emojiObj), emojiObj.nome);
            grid.appendChild(div);
        });

        speak(`Encontre coisas que comeÃ§am com a letra ${targetLetter}`);
    }

    function checkEmoji(isCorrect, nome) {
        if(isCorrect) {
            updateStars(1);
            showFeedback('ğŸŒˆ Certo! CombinaÃ§Ã£o perfeita!', true);
            setTimeout(() => startGame('letters'), 2000);
        } else {
            updateStars(-1);
            showFeedback(`ğŸ’¡ "${nome}" comeÃ§a com ${nome[0].toUpperCase()}!`, false);
            speak(`Ops! ${nome} comeÃ§a com ${nome[0].toUpperCase()}!`);
        }
    }

    /* Jogo de Contar */
    function initCountingGame() {
        const content = document.getElementById('content');
        const targetCount = Math.floor(Math.random() * 20) + 1;
        const possibleEmojis = ['ğŸ', 'â­', 'ğŸ»', 'ğŸˆ', 'ğŸª'];
        const targetEmoji = shuffle(possibleEmojis)[0];

        content.innerHTML = `
            <h2>Conte atÃ©:</h2>
            <div class="counting-target">
                <div class="count-box">${targetCount}</div>
                <div class="count-box">${targetEmoji}</div>
            </div>
            <div id="counter">0</div>
            <div class="emoji-grid"></div>
        `;

        const grid = document.querySelector('.emoji-grid');
        const distractors = ['ğŸ¶','ğŸ‰','ğŸš—','ğŸ®','ğŸ•','ğŸ€','ğŸ ','ğŸ©','ğŸš‚','ğŸŒ»'];
        const options = shuffle([targetEmoji, ...shuffle(distractors).slice(0, 9)]);

        options.forEach(emoji => {
            const div = document.createElement('div');
            div.className = 'emoji-option';
            div.textContent = emoji;
            div.onclick = () => handleCountClick(emoji === targetEmoji, targetCount);
            grid.appendChild(div);
        });

        speak(`Clique ${targetCount} vezes no ${getEmojiName(targetEmoji)}`);
    }

    function handleCountClick(isCorrect, target) {
        if(!isCorrect) {
            speak("Esse nÃ£o Ã© o emoji correto!");
            updateStars(-1);
            showFeedback('âŒ Emoji errado!', false);
            return;
        }

        const counter = document.getElementById('counter');
        let count = parseInt(counter.textContent) + 1;
        counter.textContent = count;
        speak(count.toString());

        if(count === target) {
            updateStars(1);
            showFeedback('ğŸ‰ ParabÃ©ns! Contagem correta!', true);
            setTimeout(() => startGame('counting'), 2000);
        }
    }

    function getEmojiName(emoji) {
        const names = {
            'ğŸ': 'maÃ§Ã£', 'â­': 'estrela', 'ğŸ»': 'urso',
            'ğŸˆ': 'balÃ£o', 'ğŸª': 'biscoito', 'ğŸ¶': 'cachorro',
            'ğŸ‰': 'melancia', 'ğŸš—': 'carro', 'ğŸ®': 'videogame',
            'ğŸ•': 'pizza', 'ğŸ€': 'bola', 'ğŸ ': 'peixe',
            'ğŸ©': 'rosquinha', 'ğŸš‚': 'trem', 'ğŸŒ»': 'girassol'
        };
        return names[emoji] || 'objeto';
    }

    /* Jogo de Palavras */
    function initWordGame() {
        const content = document.getElementById('content');
        content.innerHTML = '<h2>Monte a palavra do emoji:</h2>';

        const allEmojis = Object.values(emojiDatabase).flat();
        const randomEmoji = shuffle(allEmojis)[0];
        const originalName = randomEmoji.nome.toUpperCase();

        const targetLetters = Array.from(originalName).filter(c => c !== ' ' && c !== '-');

        let targetDisplay = '';
        targetLetters.forEach((letter, index) => {
            targetDisplay += `<span class="letter-box" id="target-letter-${index}">${letter}</span>`;
        });

        content.innerHTML += `
            <div class="word-target">
                ${randomEmoji.emoji} <div id="target-word">${targetDisplay}</div>
            </div>
            <div class="scrambled-letters" id="scrambled-letters"></div>
        `;

        let scrambledLetters = shuffle([...targetLetters]);
        const lettersContainer = document.getElementById('scrambled-letters');
        scrambledLetters.forEach((letter) => {
            const div = document.createElement('div');
            div.className = 'word-letter';
            div.textContent = letter;
            div.onclick = function() {
                handleLetterClick(this, targetLetters);
            };
            lettersContainer.appendChild(div);
        });

        speak(`Monte a palavra: ${randomEmoji.nome}`);
    }

    function handleLetterClick(letterElement, targetLetters) {
        const revealedLetters = document.querySelectorAll('#target-word .revealed');
        const nextIndex = revealedLetters.length;

        speak(letterElement.textContent);

        if(nextIndex < targetLetters.length) {
            const correctLetter = targetLetters[nextIndex];

            if(letterElement.textContent === correctLetter) {
                document.getElementById(`target-letter-${nextIndex}`).classList.add('revealed');
                letterElement.style.visibility = 'hidden';

                if(nextIndex === targetLetters.length - 1) {
                    showFeedback('ğŸ‰ ParabÃ©ns! Palavra correta!', true);
                    updateStars(1);
                    setTimeout(() => startGame('word'), 2000);
                }
            } else {
                showFeedback('ğŸ˜Š Tente novamente!', false);
                speak("Essa nÃ£o Ã© a letra correta");
                updateStars(-1);
            }
        }
    }

    /* Jogo das Sombras */
    function initShadowGame() {
        const content = document.getElementById('content');
        content.innerHTML = '<h2>Arraste o emoji para sua sombra:</h2>';

        const allShadowEmojis = Object.values(emojiDatabase)
            .flat()
            .map(itemObj => itemObj.emoji);

        const uniqueEmojis = Array.from(new Set(allShadowEmojis));
        const chosenEmojis = shuffle(uniqueEmojis).slice(0, 4);

        content.innerHTML += `
            <div class="shadow-container">
                ${chosenEmojis.map(emoji => `
                    <div class="shadow-slot" data-expected="${emoji}"
                         ondrop="dropShadow(event, '${emoji}')"
                         ondragover="allowDrop(event)">
                         ${emoji}
                    </div>
                `).join('')}
            </div>
        `;

        content.innerHTML += `
            <div class="shadow-container">
                ${shuffle(chosenEmojis).map(emoji => `
                    <div class="shadow-item"
                         draggable="true"
                         ondragstart="startDrag(event, '${emoji}')"
                         ondragend="endDrag(event)">
                         ${emoji}
                    </div>
                `).join('')}
            </div>
        `;

        window.shadowGameState = {
            correctMatches: 0,
            totalItems: chosenEmojis.length
        };

        speak("Arraste cada emoji para sua respectiva sombra");
    }

    let draggedItem = null;

    function startDrag(ev, emoji) {
        draggedItem = emoji;
        ev.target.classList.add('dragging');
        ev.dataTransfer.setData("text/plain", emoji);
    }

    function endDrag(ev) {
        ev.target.classList.remove('dragging');
    }

    function dropShadow(ev, expectedEmoji) {
        ev.preventDefault();
        const slot = ev.target.closest('.shadow-slot');

        if (draggedItem === expectedEmoji) {
            slot.innerHTML = `<div>${draggedItem}</div>`;
            slot.classList.add('shadow-match');
            slot.classList.remove('shadow-slot');
            window.shadowGameState.correctMatches++;

            if(window.shadowGameState.correctMatches === window.shadowGameState.totalItems) {
                updateStars(1);
                showFeedback('ğŸ‰ ParabÃ©ns! Todas sombras combinadas!', true);
                setTimeout(() => startGame('shadows'), 2000);
            }
        } else {
            slot.classList.add('shadow-mismatch');
            setTimeout(() => slot.classList.remove('shadow-mismatch'), 1000);
            speak('Essa nÃ£o Ã© a sombra correta, vocÃª perdeu uma estrela');
            updateStars(-1);
        }

        draggedItem = null;
    }

    function allowDrop(ev) {
        ev.preventDefault();
    }

    /* Quebra-cabeÃ§a NumÃ©rico */
    function initPuzzleGame() {
        window.puzzleGameState = {
            selectedNumber: null,
            correctMatches: 0,
            totalPairs: 5
        };

        const content = document.getElementById('content');
        content.innerHTML = '<h2>Combine os nÃºmeros com a quantidade correta:</h2>';

        const randomNums = shuffle([...Array(10)].map((_, i) => i + 1)).slice(0, 5);
        const emojis = ['ğŸ', 'â­', 'ğŸˆ', 'ğŸ±', 'ğŸš—', 'ğŸ®', 'ğŸ•', 'ğŸ¶', 'ğŸŒº', 'ğŸ¨'];

        content.innerHTML += `
            <div class="numbers-container">
                ${randomNums.map(num => `
                    <div class="puzzle-piece number-piece"
                         onclick="selectNumber(this, ${num})"
                         data-number="${num}">
                        ${num}
                    </div>
                `).join('')}
            </div>
        `;

        content.innerHTML += `
            <div class="quantities-container">
                ${shuffle(randomNums).map(num => `
                    <div class="puzzle-piece emoji-piece"
                         onclick="matchQuantity(this, ${num})"
                         data-number="${num}">
                        <div class="puzzle-emoji-grid">
                            ${Array(num).fill(emojis[num - 1]).map(emoji => `
                                <div class="emoji-cell">${emoji}</div>
                            `).join('')}
                        </div>
                    </div>
                `).join('')}
            </div>
        `;

        speak(`Conte o nÃºmero de figuras e combine com o nÃºmero correto`);
    }

    function selectNumber(element, number) {
        document.querySelectorAll('.number-piece').forEach(piece => {
            piece.classList.remove('selected');
        });
        element.classList.add('selected');
        window.puzzleGameState.selectedNumber = number;
    }

    function matchQuantity(element, quantity) {
        if (window.puzzleGameState.selectedNumber === null) {
            showFeedback('Selecione um nÃºmero primeiro!', false);
            return;
        }

        if (quantity === window.puzzleGameState.selectedNumber) {
            element.classList.add('matched');
            document.querySelector(`.number-piece[data-number="${quantity}"]`).classList.add('matched');
            window.puzzleGameState.correctMatches++;
            showFeedback('ğŸ¯ CombinaÃ§Ã£o correta!', true);

            if (window.puzzleGameState.correctMatches === window.puzzleGameState.totalPairs) {
                updateStars(1);
                showFeedback('ğŸ‰ ParabÃ©ns! VocÃª completou o quebra-cabeÃ§a!', true);
                setTimeout(() => startGame('puzzle'), 2000);
            }
        } else {
            showFeedback('âŒ Tente novamente!', false);
            element.classList.add('wrong');
            setTimeout(() => {
                element.classList.remove('wrong');
            }, 500);
        }

        window.puzzleGameState.selectedNumber = null;
        document.querySelectorAll('.number-piece').forEach(piece => {
            if (!piece.classList.contains('matched')) {
                piece.classList.remove('selected');
            }
        });
    }

    /* Cores */
    function initColorGame() {
        const allColors = [
            { name: 'Vermelho', hex: '#FF0000' },
            { name: 'Azul', hex: '#0000FF' },
            { name: 'Verde', hex: '#00FF00' },
            { name: 'Amarelo', hex: '#FFD700' },
            { name: 'Roxo', hex: '#800080' },
            { name: 'Laranja', hex: '#FFA500' },
            { name: 'Rosa', hex: '#FF69B4' },
            { name: 'Marrom', hex: '#8B4513' }
        ];

        const roundColors = shuffle(allColors).slice(0, 3);

        const content = document.getElementById('content');
        content.innerHTML = '<h2>Arraste as cores para as caixas corretas:</h2>';

        content.innerHTML += `
            <div style="margin: 20px; display: flex; justify-content: center; gap: 15px;">
                ${roundColors.map(color => `
                    <div class="color-item"
                         style="background:${color.hex}"
                         draggable="true"
                         ondragstart="dragColor(event, '${color.hex}')"
                         data-colorname="${color.name}">
                    </div>
                `).join('')}
            </div>
        `;

        content.innerHTML += `
            <div style="margin-top:30px; display: flex; justify-content: center; gap: 20px;">
                ${roundColors.map(color => `
                    <div class="color-bin"
                         style="border-color:${color.hex}"
                         ondrop="dropColor(event, '${color.hex}')"
                         ondragover="allowDrop(event)"
                         data-filled="false">
                         <span style="color: ${color.hex}">${color.name}</span>
                    </div>
                `).join('')}
            </div>
        `;

        window.colorGameState = {
            totalColors: roundColors.length,
            correctMatches: 0
        };

        speak(`Combine as cores acima nas caixas correspondentes`);
    }

    let draggedColor = '';

    function dragColor(ev, color) {
        draggedColor = color;
        ev.dataTransfer.setData("text/plain", color);
        ev.target.style.opacity = '0.5';
    }

    function dropColor(ev, targetColor) {
        ev.preventDefault();
        document.querySelectorAll('.color-item').forEach(item => item.style.opacity = '1');

        const bin = ev.target.closest('.color-bin');
        if (bin.getAttribute('data-filled') === 'true') {
            showFeedback('Esta caixa jÃ¡ estÃ¡ preenchida!', false);
            return;
        }

        if (draggedColor === targetColor) {
            bin.style.backgroundColor = draggedColor;
            bin.setAttribute('data-filled', 'true');
            window.colorGameState.correctMatches++;
            showFeedback('ğŸŒŸ Cor correta!', true);

            if (window.colorGameState.correctMatches === window.colorGameState.totalColors) {
                updateStars(1);
                showFeedback('ğŸ‰ ParabÃ©ns! VocÃª completou todas as cores!', true);
                setTimeout(() => {
                    startGame('colors');
                }, 2000);
            }
        } else {
            showFeedback('ğŸ˜Š Tente outra cor', false);
            bin.style.animation = 'shake 0.5s';
            setTimeout(() => {
                bin.style.animation = '';
            }, 500);
        }
    }

    /* Clima */
    function initWeatherGame() {
        const weatherData = [
            { icon: 'â˜€ï¸', correctItems: ['ğŸ•¶ï¸', 'ğŸ©', 'ğŸ§´'], title: 'Ensolarado' },
            { icon: 'ğŸŒ§ï¸', correctItems: ['â˜‚ï¸', 'ğŸ§¥', 'ğŸ¥¾'], title: 'Chuvoso' },
            { icon: 'â„ï¸', correctItems: ['ğŸ§¤', 'ğŸ§£', 'ğŸ¿'], title: 'Frio' }
        ];

        const content = document.getElementById('content');
        const currentWeather = shuffle(weatherData)[0];
        const incorrectItems = ['ğŸ¸', 'ğŸ“˜', 'ğŸˆ', 'ğŸª', 'ğŸ­', 'ğŸ¨'];
        const allItems = shuffle([...currentWeather.correctItems, ...shuffle(incorrectItems).slice(0, 3)]);

        content.innerHTML = `
            <h2>Escolha os itens para o clima:</h2>
            <div class="weather-card">
                <div style="font-size:60px">${currentWeather.icon}</div>
                <h3>${currentWeather.title}</h3>
                <div class="weather-items" id="weather-items">
                    ${allItems.map(item => `
                        <div class="weather-item"
                             data-item="${item}"
                             onclick="handleWeatherItem(this, '${item}', '${currentWeather.icon}')">
                            ${item}
                        </div>
                    `).join('')}
                </div>
            </div>
        `;

        window.weatherGameState = {
            correctCount: 0,
            totalCorrect: currentWeather.correctItems.length,
            currentIcon: currentWeather.icon
        };

        speak(`Selecione as figuras que vocÃª usaria para o clima ${currentWeather.title}`);
    }

    function handleWeatherItem(element, item, correctIcon) {
        if (element.classList.contains('selected')) {
            return;
        }
        const correctItems = {
            'â˜€ï¸': ['ğŸ•¶ï¸', 'ğŸ©', 'ğŸ§´'],
            'ğŸŒ§ï¸': ['â˜‚ï¸', 'ğŸ§¥', 'ğŸ¥¾'],
            'â„ï¸': ['ğŸ§¤', 'ğŸ§£', 'ğŸ¿']
        }[correctIcon];

        if (correctItems.includes(item)) {
            element.classList.add('selected');
            showFeedback('âœ”ï¸ Item correto!', true);
            window.weatherGameState.correctCount++;

            if (window.weatherGameState.correctCount === window.weatherGameState.totalCorrect) {
                updateStars(1);
                showFeedback('ğŸ‰ ParabÃ©ns! VocÃª completou o desafio!', true);
                setTimeout(() => startGame('weather'), 2000);
            }
        } else {
            element.style.background = '#FFCDD2';
            element.style.animation = 'shake 0.5s';
            showFeedback('âŒ NÃ£o Ã© para este clima', false);
            speak("NÃ£o Ã© para este clima");
            setTimeout(() => {
                element.style.background = '';
                element.style.animation = '';
            }, 1000);
        }
    }

    /* Novo Jogo: Categorias */
    function initCategoryGame() {
        const content = document.getElementById('content');
        content.innerHTML = '<h2>Classifique os itens em suas categorias:</h2>';

        const categories = [
            {
                name: 'Animais',
                icon: 'ğŸ¶',
                items: [
                    'ğŸ±','ğŸ™','ğŸ¶','ğŸ·','ğŸ¦Š',
                    'ğŸ¦','ğŸ¯','ğŸº','ğŸ¸','ğŸ¦“',
                    'ğŸ¦’','ğŸµ','ğŸ¼','ğŸ¹','ğŸ°',
                    'ğŸ»','ğŸ¨','ğŸ”','ğŸ¦†','ğŸ¦…',
                    'ğŸ¦‰','ğŸ¢','ğŸ','ğŸ¦‹','ğŸ¦‡',
                    'ğŸ¦”','ğŸ¦£','ğŸŠ','ğŸ›','ğŸ¦•',
                    'ğŸ¦–'
                ]
            },
            {
                name: 'Frutas',
                icon: 'ğŸ',
                items: [
                    'ğŸ','ğŸŒ','ğŸ‡','ğŸŠ','ğŸ¥',
                    'ğŸ','ğŸ','ğŸ‘','ğŸ’','ğŸ‰',
                    'ğŸ“','ğŸ¥­','ğŸ…','ğŸ','ğŸ‹',
                    'ğŸ¥¥','ğŸ«'
                ]
            },
            {
                name: 'VeÃ­culos',
                icon: 'ğŸš—',
                items: [
                    'ğŸš—','âœˆï¸','ğŸš²','ğŸšŒ','â›µ',
                    'ğŸš•','ğŸš™','ğŸš','ğŸï¸','ğŸš“',
                    'ğŸš‘','ğŸš’','ğŸš','ğŸ›µ','ğŸï¸',
                    'ğŸš‚','ğŸš†','ğŸš‡','ğŸš','ğŸš',
                    'ğŸšŠ','ğŸ›©ï¸','ğŸš¤','â›´ï¸','ğŸš¢',
                    'ğŸ›¥ï¸','ğŸ›³ï¸','ğŸš€','ğŸš','ğŸš¡',
                    'ğŸš ','ğŸšŸ','ğŸ¦¼'
                ]
            }
        ];

        // Monta array de todos os itens de todas as categorias
        const allCategoryItems = [];
        categories.forEach(cat => {
            // Copia o array de itens e embaralha
            const shuffledItems = [...cat.items];
            shuffle(shuffledItems);

            // Seleciona apenas 5
            const fiveItems = shuffledItems.slice(0, 5);

            // Monta o array final, adicionando categoria
            fiveItems.forEach(item => {
                allCategoryItems.push({ emoji: item, category: cat.name });
            });
        });

        // HTML principal
        const contentHTML = [];

        // ConstrÃ³i as "bins"
        contentHTML.push(`<div class="category-game-container" style="flex-direction: row;">`);
        categories.forEach(cat => {
            contentHTML.push(`
                <div class="category-bin"
                     data-category="${cat.name}"
                     ondrop="dropCategoryItem(event, '${cat.name}')"
                     ondragover="allowDrop(event)"
                     data-filled="0">
                    <div class="category-label">${cat.icon} ${cat.name}</div>
                    <div class="bin-items-container" id="bin-${cat.name}"></div>
                </div>
            `);
        });
        contentHTML.push(`</div>`);

        // ConstrÃ³i a lista de itens arrastÃ¡veis
        contentHTML.push(`<div class="category-game-container" style="flex-direction: row;">`);
        shuffle(allCategoryItems).forEach(obj => {
            contentHTML.push(`
                <div class="category-item"
                     draggable="true"
                     ondragstart="startDragCategory(event, '${obj.emoji}', '${obj.category}')"
                     data-emoji="${obj.emoji}"
                     data-cat="${obj.category}">
                    ${obj.emoji}
                </div>
            `);
        });
        contentHTML.push(`</div>`);

        content.innerHTML += contentHTML.join('');

        window.categoryGameState = {
            totalItems: allCategoryItems.length,
            correct: 0
        };

        speak("Arraste cada item para a categoria correta");
    }

    function shuffle(array) {
        return array.sort(() => Math.random() - 0.5);
    }

    let draggedCategoryItem = { emoji: '', category: '', element: null };

    // Inicia arrasto
    function startDragCategory(ev, emoji, cat) {
        draggedCategoryItem.emoji = emoji;
        draggedCategoryItem.category = cat;
        draggedCategoryItem.element = ev.target; // MantÃ©m referÃªncia ao item

        ev.dataTransfer.setData("text/plain", emoji);
        ev.target.style.opacity = '0.5';
    }

    // Soltar em bin
    function dropCategoryItem(ev, targetCategory) {
        ev.preventDefault();

        // Restaura opacidade do item arrastado
        if(draggedCategoryItem.element) {
            draggedCategoryItem.element.style.opacity = '1';
        }

        const bin = ev.target.closest('.category-bin');
        if (!bin) return; // se nÃ£o for bin, sai

        // Se a categoria arrastada combina
        if (draggedCategoryItem.category === targetCategory) {
            bin.classList.add('category-matched');

            // Ajusta a contagem de itens nessa bin
            const filledCount = parseInt(bin.getAttribute('data-filled')) + 1;
            bin.setAttribute('data-filled', filledCount);

            // Adiciona o emoji no bin
            const binContainer = bin.querySelector('.bin-items-container');
            const newEmojiDiv = document.createElement('div');
            newEmojiDiv.style.fontSize = '2rem';
            newEmojiDiv.textContent = draggedCategoryItem.emoji;
            binContainer.appendChild(newEmojiDiv);

            // Oculta o item original na lista
            draggedCategoryItem.element.classList.add('hidden-item');

            // Incrementa contagem global
            window.categoryGameState.correct++;

            // Exibir feedback e narrar
            showFeedback('âœ”ï¸ Correto!', true);
            speak(`Muito bem! ${draggedCategoryItem.emoji} pertence Ã  categoria ${targetCategory}`);

            // Verifica fim do jogo
            if (window.categoryGameState.correct === window.categoryGameState.totalItems) {
                updateStars(1);
                showFeedback('ğŸ‰ ParabÃ©ns! Categorias completadas!', true);
                setTimeout(() => startGame('categories'), 2000);
            }

        } else {
            // Categoria errada
            bin.classList.add('category-wrong');
            setTimeout(() => {
                bin.classList.remove('category-wrong');
            }, 800);
            showFeedback('âŒ Categoria incorreta!', false);
            updateStars(-1);
            speak("Essa nÃ£o Ã© a categoria certa");
        }
    }

    /* UtilitÃ¡rios */
    function speak(text) {
        if(speechSynth.speaking) speechSynth.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'pt-BR';
        utterance.rate = 0.9;
        speechSynth.speak(utterance);
    }

    function shuffle(array) {
        return array.sort(() => Math.random() - 0.5);
    }

    function updateStars(change) {
        const newStars = Math.max(0, stars + change);
        if(newStars !== stars) {
            stars = newStars;
            localStorage.setItem('stars', stars.toString());
            document.getElementById('stars-count').textContent = stars;

            if(change > 0) {
                speak(`Muito bem!`);
            } else if(change < 0 && stars > 0) {
                speak('NÃ£o desista! Continue tentando!');
            }
        }
    }

    function showFeedback(message, isCorrect) {
        const feedback = document.getElementById('feedback');
        feedback.textContent = message;
        feedback.style.color = isCorrect ? '#2E7D32' : '#C62828';
    }

    function allowDrop(ev) {
        ev.preventDefault();
    }
</script>
</body>
</html>
