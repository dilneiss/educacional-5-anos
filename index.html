<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo Educativo Infantil</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #FFF3E0;
            margin-bottom: 80px;
        }

        .container {
            text-align: center;
        }

        button {
            font-size: 24px;
            padding: 15px 30px;
            margin: 15px;
            border-radius: 15px;
            background-color: #4CAF50;
            border: none;
            color: white;
            cursor: pointer;
        }

        .feedback {
            font-size: 1.5rem;
            margin: 1rem 0;
            min-height: 60px;
        }

        .game-mode {
            background-color: #81D4FA;
            border-radius: 20px;
            padding: 20px;
            margin: 10px;
            cursor: pointer;
            font-size: 1.5rem;
            transition: transform 0.2s;
            border: 3px solid #000;
        }
        .game-mode:hover {
            transform: scale(1.05);
        }

        #game-area {
            display: none;
        }

        .player-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 15px;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        .player-name {
            font-size: 24px;
            color: #2E7D32;
            font-weight: bold;
            margin: 0;
        }
        .stars-info {
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .stars-info span {
            font-size: 28px;
        }

        /* Categorias */
        .category-game-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        .category-bin {
            width: 180px;
            min-height: 150px;
            border: 3px dashed #000;
            border-radius: 15px;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            gap: 10px;
            transition: background 0.3s;
        }
        .category-label {
            font-size: 1.2rem;
            font-weight: bold;
        }
        /* Área onde os emojis corretos aparecerão */
        .bin-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            min-height: 50px; /* pra não sumir visualmente */
        }

        .category-item {
            width: 80px;
            height: 80px;
            margin: 5px;
            border-radius: 10px;
            font-size: 2rem;
            border: 3px solid #000;
            background-color: #C8E6C9;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        /* Para não desalinhar os itens quando estiver "oculto" */
        .category-item.hidden-item {
            visibility: hidden; /* esconde visual mas mantém espaço */
        }

        .category-matched {
            background-color: #C8E6C9 !important;
            border-color: #4CAF50 !important;
        }
        .category-wrong {
            background-color: #FFCDD2 !important;
            border-color: #C62828 !important;
            animation: shake 0.5s;
        }

        /* Animação shake */
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        /* Outros jogos (apenas mantidos para contexto) */
        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            justify-items: center;
            margin-top: 20px;
        }
        .number-option {
            background-color: #C8E6C9;
            width: 100px;
            height: 100px;
            margin: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            border-radius: 15px;
            cursor: pointer;
            border: 3px solid #000;
        }
        .target-number {
            background-color: #FFD700 !important;
            color: #000;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 120px;
            height: 120px;
            border-radius: 15px;
            font-size: 2rem;
            border: 3px solid #000;
        }

        /* Jogo de Letras */
        .emoji-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        .emoji-option {
            background-color: #C8E6C9;
            width: 120px;
            height: 120px;
            margin: 10px;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            border-radius: 15px;
            cursor: pointer;
            border: 3px solid #000;
        }
        .emoji-name {
            font-size: 14px;
            margin-top: 5px;
        }

        /* Jogo de Contar */
        .counting-target {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 15px;
        }
        .count-box {
            width: 80px;
            height: 80px;
            font-size: 2rem;
            background: #FFF9C4;
            border: 3px solid #000;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .counting-game .emoji-option {
            width: 100px;
            height: 100px;
            margin: 5px;
            font-size: 40px;
        }

        /* Jogo de Palavras */
        .word-letter {
            background-color: #FFD700;
            width: 60px;
            height: 60px;
            margin: 5px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            border-radius: 10px;
            cursor: pointer;
            border: 2px solid #000;
        }
        .word-target {
            font-size: 40px;
            margin: 20px;
            color: #888;
            opacity: 0.7;
        }
        .letter-box {
            display: inline-block;
            width: 40px;
            height: 40px;
            margin: 5px;
            font-size: 24px;
            color: #666;
            border-bottom: 3px solid #999;
        }
        .revealed {
            color: #2E7D32 !important;
            border-bottom: 3px solid #2E7D32;
        }
        .scrambled-letters {
            margin: 20px;
        }

        /* Jogo das Sombras */
        .shadow-container {
            display: flex;
            justify-content: space-around;
            margin: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .shadow-item {
            width: 150px;
            height: 150px;
            margin: 10px;
            cursor: move;
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
        }
        .shadow-slot {
            width: 150px;
            height: 150px;
            margin: 10px;
            background: #E0E0E0;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            opacity: 0.3;
        }
        .shadow-match {
            background: #C8E6C9 !important;
            border: 3px solid #4CAF50 !important;
            opacity: 1 !important;
        }
        .shadow-mismatch {
            background: #FFCDD2 !important;
            border: 3px solid #C62828 !important;
            animation: shake 0.5s;
        }
        .dragging {
            opacity: 0.5;
            transform: scale(0.9);
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        /* Quebra-cabeça Numérico */
        .numbers-container,
        .quantities-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px auto;
            max-width: 800px;
        }
        .puzzle-piece {
            width: 130px;
            height: 130px;
            font-size: 30px;
            margin: 5px;
            background: #FFB74D;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }
        .puzzle-piece:hover {
            transform: scale(1.05);
        }
        .number-piece {
            font-size: 36px;
            font-weight: bold;
            background: #81D4FA;
        }
        .emoji-piece {
            background: transparent !important;
            padding: 5px;
        }
        .puzzle-emoji-grid {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 6px;
            width: 100%;
            height: 100%;
            overflow: hidden;
            padding: 5px;
        }
        .emoji-cell {
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
        }
        .puzzle-piece.selected {
            border-color: #4CAF50;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }
        .puzzle-piece.matched {
            background: #C8E6C9;
            cursor: default;
            border-color: #4CAF50;
        }
        .puzzle-piece.matched .emoji-cell {
            background: rgba(76, 175, 80, 0.1);
        }
        .puzzle-piece.wrong {
            animation: shake 0.5s;
            background: #FFCDD2;
        }
        .puzzle-piece.wrong .emoji-cell {
            background: rgba(244, 67, 54, 0.1);
        }

        /* Cores */
        .color-bin {
            width: 120px;
            height: 120px;
            margin: 10px;
            border: 3px dashed #000;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            background-color: white;
        }
        .color-bin span {
            font-size: 16px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }
        .color-item {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid #fff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .color-item:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        /* Clima */
        .weather-card {
            background: #FFF;
            padding: 20px;
            margin: 20px;
            border-radius: 15px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            display: inline-block;
            width: 250px;
        }
        .weather-items {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        .weather-item {
            font-size: 30px;
            padding: 10px;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            background: #F5F5F5;
        }
        .weather-item.selected {
            background: #C8E6C9 !important;
            transform: scale(1.1);
            border: 2px solid #4CAF50;
        }

        /* Categorias */
        .category-game-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        .category-bin {
            width: 180px;
            min-height: 150px;
            border: 3px dashed #000;
            border-radius: 15px;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            gap: 10px;
            transition: background 0.3s;
        }
        .category-label {
            font-size: 1.2rem;
            font-weight: bold;
        }
        .category-item {
            width: 80px;
            height: 80px;
            margin: 5px;
            border-radius: 10px;
            font-size: 2rem;
            border: 3px solid #000;
            background-color: #C8E6C9;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .category-matched {
            background-color: #C8E6C9 !important;
            border-color: #4CAF50 !important;
        }
        .category-wrong {
            background-color: #FFCDD2 !important;
            border-color: #C62828 !important;
            animation: shake 0.5s;
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">

<div class="container flex-grow-1">

    <div class="player-info">
        <div class="player-name" id="player-name"></div>
        <div class="stars-info">
            <span>⭐</span>
            <span id="stars-count">0</span>
        </div>
    </div>

    <h1 class="text-center my-4">🎮 Vamos Aprender! 🌈</h1>

    <div id="main-menu">
        <div class="row g-2">
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('numbers')">🔢 Números</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('letters')">🔤 Letras</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('counting')">🍎 Contar</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('word')">🧩 Palavras</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('shadows')">🎭 Sombras</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('puzzle')">🧩 Quebra cabeça</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('colors')">🎨 Cores</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('weather')">☔ Clima</div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="game-mode" onclick="startGame('categories')">🚀 Categorias</div>
            </div>
        </div>
    </div>

    <div id="game-area" class="d-none">
        <div id="content" class="my-4"></div>
        <div id="feedback" class="feedback text-center"></div>
        <div class="text-center my-3">
            <button class="btn btn-lg btn-primary" onclick="showMainMenu()">Voltar ao Menu</button>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    localStorage.removeItem('playerName');
    localStorage.removeItem('stars');

    let playerName = prompt('Qual é o seu nome?', 'Amiguinho').trim();
    document.getElementById('player-name').textContent = playerName;

    let stars = 0;
    let previousStars = 0;
    document.getElementById('stars-count').textContent = stars;

    const numbers = Array.from({length: 20}, (_, i) => i + 1);

    const emojiDatabase = {
        "A": [
            {"emoji": "✈️", "nome": "Avião"},
            {"emoji": "🌳", "nome": "Árvore"},
            {"emoji": "🎨", "nome": "Arte"},
            {"emoji": "🏹", "nome": "Arco e Flecha"},
            {"emoji": "🐜", "nome": "Aranha"},
            {"emoji": "⚓", "nome": "Âncora"},
            {"emoji": "🎭", "nome": "Ator"},
            {"emoji": "🚑", "nome": "Ambulância"},
            {"emoji": "🌈", "nome": "Arco-íris"},
            {"emoji": "🍚", "nome": "Arroz"}
        ],
        "B": [
            {"emoji": "🎈", "nome": "Balão"},
            {"emoji": "🚲", "nome": "Bicicleta"},
            {"emoji": "🍌", "nome": "Banana"},
            {"emoji": "🔋", "nome": "Bateria"},
            {"emoji": "🏀", "nome": "Basquete"},
            {"emoji": "🐝", "nome": "Abelha"},
            {"emoji": "🍟", "nome": "Batata Frita"},
            {"emoji": "⚖", "nome": "Balança"},
            {"emoji": "🍆", "nome": "Berinjela"},
            {"emoji": "⚽", "nome": "Bola"}
        ],
        "C": [
            {"emoji": "🏡", "nome": "Casa"},
            {"emoji": "🏰", "nome": "Castelo"},
            {"emoji": "🏙️", "nome": "Cidade"},
            {"emoji": "🐍", "nome": "Cobra"},
            {"emoji": "🐶", "nome": "Cachorro"},
            {"emoji": "☕", "nome": "Café"},
            {"emoji": "🍵", "nome": "Chá"},
            {"emoji": "🚗", "nome": "Carro"},
            {"emoji": "🎠", "nome": "Carrossel"},
            {"emoji": "🦌", "nome": "Cervo"},
            {"emoji": "🥕", "nome": "Cenoura"},
            {"emoji": "🔑", "nome": "Chave"},
            {"emoji": "🦉", "nome": "Coruja"},
            {"emoji": "🏃", "nome": "Corrida"}
        ],
        "D": [
            {"emoji": "🎲", "nome": "Dado"},
            {"emoji": "🐉", "nome": "Dragão"},
            {"emoji": "💎", "nome": "Diamante"},
            {"emoji": "🎯", "nome": "Dardo"},
            {"emoji": "📅", "nome": "Data"}
        ],
        "E": [
            {"emoji": "⭐", "nome": "Estrela"},
            {"emoji": "📧", "nome": "E-mail"},
            {"emoji": "🐘", "nome": "Elefante"},
            {"emoji": "🔌", "nome": "Energia"},
            {"emoji": "🛤", "nome": "Estrada"}
        ],
        "F": [
            {"emoji": "🎗", "nome": "Fita"},
            {"emoji": "🌸", "nome": "Flor"},
            {"emoji": "🐜", "nome": "Formiga"},
            {"emoji": "🔥", "nome": "Fogo"},
            {"emoji": "🎺", "nome": "Flauta"},
            {"emoji": "🏁", "nome": "Final"},
            {"emoji": "🍂", "nome": "Folha"},
            {"emoji": "🚀", "nome": "Foguete"},
            {"emoji": "🌹", "nome": "Flor"}
        ],
        "G": [
            {"emoji": "🐬", "nome": "Golfinho"},
            {"emoji": "🐱", "nome": "Gato"},
            {"emoji": "🦒", "nome": "Girafa"},
            {"emoji": "☂️", "nome": "Guarda-chuva"},
            {"emoji": "🎸", "nome": "Guitarra"},
            {"emoji": "🥅", "nome": "Gol"},
            {"emoji": "🏌️", "nome": "Golfe"}
        ],
        "H": [
            {"emoji": "🏥", "nome": "Hospital"},
            {"emoji": "🚁", "nome": "Helicóptero"},
            {"emoji": "🐹", "nome": "Hamster"}
        ],
        "I": [
            {"emoji": "🏝", "nome": "Ilha"},
            {"emoji": "💡", "nome": "Ideia"},
            {"emoji": "📱", "nome": "Internet"},
            {"emoji": "🖼", "nome": "Imagem"}
        ],
        "J": [
            {"emoji": "🎷", "nome": "Jazz"},
            {"emoji": "🚙", "nome": "Jipe"}
        ],
        "K": [
            {"emoji": "🥝", "nome": "Kiwi"},
            {"emoji": "🤹", "nome": "Karatê"},
            {"emoji": "🥋", "nome": "Kimono"}
        ],
        "L": [
            {"emoji": "🍋", "nome": "Limão"},
            {"emoji": "📚", "nome": "Livro"},
            {"emoji": "💡", "nome": "Lâmpada"},
            {"emoji": "🦁", "nome": "Leão"},
            {"emoji": "🌙", "nome": "Lua"},
            {"emoji": "🍊", "nome": "Laranja"},
            {"emoji": "🏞️", "nome": "Lago"},
            {"emoji": "🛳", "nome": "Lancha"}
        ],
        "M": [
            {"emoji": "🎶", "nome": "Música"},
            {"emoji": "🎤", "nome": "Microfone"},
            {"emoji": "🍎", "nome": "Maçã"},
            {"emoji": "🐵", "nome": "Macaco"},
            {"emoji": "🍈", "nome": "Melão"},
            {"emoji": "🌊", "nome": "Mar"},
            {"emoji": "🏔", "nome": "Montanha"},
            {"emoji": "🗺", "nome": "Mapa"},
            {"emoji": "✉️", "nome": "Mensagem"},
            {"emoji": "🚇", "nome": "Metrô"},
            {"emoji": "🦇", "nome": "Morcego"},
            {"emoji": "🔨", "nome": "Machado"}
        ],
        "N": [
            {"emoji": "❄️", "nome": "Neve"},
            {"emoji": "🚢", "nome": "Navio"}
        ],
        "O": [
            {"emoji": "🥚", "nome": "Ovo"},
            {"emoji": "🏢", "nome": "Oficina"},
            {"emoji": "🎨", "nome": "Obra de Arte"},
            {"emoji": "🚌", "nome": "Ônibus"}
        ],
        "P": [
            {"emoji": "🐠", "nome": "Peixe"},
            {"emoji": "🍕", "nome": "Pizza"},
            {"emoji": "🐧", "nome": "Pinguim"},
            {"emoji": "🎁", "nome": "Presente"},
            {"emoji": "🚪", "nome": "Porta"},
            {"emoji": "🐙", "nome": "Polvo"},
            {"emoji": "📦", "nome": "Pacote"},
            {"emoji": "🥞", "nome": "Panqueca"},
            {"emoji": "🥖", "nome": "Pão"}
        ],
        "Q": [
            {"emoji": "👑", "nome": "Queijo"},
            {"emoji": "🃏", "nome": "Quebra-cabeça"},
            {"emoji": "🖼", "nome": "Quadro"}
        ],
        "R": [
            {"emoji": "🦊", "nome": "Raposa"},
            {"emoji": "📻", "nome": "Rádio"},
            {"emoji": "🦏", "nome": "Rinoceronte"},
            {"emoji": "🤖", "nome": "Robo"}
        ],
        "S": [
            {"emoji": "🚦", "nome": "Semáforo"},
            {"emoji": "🌞", "nome": "Sol"},
            {"emoji": "🥗", "nome": "Salada"},
            {"emoji": "🔔", "nome": "Sino de Natal"}
        ],
        "T": [
            {"emoji": "🎩", "nome": "Teatro"},
            {"emoji": "🌮", "nome": "Taco"},
            {"emoji": "🚆", "nome": "Trem"},
            {"emoji": "🎹", "nome": "Teclado"},
            {"emoji": "🎺", "nome": "Trompete"},
            {"emoji": "📞", "nome": "Telefone"},
            {"emoji": "🌍", "nome": "Terra"},
            {"emoji": "🏆", "nome": "Troféu"},
            {"emoji": "🥁", "nome": "Tambor"}
        ],
        "U": [
            {"emoji": "🦄", "nome": "Unicórnio"},
            {"emoji": "🍇", "nome": "Uva"}
        ],
        "V": [
            {"emoji": "🎻", "nome": "Violino"},
            {"emoji": "🌋", "nome": "Vulcão"},
            {"emoji": "🍷", "nome": "Vinho"},
            {"emoji": "🎮", "nome": "Videogame"},
            {"emoji": "📹", "nome": "Vídeo"},
            {"emoji": "🚐", "nome": "Van"},
            {"emoji": "🔊", "nome": "Volume"}
        ],
        "X": [
            {"emoji": "❌", "nome": "Xis"}
        ],
        "Z": [
            {"emoji": "🦓", "nome": "Zebra"}
        ]
    };

    let currentGame = null;
    let speechSynth = window.speechSynthesis;

    function startGame(mode) {
        document.getElementById('main-menu').style.display = 'none';
        const gameArea = document.getElementById('game-area');
        gameArea.classList.remove('d-none');
        gameArea.style.display = 'block';

        document.getElementById('feedback').textContent = '';
        currentGame = mode;

        if(mode === 'numbers') initNumbersGame();
        else if(mode === 'letters') initLettersGame();
        else if(mode === 'counting') initCountingGame();
        else if(mode === 'word') initWordGame();
        else if(mode === 'shadows') initShadowGame();
        else if(mode === 'puzzle') initPuzzleGame();
        else if(mode === 'colors') initColorGame();
        else if(mode === 'weather') initWeatherGame();
        else if(mode === 'categories') initCategoryGame();
    }

    function showMainMenu() {
        if(stars > previousStars) {
            speak(`${playerName}, você tem ${stars} estrelas! Muito bem!`);
            previousStars = stars;
        } else if(stars < previousStars && stars > 0) {
            speak(`${playerName}, agora você tem ${stars} estrelas. Vamos recuperar!`);
            previousStars = stars;
        }

        document.getElementById('main-menu').style.display = 'block';
        const gameArea = document.getElementById('game-area');
        gameArea.classList.add('d-none');
        gameArea.style.display = 'none';
    }

    /* Jogo de Números */
    function initNumbersGame() {
        const content = document.getElementById('content');
        const targetNumber = numbers[Math.floor(Math.random() * 20)];

        content.innerHTML = `
            <h2>Encontre o número:</h2>
            <div style="display:flex; justify-content:center; margin-top:20px;">
                <div class="target-number">${targetNumber}</div>
            </div>
            <div class="numbers-grid" id="numbers-grid"></div>
        `;

        const options = shuffle([targetNumber, ...shuffle(numbers.filter(n => n !== targetNumber)).slice(0, 4)]);
        const grid = document.getElementById('numbers-grid');
        options.forEach(num => {
            const div = document.createElement('div');
            div.className = 'number-option';
            div.textContent = num;
            div.onclick = () => checkNumber(num === targetNumber);
            grid.appendChild(div);
        });

        speak(`Encontre o número ${targetNumber}`);
    }

    function checkNumber(isCorrect) {
        if(isCorrect) {
            updateStars(1);
            showFeedback('🎯 Correto! Você é demais!', true);
            setTimeout(() => startGame('numbers'), 2000);
        } else {
            updateStars(-1);
            showFeedback('🤔 Tente novamente!', false);
            speak("Ops! Esse não é o número");
        }
    }

    /* Jogo de Letras */
    function initLettersGame() {
        const content = document.getElementById('content');
        const validLetters = Object.keys(emojiDatabase);
        const targetLetter = validLetters[Math.floor(Math.random() * validLetters.length)];
        const validEmojis = emojiDatabase[targetLetter];

        content.innerHTML = `
            <h2>Encontre emojis que começam com:</h2>
            <div class="target-display" style="font-size:4rem;">${targetLetter}</div>
            <div class="emoji-grid"></div>
        `;

        const grid = document.querySelector('.emoji-grid');
        const allEmojis = Object.values(emojiDatabase).flat();

        const correctOptions = shuffle([...validEmojis]).slice(0, 3);
        const incorrectOptions = shuffle(allEmojis.filter(e => !validEmojis.includes(e))).slice(0, 7);
        const mixedOptions = shuffle([...correctOptions, ...incorrectOptions]);

        mixedOptions.forEach(emojiObj => {
            const div = document.createElement('div');
            div.className = 'emoji-option';
            div.innerHTML = `
                <div>${emojiObj.emoji}</div>
                <div class="emoji-name">${emojiObj.nome}</div>
            `;
            div.onclick = () => checkEmoji(validEmojis.includes(emojiObj), emojiObj.nome);
            grid.appendChild(div);
        });

        speak(`Encontre coisas que começam com a letra ${targetLetter}`);
    }

    function checkEmoji(isCorrect, nome) {
        if(isCorrect) {
            updateStars(1);
            showFeedback('🌈 Certo! Combinação perfeita!', true);
            setTimeout(() => startGame('letters'), 2000);
        } else {
            updateStars(-1);
            showFeedback(`💡 "${nome}" começa com ${nome[0].toUpperCase()}!`, false);
            speak(`Ops! ${nome} começa com ${nome[0].toUpperCase()}!`);
        }
    }

    /* Jogo de Contar */
    function initCountingGame() {
        const content = document.getElementById('content');
        const targetCount = Math.floor(Math.random() * 20) + 1;
        const possibleEmojis = ['🍎', '⭐', '🐻', '🎈', '🍪'];
        const targetEmoji = shuffle(possibleEmojis)[0];

        content.innerHTML = `
            <h2>Conte até:</h2>
            <div class="counting-target">
                <div class="count-box">${targetCount}</div>
                <div class="count-box">${targetEmoji}</div>
            </div>
            <div id="counter">0</div>
            <div class="emoji-grid"></div>
        `;

        const grid = document.querySelector('.emoji-grid');
        const distractors = ['🐶','🍉','🚗','🎮','🍕','🏀','🐠','🍩','🚂','🌻'];
        const options = shuffle([targetEmoji, ...shuffle(distractors).slice(0, 9)]);

        options.forEach(emoji => {
            const div = document.createElement('div');
            div.className = 'emoji-option';
            div.textContent = emoji;
            div.onclick = () => handleCountClick(emoji === targetEmoji, targetCount);
            grid.appendChild(div);
        });

        speak(`Clique ${targetCount} vezes no ${getEmojiName(targetEmoji)}`);
    }

    function handleCountClick(isCorrect, target) {
        if(!isCorrect) {
            speak("Esse não é o emoji correto!");
            updateStars(-1);
            showFeedback('❌ Emoji errado!', false);
            return;
        }

        const counter = document.getElementById('counter');
        let count = parseInt(counter.textContent) + 1;
        counter.textContent = count;
        speak(count.toString());

        if(count === target) {
            updateStars(1);
            showFeedback('🎉 Parabéns! Contagem correta!', true);
            setTimeout(() => startGame('counting'), 2000);
        }
    }

    function getEmojiName(emoji) {
        const names = {
            '🍎': 'maçã', '⭐': 'estrela', '🐻': 'urso',
            '🎈': 'balão', '🍪': 'biscoito', '🐶': 'cachorro',
            '🍉': 'melancia', '🚗': 'carro', '🎮': 'videogame',
            '🍕': 'pizza', '🏀': 'bola', '🐠': 'peixe',
            '🍩': 'rosquinha', '🚂': 'trem', '🌻': 'girassol'
        };
        return names[emoji] || 'objeto';
    }

    /* Jogo de Palavras */
    function initWordGame() {
        const content = document.getElementById('content');
        content.innerHTML = '<h2>Monte a palavra do emoji:</h2>';

        const allEmojis = Object.values(emojiDatabase).flat();
        const randomEmoji = shuffle(allEmojis)[0];
        const originalName = randomEmoji.nome.toUpperCase();

        const targetLetters = Array.from(originalName).filter(c => c !== ' ' && c !== '-');

        let targetDisplay = '';
        targetLetters.forEach((letter, index) => {
            targetDisplay += `<span class="letter-box" id="target-letter-${index}">${letter}</span>`;
        });

        content.innerHTML += `
            <div class="word-target">
                ${randomEmoji.emoji} <div id="target-word">${targetDisplay}</div>
            </div>
            <div class="scrambled-letters" id="scrambled-letters"></div>
        `;

        let scrambledLetters = shuffle([...targetLetters]);
        const lettersContainer = document.getElementById('scrambled-letters');
        scrambledLetters.forEach((letter) => {
            const div = document.createElement('div');
            div.className = 'word-letter';
            div.textContent = letter;
            div.onclick = function() {
                handleLetterClick(this, targetLetters);
            };
            lettersContainer.appendChild(div);
        });

        speak(`Monte a palavra: ${randomEmoji.nome}`);
    }

    function handleLetterClick(letterElement, targetLetters) {
        const revealedLetters = document.querySelectorAll('#target-word .revealed');
        const nextIndex = revealedLetters.length;

        speak(letterElement.textContent);

        if(nextIndex < targetLetters.length) {
            const correctLetter = targetLetters[nextIndex];

            if(letterElement.textContent === correctLetter) {
                document.getElementById(`target-letter-${nextIndex}`).classList.add('revealed');
                letterElement.style.visibility = 'hidden';

                if(nextIndex === targetLetters.length - 1) {
                    showFeedback('🎉 Parabéns! Palavra correta!', true);
                    updateStars(1);
                    setTimeout(() => startGame('word'), 2000);
                }
            } else {
                showFeedback('😊 Tente novamente!', false);
                speak("Essa não é a letra correta");
                updateStars(-1);
            }
        }
    }

    /* Jogo das Sombras */
    function initShadowGame() {
        const content = document.getElementById('content');
        content.innerHTML = '<h2>Arraste o emoji para sua sombra:</h2>';

        const allShadowEmojis = Object.values(emojiDatabase)
            .flat()
            .map(itemObj => itemObj.emoji);

        const uniqueEmojis = Array.from(new Set(allShadowEmojis));
        const chosenEmojis = shuffle(uniqueEmojis).slice(0, 4);

        content.innerHTML += `
            <div class="shadow-container">
                ${chosenEmojis.map(emoji => `
                    <div class="shadow-slot" data-expected="${emoji}"
                         ondrop="dropShadow(event, '${emoji}')"
                         ondragover="allowDrop(event)">
                         ${emoji}
                    </div>
                `).join('')}
            </div>
        `;

        content.innerHTML += `
            <div class="shadow-container">
                ${shuffle(chosenEmojis).map(emoji => `
                    <div class="shadow-item"
                         draggable="true"
                         ondragstart="startDrag(event, '${emoji}')"
                         ondragend="endDrag(event)">
                         ${emoji}
                    </div>
                `).join('')}
            </div>
        `;

        window.shadowGameState = {
            correctMatches: 0,
            totalItems: chosenEmojis.length
        };

        speak("Arraste cada emoji para sua respectiva sombra");
    }

    let draggedItem = null;

    function startDrag(ev, emoji) {
        draggedItem = emoji;
        ev.target.classList.add('dragging');
        ev.dataTransfer.setData("text/plain", emoji);
    }

    function endDrag(ev) {
        ev.target.classList.remove('dragging');
    }

    function dropShadow(ev, expectedEmoji) {
        ev.preventDefault();
        const slot = ev.target.closest('.shadow-slot');

        if (draggedItem === expectedEmoji) {
            slot.innerHTML = `<div>${draggedItem}</div>`;
            slot.classList.add('shadow-match');
            slot.classList.remove('shadow-slot');
            window.shadowGameState.correctMatches++;

            if(window.shadowGameState.correctMatches === window.shadowGameState.totalItems) {
                updateStars(1);
                showFeedback('🎉 Parabéns! Todas sombras combinadas!', true);
                setTimeout(() => startGame('shadows'), 2000);
            }
        } else {
            slot.classList.add('shadow-mismatch');
            setTimeout(() => slot.classList.remove('shadow-mismatch'), 1000);
            speak('Essa não é a sombra correta, você perdeu uma estrela');
            updateStars(-1);
        }

        draggedItem = null;
    }

    function allowDrop(ev) {
        ev.preventDefault();
    }

    /* Quebra-cabeça Numérico */
    function initPuzzleGame() {
        window.puzzleGameState = {
            selectedNumber: null,
            correctMatches: 0,
            totalPairs: 5
        };

        const content = document.getElementById('content');
        content.innerHTML = '<h2>Combine os números com a quantidade correta:</h2>';

        const randomNums = shuffle([...Array(10)].map((_, i) => i + 1)).slice(0, 5);
        const emojis = ['🍎', '⭐', '🎈', '🐱', '🚗', '🎮', '🍕', '🐶', '🌺', '🎨'];

        content.innerHTML += `
            <div class="numbers-container">
                ${randomNums.map(num => `
                    <div class="puzzle-piece number-piece"
                         onclick="selectNumber(this, ${num})"
                         data-number="${num}">
                        ${num}
                    </div>
                `).join('')}
            </div>
        `;

        content.innerHTML += `
            <div class="quantities-container">
                ${shuffle(randomNums).map(num => `
                    <div class="puzzle-piece emoji-piece"
                         onclick="matchQuantity(this, ${num})"
                         data-number="${num}">
                        <div class="puzzle-emoji-grid">
                            ${Array(num).fill(emojis[num - 1]).map(emoji => `
                                <div class="emoji-cell">${emoji}</div>
                            `).join('')}
                        </div>
                    </div>
                `).join('')}
            </div>
        `;

        speak(`Conte o número de figuras e combine com o número correto`);
    }

    function selectNumber(element, number) {
        document.querySelectorAll('.number-piece').forEach(piece => {
            piece.classList.remove('selected');
        });
        element.classList.add('selected');
        window.puzzleGameState.selectedNumber = number;
    }

    function matchQuantity(element, quantity) {
        if (window.puzzleGameState.selectedNumber === null) {
            showFeedback('Selecione um número primeiro!', false);
            return;
        }

        if (quantity === window.puzzleGameState.selectedNumber) {
            element.classList.add('matched');
            document.querySelector(`.number-piece[data-number="${quantity}"]`).classList.add('matched');
            window.puzzleGameState.correctMatches++;
            showFeedback('🎯 Combinação correta!', true);

            if (window.puzzleGameState.correctMatches === window.puzzleGameState.totalPairs) {
                updateStars(1);
                showFeedback('🎉 Parabéns! Você completou o quebra-cabeça!', true);
                setTimeout(() => startGame('puzzle'), 2000);
            }
        } else {
            showFeedback('❌ Tente novamente!', false);
            element.classList.add('wrong');
            setTimeout(() => {
                element.classList.remove('wrong');
            }, 500);
        }

        window.puzzleGameState.selectedNumber = null;
        document.querySelectorAll('.number-piece').forEach(piece => {
            if (!piece.classList.contains('matched')) {
                piece.classList.remove('selected');
            }
        });
    }

    /* Cores */
    function initColorGame() {
        const allColors = [
            { name: 'Vermelho', hex: '#FF0000' },
            { name: 'Azul', hex: '#0000FF' },
            { name: 'Verde', hex: '#00FF00' },
            { name: 'Amarelo', hex: '#FFD700' },
            { name: 'Roxo', hex: '#800080' },
            { name: 'Laranja', hex: '#FFA500' },
            { name: 'Rosa', hex: '#FF69B4' },
            { name: 'Marrom', hex: '#8B4513' }
        ];

        const roundColors = shuffle(allColors).slice(0, 3);

        const content = document.getElementById('content');
        content.innerHTML = '<h2>Arraste as cores para as caixas corretas:</h2>';

        content.innerHTML += `
            <div style="margin: 20px; display: flex; justify-content: center; gap: 15px;">
                ${roundColors.map(color => `
                    <div class="color-item"
                         style="background:${color.hex}"
                         draggable="true"
                         ondragstart="dragColor(event, '${color.hex}')"
                         data-colorname="${color.name}">
                    </div>
                `).join('')}
            </div>
        `;

        content.innerHTML += `
            <div style="margin-top:30px; display: flex; justify-content: center; gap: 20px;">
                ${roundColors.map(color => `
                    <div class="color-bin"
                         style="border-color:${color.hex}"
                         ondrop="dropColor(event, '${color.hex}')"
                         ondragover="allowDrop(event)"
                         data-filled="false">
                         <span style="color: ${color.hex}">${color.name}</span>
                    </div>
                `).join('')}
            </div>
        `;

        window.colorGameState = {
            totalColors: roundColors.length,
            correctMatches: 0
        };

        speak(`Combine as cores acima nas caixas correspondentes`);
    }

    let draggedColor = '';

    function dragColor(ev, color) {
        draggedColor = color;
        ev.dataTransfer.setData("text/plain", color);
        ev.target.style.opacity = '0.5';
    }

    function dropColor(ev, targetColor) {
        ev.preventDefault();
        document.querySelectorAll('.color-item').forEach(item => item.style.opacity = '1');

        const bin = ev.target.closest('.color-bin');
        if (bin.getAttribute('data-filled') === 'true') {
            showFeedback('Esta caixa já está preenchida!', false);
            return;
        }

        if (draggedColor === targetColor) {
            bin.style.backgroundColor = draggedColor;
            bin.setAttribute('data-filled', 'true');
            window.colorGameState.correctMatches++;
            showFeedback('🌟 Cor correta!', true);

            if (window.colorGameState.correctMatches === window.colorGameState.totalColors) {
                updateStars(1);
                showFeedback('🎉 Parabéns! Você completou todas as cores!', true);
                setTimeout(() => {
                    startGame('colors');
                }, 2000);
            }
        } else {
            showFeedback('😊 Tente outra cor', false);
            bin.style.animation = 'shake 0.5s';
            setTimeout(() => {
                bin.style.animation = '';
            }, 500);
        }
    }

    /* Clima */
    function initWeatherGame() {
        const weatherData = [
            { icon: '☀️', correctItems: ['🕶️', '🎩', '🧴'], title: 'Ensolarado' },
            { icon: '🌧️', correctItems: ['☂️', '🧥', '🥾'], title: 'Chuvoso' },
            { icon: '❄️', correctItems: ['🧤', '🧣', '🎿'], title: 'Frio' }
        ];

        const content = document.getElementById('content');
        const currentWeather = shuffle(weatherData)[0];
        const incorrectItems = ['🎸', '📘', '🎈', '🎪', '🎭', '🎨'];
        const allItems = shuffle([...currentWeather.correctItems, ...shuffle(incorrectItems).slice(0, 3)]);

        content.innerHTML = `
            <h2>Escolha os itens para o clima:</h2>
            <div class="weather-card">
                <div style="font-size:60px">${currentWeather.icon}</div>
                <h3>${currentWeather.title}</h3>
                <div class="weather-items" id="weather-items">
                    ${allItems.map(item => `
                        <div class="weather-item"
                             data-item="${item}"
                             onclick="handleWeatherItem(this, '${item}', '${currentWeather.icon}')">
                            ${item}
                        </div>
                    `).join('')}
                </div>
            </div>
        `;

        window.weatherGameState = {
            correctCount: 0,
            totalCorrect: currentWeather.correctItems.length,
            currentIcon: currentWeather.icon
        };

        speak(`Selecione as figuras que você usaria para o clima ${currentWeather.title}`);
    }

    function handleWeatherItem(element, item, correctIcon) {
        if (element.classList.contains('selected')) {
            return;
        }
        const correctItems = {
            '☀️': ['🕶️', '🎩', '🧴'],
            '🌧️': ['☂️', '🧥', '🥾'],
            '❄️': ['🧤', '🧣', '🎿']
        }[correctIcon];

        if (correctItems.includes(item)) {
            element.classList.add('selected');
            showFeedback('✔️ Item correto!', true);
            window.weatherGameState.correctCount++;

            if (window.weatherGameState.correctCount === window.weatherGameState.totalCorrect) {
                updateStars(1);
                showFeedback('🎉 Parabéns! Você completou o desafio!', true);
                setTimeout(() => startGame('weather'), 2000);
            }
        } else {
            element.style.background = '#FFCDD2';
            element.style.animation = 'shake 0.5s';
            showFeedback('❌ Não é para este clima', false);
            speak("Não é para este clima");
            setTimeout(() => {
                element.style.background = '';
                element.style.animation = '';
            }, 1000);
        }
    }

    /* Novo Jogo: Categorias */
    function initCategoryGame() {
        const content = document.getElementById('content');
        content.innerHTML = '<h2>Classifique os itens em suas categorias:</h2>';

        const categories = [
            { name: 'Animais', icon: '🐶', items: ['🐱','🐙','🐶','🐷','🦊'] },
            { name: 'Frutas', icon: '🍎', items: ['🍎','🍌','🍇','🍊','🥝'] },
            { name: 'Veículos', icon: '🚗', items: ['🚗','✈️','🚲','🚌','⛵'] }
        ];

        // Monta array de todos os itens de todas as categorias
        const allCategoryItems = [];
        categories.forEach(cat => {
            // Cada cat tem: { name, icon, items: [...] }
            allCategoryItems.push(...cat.items.map(i => ({ emoji: i, category: cat.name })));
        });

        // HTML principal
        const contentHTML = [];

        // Constrói as "bins"
        contentHTML.push(`<div class="category-game-container" style="flex-direction: row;">`);
        categories.forEach(cat => {
            contentHTML.push(`
                <div class="category-bin"
                     data-category="${cat.name}"
                     ondrop="dropCategoryItem(event, '${cat.name}')"
                     ondragover="allowDrop(event)"
                     data-filled="0">
                    <div class="category-label">${cat.icon} ${cat.name}</div>
                    <div class="bin-items-container" id="bin-${cat.name}"></div>
                </div>
            `);
        });
        contentHTML.push(`</div>`);

        // Constrói a lista de itens arrastáveis
        contentHTML.push(`<div class="category-game-container" style="flex-direction: row;">`);
        shuffle(allCategoryItems).forEach(obj => {
            contentHTML.push(`
                <div class="category-item"
                     draggable="true"
                     ondragstart="startDragCategory(event, '${obj.emoji}', '${obj.category}')"
                     data-emoji="${obj.emoji}"
                     data-cat="${obj.category}">
                    ${obj.emoji}
                </div>
            `);
        });
        contentHTML.push(`</div>`);

        content.innerHTML += contentHTML.join('');

        window.categoryGameState = {
            totalItems: allCategoryItems.length,
            correct: 0
        };

        speak("Arraste cada item para a categoria correta");
    }

    let draggedCategoryItem = { emoji: '', category: '', element: null };

    // Inicia arrasto
    function startDragCategory(ev, emoji, cat) {
        draggedCategoryItem.emoji = emoji;
        draggedCategoryItem.category = cat;
        draggedCategoryItem.element = ev.target; // Mantém referência ao item

        ev.dataTransfer.setData("text/plain", emoji);
        ev.target.style.opacity = '0.5';
    }

    // Soltar em bin
    function dropCategoryItem(ev, targetCategory) {
        ev.preventDefault();

        // Restaura opacidade do item arrastado
        if(draggedCategoryItem.element) {
            draggedCategoryItem.element.style.opacity = '1';
        }

        const bin = ev.target.closest('.category-bin');
        if (!bin) return; // se não for bin, sai

        // Se a categoria arrastada combina
        if (draggedCategoryItem.category === targetCategory) {
            bin.classList.add('category-matched');

            // Ajusta a contagem de itens nessa bin
            const filledCount = parseInt(bin.getAttribute('data-filled')) + 1;
            bin.setAttribute('data-filled', filledCount);

            // Adiciona o emoji no bin
            const binContainer = bin.querySelector('.bin-items-container');
            const newEmojiDiv = document.createElement('div');
            newEmojiDiv.style.fontSize = '2rem';
            newEmojiDiv.textContent = draggedCategoryItem.emoji;
            binContainer.appendChild(newEmojiDiv);

            // Oculta o item original na lista
            draggedCategoryItem.element.classList.add('hidden-item');

            // Incrementa contagem global
            window.categoryGameState.correct++;

            // Exibir feedback e narrar
            showFeedback('✔️ Correto!', true);
            speak(`Muito bem! ${draggedCategoryItem.emoji} pertence à categoria ${targetCategory}`);

            // Verifica fim do jogo
            if (window.categoryGameState.correct === window.categoryGameState.totalItems) {
                updateStars(1);
                showFeedback('🎉 Parabéns! Categorias completadas!', true);
                setTimeout(() => startGame('categories'), 2000);
            }

        } else {
            // Categoria errada
            bin.classList.add('category-wrong');
            setTimeout(() => {
                bin.classList.remove('category-wrong');
            }, 800);
            showFeedback('❌ Categoria incorreta!', false);
            updateStars(-1);
            speak("Essa não é a categoria certa");
        }
    }

    /* Utilitários */
    function speak(text) {
        if(speechSynth.speaking) speechSynth.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'pt-BR';
        utterance.rate = 0.9;
        speechSynth.speak(utterance);
    }

    function shuffle(array) {
        return array.sort(() => Math.random() - 0.5);
    }

    function updateStars(change) {
        const newStars = Math.max(0, stars + change);
        if(newStars !== stars) {
            stars = newStars;
            localStorage.setItem('stars', stars.toString());
            document.getElementById('stars-count').textContent = stars;

            if(change > 0) {
                speak(`Muito bem!`);
            } else if(change < 0 && stars > 0) {
                speak('Não desista! Continue tentando!');
            }
        }
    }

    function showFeedback(message, isCorrect) {
        const feedback = document.getElementById('feedback');
        feedback.textContent = message;
        feedback.style.color = isCorrect ? '#2E7D32' : '#C62828';
    }

    function allowDrop(ev) {
        ev.preventDefault();
    }
</script>
</body>
</html>
